{
  "pmcid": "PMC12676313",
  "source": "PMC",
  "download_date": "2025-12-09T16:37:20.924828",
  "metadata": {
    "journal_title": "ACS Omega",
    "journal_nlm_ta": "ACS Omega",
    "journal_iso_abbrev": "ACS Omega",
    "journal": "ACS Omega",
    "pmcid": "PMC12676313",
    "pmid": "41358140",
    "doi": "10.1021/acsomega.5c10621",
    "title": "3D Molecule Generation\nvia Diffusion Model with a\nSelf-Attention-Based EGNN",
    "authors": [
      "Yang Huanai",
      "Zhong Qi",
      "Wang Min",
      "Peng Jianrong",
      "Shen Dingcai"
    ],
    "abstract": "The discovery of\nnew drugs is of great significance to human health.\nThe diffusion model has emerged as a powerful tool for generating\n3D molecular structures, achieving significant success in various\napplications. However, existing models lack direct interatomic confinement\nfeatures and are difficult to capture long-range dependencies in macromolecules.\nThese issues lead to the generation of molecular structures that are\neither inaccurate or lack rationality. To address the above issues,\nthis paper proposes a novel 3D Molecule Generation via Diffusion Model\nwith a self-attention-based EÂ­( n ) equivariant graph\nneural network (EGNN) named MGDM-Sa, which incorporates a dual equivariant\nscore neural network  DualESNet , to capture the global\ngraph features and the local atomic environment. Especially, in  DualESNet , we design a novel equivariant encoder  eEncoder , which integrates EGNN and self-attention. During\nmessage propagation, EGNN ensures the equivariation of geometric features,\nand self-attention layer captures the long-range dependencies in\nthe molecular graph. Thus, this design enhances the representation\ncapability of MGDM-Sa. The experimental results demonstrate that MGDM-Sa\nis capable of generating valid, unique, novel, stable, and diverse\ndrug-like molecules, thereby underscoring its potential to accelerate\nthe drug discovery process."
  },
  "xml": "<?xml version=\"1.0\"  ?><!DOCTYPE pmc-articleset PUBLIC \"-//NLM//DTD ARTICLE SET 2.0//EN\" \"https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd\"><pmc-articleset><article xmlns:mml=\"http://www.w3.org/1998/Math/MathML\" xmlns:ali=\"http://www.niso.org/schemas/ali/1.0/\" xml:lang=\"en\" id=\"b121282583\" article-type=\"research-article\" dtd-version=\"1.4\"><processing-meta base-tagset=\"archiving\" mathml-version=\"3.0\" table-model=\"xhtml\" tagset-family=\"jats\"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type=\"nlm-ta\">ACS Omega</journal-id><journal-id journal-id-type=\"iso-abbrev\">ACS Omega</journal-id><journal-id journal-id-type=\"pmc-domain-id\">3686</journal-id><journal-id journal-id-type=\"pmc-domain\">acsomega</journal-id><journal-id journal-id-type=\"publisher-id\">ao</journal-id><journal-title-group><journal-title>ACS Omega</journal-title></journal-title-group><issn pub-type=\"epub\">2470-1343</issn><publisher><publisher-name>American Chemical Society</publisher-name></publisher><self-uri xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"http://pubs.acs.org/journal/acsodf\">http://pubs.acs.org/journal/acsodf</self-uri></journal-meta><article-meta><article-id pub-id-type=\"pmcid\">PMC12676313</article-id><article-id pub-id-type=\"pmcid-ver\">PMC12676313.1</article-id><article-id pub-id-type=\"pmcaid\">12676313</article-id><article-id pub-id-type=\"pmcaiid\">12676313</article-id><article-id pub-id-type=\"pmid\">41358140</article-id><article-id pub-id-type=\"doi\">10.1021/acsomega.5c10621</article-id><article-version article-version-type=\"pmc-version\">1</article-version><article-categories><subj-group subj-group-type=\"heading\"><subject>Article</subject></subj-group></article-categories><title-group><article-title>3D Molecule Generation\nvia Diffusion Model with a\nSelf-Attention-Based EGNN</article-title></title-group><contrib-group id=\"CONTRIB-GROUP-d14e23-autogenerated\"><contrib id=\"ath1\" contrib-type=\"author\"><contrib-id contrib-id-type=\"paragon-plus\" authenticated=\"true\">7752631</contrib-id><contrib-id contrib-id-type=\"orcid\" authenticated=\"true\">https://orcid.org/0009-0006-9276-0251</contrib-id><name name-style=\"western\"><surname>Yang</surname><given-names initials=\"H\">Huanai</given-names></name><xref rid=\"aff1\" ref-type=\"aff\"/></contrib><contrib id=\"ath2\" contrib-type=\"author\" corresp=\"yes\"><contrib-id contrib-id-type=\"paragon-plus\" authenticated=\"true\">7754897</contrib-id><contrib-id contrib-id-type=\"orcid\" authenticated=\"true\">https://orcid.org/0009-0008-8530-4973</contrib-id><name name-style=\"western\"><surname>Zhong</surname><given-names initials=\"Q\">Qi</given-names></name><xref rid=\"cor1\" ref-type=\"corresp\"/><xref rid=\"aff1\" ref-type=\"aff\"/></contrib><contrib id=\"ath3\" contrib-type=\"author\" corresp=\"yes\"><contrib-id contrib-id-type=\"paragon-plus\" authenticated=\"true\">7752339</contrib-id><contrib-id contrib-id-type=\"orcid\" authenticated=\"true\">https://orcid.org/0000-0003-0792-7792</contrib-id><name name-style=\"western\"><surname>Wang</surname><given-names initials=\"M\">Min</given-names></name><xref rid=\"cor2\" ref-type=\"corresp\"/><xref rid=\"aff2\" ref-type=\"aff\"/><xref rid=\"aff3\" ref-type=\"aff\"/></contrib><contrib id=\"ath4\" contrib-type=\"author\"><contrib-id contrib-id-type=\"paragon-plus\" authenticated=\"true\">7755006</contrib-id><contrib-id contrib-id-type=\"orcid\" authenticated=\"true\">https://orcid.org/0009-0005-5162-1362</contrib-id><name name-style=\"western\"><surname>Peng</surname><given-names initials=\"J\">Jianrong</given-names></name><xref rid=\"aff2\" ref-type=\"aff\"/></contrib><contrib id=\"ath5\" contrib-type=\"author\"><contrib-id contrib-id-type=\"paragon-plus\" authenticated=\"true\">7754900</contrib-id><contrib-id contrib-id-type=\"orcid\" authenticated=\"true\">https://orcid.org/0000-0003-0527-2251</contrib-id><name name-style=\"western\"><surname>Shen</surname><given-names initials=\"D\">Dingcai</given-names></name><xref rid=\"aff2\" ref-type=\"aff\"/></contrib><aff id=\"aff1\">\n<label>&#8224;</label>\n<institution content-type=\"dept\">School\nof Mathematics and Computer Science</institution>, <institution-wrap><institution-id institution-id-type=\"Ringgold\" specific-use=\"source:pplus\">12450</institution-id><institution>Gannan\nNormal University</institution></institution-wrap>, <city>Ganzhou</city>\n<postal-code>341000</postal-code>, <country country=\"CN\">China</country>\n</aff><aff id=\"aff2\">\n<label>&#8225;</label>\n<institution content-type=\"dept\">School\nof Intelligent Manufacturing and Future Energy</institution>, <institution>Gannan Normal University</institution>, <city>Ganzhou</city>\n<postal-code>341000</postal-code>, <country country=\"CN\">China</country>\n</aff><aff id=\"aff3\">\n<label>&#167;</label>\n<institution content-type=\"dept\">Key\nLaboratory of Data Science and Artificial Intelligence of Jiangxi\nEducation Institutes</institution>, <institution>Gannan Normal University</institution>, <city>Ganzhou</city>\n<postal-code>341000</postal-code>, <country country=\"CN\">China</country>\n</aff></contrib-group><author-notes><corresp id=\"cor1\"><label>*</label>Email: <email>zhongqi@gnnu.edu.cn</email>.</corresp><corresp id=\"cor2\"><label>*</label>Email: <email>wangmin@gnnu.edu.cn</email>.</corresp></author-notes><pub-date date-type=\"pub\" publication-format=\"electronic\"><day>17</day><month>11</month><year>2025</year></pub-date><pub-date date-type=\"collection\" publication-format=\"electronic\"><day>02</day><month>12</month><year>2025</year></pub-date><volume>10</volume><issue>47</issue><issue-id pub-id-type=\"pmc-issue-id\">501830</issue-id><fpage>57813</fpage><lpage>57829</lpage><history><date date-type=\"received\"><day>11</day><month>10</month><year>2025</year></date><date date-type=\"accepted\"><day>04</day><month>11</month><year>2025</year></date><date date-type=\"rev-recd\"><day>03</day><month>11</month><year>2025</year></date><date date-type=\"online\"><day>17</day><month>11</month><year>2025</year></date></history><pub-history><event event-type=\"pmc-release\"><date><day>17</day><month>11</month><year>2025</year></date></event><event event-type=\"pmc-live\"><date><day>05</day><month>12</month><year>2025</year></date></event><event event-type=\"pmc-last-change\"><date iso-8601-date=\"2025-12-08 15:25:12.403\"><day>08</day><month>12</month><year>2025</year></date></event></pub-history><permissions><copyright-statement>&#169; 2025 The Authors. Published by American Chemical Society</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>The Authors</copyright-holder><ali:free_to_read content-type=\"AuthorChoicev2\" start_date=\"2025-11-17\"/><license><ali:license_ref specific-use=\"textmining\" content-type=\"ccbyncndlicense\" start_date=\"2025-11-17\">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref><license-p>This article is licensed under CC-BY-NC-ND 4.0</license-p></license></permissions><self-uri xmlns:xlink=\"http://www.w3.org/1999/xlink\" content-type=\"pmc-pdf\" xlink:href=\"ao5c10621.pdf\"/><abstract><p>The discovery of\nnew drugs is of great significance to human health.\nThe diffusion model has emerged as a powerful tool for generating\n3D molecular structures, achieving significant success in various\napplications. However, existing models lack direct interatomic confinement\nfeatures and are difficult to capture long-range dependencies in macromolecules.\nThese issues lead to the generation of molecular structures that are\neither inaccurate or lack rationality. To address the above issues,\nthis paper proposes a novel 3D Molecule Generation via Diffusion Model\nwith a self-attention-based E&#173;(<italic toggle=\"yes\">n</italic>) equivariant graph\nneural network (EGNN) named MGDM-Sa, which incorporates a dual equivariant\nscore neural network <italic toggle=\"yes\">DualESNet</italic>, to capture the global\ngraph features and the local atomic environment. Especially, in <italic toggle=\"yes\">DualESNet</italic>, we design a novel equivariant encoder <italic toggle=\"yes\">eEncoder</italic>, which integrates EGNN and self-attention. During\nmessage propagation, EGNN ensures the equivariation of geometric features,\nand self-attention layer captures the long-range dependencies in\nthe molecular graph. Thus, this design enhances the representation\ncapability of MGDM-Sa. The experimental results demonstrate that MGDM-Sa\nis capable of generating valid, unique, novel, stable, and diverse\ndrug-like molecules, thereby underscoring its potential to accelerate\nthe drug discovery process.</p></abstract><abstract abstract-type=\"graphical\"><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"abs1\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0014.jpg\"/></abstract><abstract abstract-type=\"toc-graphic\"><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"tgr1\" specific-use=\"not-for-print\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0010.jpg\"/></abstract><funding-group><award-group id=\"fnd-1\"><funding-source><institution-wrap><institution>National Natural Science Foundation of China</institution><institution-id institution-id-type=\"doi\" vocab=\"open-funder-registry\" vocab-identifier=\"10.13039/open_funder_registry\">10.13039/501100001809</institution-id></institution-wrap></funding-source><award-id>62362002</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>pmc-status-qastatus</meta-name><meta-value>0</meta-value></custom-meta><custom-meta><meta-name>pmc-status-live</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-status-embargo</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-status-released</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-open-access</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-olf</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-manuscript</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-legally-suppressed</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-pdf</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-has-supplement</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-pdf-only</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-suppress-copyright</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-real-version</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-is-scanned-article</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-preprint</meta-name><meta-value>no</meta-value></custom-meta><custom-meta><meta-name>pmc-prop-in-epmc</meta-name><meta-value>yes</meta-value></custom-meta><custom-meta><meta-name>document-id-old-9</meta-name><meta-value>ao5c10621</meta-value></custom-meta><custom-meta><meta-name>document-id-new-14</meta-name><meta-value>ao5c10621</meta-value></custom-meta><custom-meta><meta-name>production-flag-MathML-config-version</meta-name><meta-value>3</meta-value></custom-meta><custom-meta><meta-name>production-flag-journal-citation-display-style</meta-name><meta-value>acs-titles</meta-value></custom-meta><custom-meta><meta-name>production-flag-journal-date-display-style</meta-name><meta-value>dates-used-rcd-rvd-acc</meta-value></custom-meta><custom-meta><meta-name>document-id-alt-64</meta-name><meta-value>f0c9d65d7703b5f2e38e22dc502ab95ac9c8bccc28bc3d86efad92cc2af904a2</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id=\"sec1\"><label>1</label><title>Introduction</title><p>Innovative drugs represent\na critical approach to addressing human\ndiseases. However, the cost associated with designing new drugs is\nprohibitively high. On average, developing a new drug from discovery\nto preclinical testing, clinical trials, approval, and marketing takes\napproximately 10 years and incurs an expense of US $2.6 billion, with\na return on investment of less than 2%.<xref rid=\"ref1\" ref-type=\"bibr\"/> With the rapid development of deep learning, various deep generative\nmodels have shown great potential in generating stable and diverse\nmolecules with desired properties and have achieved great success\nin the de novo generation of drug-like molecules with desired properties.</p><p>In recent years, deep-learning-based molecular generation methods\nhave mainly focused on three categories: SMILES-based methods, two-dimensional\nmolecular graph representation methods, and three-dimensional (3D)\nmolecular graph representation methods. SMILES is a representation\nmethod that converts molecules into ASCII strings based on predefined\natomic rules. Due to the sequential nature of SMILES representation,\nnatural language processing algorithms can be effectively applied\nto molecular generation tasks.<xref rid=\"ref2\" ref-type=\"bibr\"/> Therefore,\nresearchers have adopted deep learning models, including recurrent\nneural networks (RNN),<xref rid=\"ref3\" ref-type=\"bibr\"/> long short-term\nmemory networks (LSTM),<xref rid=\"ref4\" ref-type=\"bibr\"/> generative adversarial\nnetworks (GAN),<xref rid=\"ref5\" ref-type=\"bibr\"/> and generative pretraining\n(GPT),<xref rid=\"ref6\" ref-type=\"bibr\"/> to generate molecules based on\nSMILES representation. In molecular graphs, atoms are represented\nas nodes and chemical bonds are represented as edges. The types of\natoms and chemical bonds correspond to the labels of the nodes and\nedges, respectively. Representative methods for generating molecules\nbased on molecular graphs using deep generative models include VGAE,<xref rid=\"ref7\" ref-type=\"bibr\"/> JTVAE,<xref rid=\"ref8\" ref-type=\"bibr\"/> MolGAN,<xref rid=\"ref9\" ref-type=\"bibr\"/> and GraphNVP.<xref rid=\"ref10\" ref-type=\"bibr\"/> However,\nneither molecular graphs nor SMILES take into account the spatial\nconformation of compound molecules.</p><p>3D molecular conformation\ndetermines the biological, chemical,\nand physical properties of the molecule, such as charge distribution,\npotential energy, molecular docking, pharmacophore search, etc.<xref rid=\"ref11\" ref-type=\"bibr\"/> In 3D molecular generation, capturing the 3D\nspatial structure features is crucial. In recent years, with the rapid\ndevelopment of geometric deep learning in processing geometric data,<xref rid=\"ref12\" ref-type=\"bibr\"/> deep generative models for 3D molecular conformations\nhave gradually become a research hotspot, for instance, G-SchNet,<xref rid=\"ref13\" ref-type=\"bibr\"/> 3DMolNet,<xref rid=\"ref14\" ref-type=\"bibr\"/> ENF,<xref rid=\"ref15\" ref-type=\"bibr\"/> G-SphereNet,<xref rid=\"ref16\" ref-type=\"bibr\"/> MolGym,<xref rid=\"ref17\" ref-type=\"bibr\"/> Uni-Mol,<xref rid=\"ref18\" ref-type=\"bibr\"/> 3DLinker,<xref rid=\"ref19\" ref-type=\"bibr\"/> GeoMol,<xref rid=\"ref20\" ref-type=\"bibr\"/> ConfVAE,<xref rid=\"ref21\" ref-type=\"bibr\"/> etc. It is evident that 3D molecular structure\ndesign leveraging deep learning has experienced rapid development\nand achieved remarkable success.</p><p>By combining deep learning\nwith statistical physics, diffusion\nmodels can efficiently generate molecules with complex 3D structures\nand can be applied to novel drug design tasks. To address the challenge\nof maintaining equivariance in the 3D space, two strategies are primarily\nadopted. One is to leverage the equivariance of spatial geometric\nstructures,<xref rid=\"ref22\" ref-type=\"bibr\"/> with representative works\nincluding MDM<xref rid=\"ref23\" ref-type=\"bibr\"/> and 3D-EDiffMG.<xref rid=\"ref24\" ref-type=\"bibr\"/> The other is to utilize the E(3) equivariance<xref rid=\"ref25\" ref-type=\"bibr\"/> of intermediate geometric elements, with representative\nworks including GFMDiff,<xref rid=\"ref26\" ref-type=\"bibr\"/> EDM,<xref rid=\"ref27\" ref-type=\"bibr\"/> EEGSDE,<xref rid=\"ref28\" ref-type=\"bibr\"/> DiffBridges,<xref rid=\"ref29\" ref-type=\"bibr\"/> MolDiff,<xref rid=\"ref30\" ref-type=\"bibr\"/> Hier-Diff,<xref rid=\"ref31\" ref-type=\"bibr\"/> and GEOLDM.<xref rid=\"ref32\" ref-type=\"bibr\"/> However,\nthe existing diffusion models for 3D molecular generation lack direct\ninteratomic constraint features, making it difficult to capture long-range\ndependencies in molecules. This results in suboptimal generated structures,\nthereby limiting the stability and diversity of the generated molecules.</p><p>To address the above problems, we propose a 3D Molecule Generation\nvia Diffusion Model with a self-attention-based EGNN, named MGDM-Sa,\nfor molecule generation. In MGDM-Sa, the diffusion process is defined\nas a Markov chain, wherein Gaussian noise is systematically introduced\nto the data across a sequence of <italic toggle=\"yes\">T</italic> steps. To process\nthe global graph-level features and the local atomic environment,\nthe reverse process is to estimate the added noise by a dual equivariant\nscore neural network, named <italic toggle=\"yes\">DualESNet</italic>. Specifically, <italic toggle=\"yes\">DualESNet</italic> is composed of three components: edge construction,\ntwo equivariant encoders named <italic toggle=\"yes\">eEncoder</italic>, and two\nscoring blocks. The edge constructor constructs a long-distance encoder\nand a short-distance encoder to deal with different interatomic forces,\nrespectively. <italic toggle=\"yes\">eEncoder</italic> is designed as an equivariant\nencoder implemented by an improved EGNN combined with a self-attention\ndecoder. <italic toggle=\"yes\">eEncoder</italic> not only acquires node features\nand atomic coordinates through the message-passing mechanism but also\novercomes the problem of remote information loss in the native EGNN.\nScoring blocks aim to estimate the gradient of the log density of\natomic features and map it into a score vector. The experiments are\nconducted on two molecular data sets: QM9<xref rid=\"ref33\" ref-type=\"bibr\"/> and GEOM-Drug.<xref rid=\"ref34\" ref-type=\"bibr\"/> The experimental results\ndemonstrate that MGDM-Sa outperforms the baseline model in terms of\nperformance.</p><p>The main contributions of our work are as follows:<list list-type=\"bullet\"><list-item><p>For 3D molecular generation, we propose\na novel diffusion\nmodel named MGDM-Sa, which incorporates a novel dual equivariant score\nneural network named <italic toggle=\"yes\">DualESNet</italic>, to capture global\nand local information on molecular graphs and satisfy the E(3) equivariant\nproperty. It can generate effective and stable 3D structural molecules.</p></list-item><list-item><p>We design an equivariant encoder named <italic toggle=\"yes\">eEncoder</italic>, which utilizes EGNN to ensure the equivariance\nof geometric features\nand employs self-attention layer to capture long-range dependencies\nwithin molecular graphs.</p></list-item><list-item><p>The experimental\nresults show that MGDM-Sa can generate\ngeometric molecules and molecules with expected properties. Moreover,\nits performance is superior to that of the baseline models. Additionally,\nwe have demonstrated that the molecules generated by MGDM-Sa have\nthe potential to be candidate drugs.</p></list-item></list>\n</p><p>The rest of this article is organized as follows. <xref rid=\"sec2\" ref-type=\"sec\">Section <xref rid=\"sec2\" ref-type=\"sec\"/>\n</xref> provides background\ninformation\nand discusses related work. <xref rid=\"sec3\" ref-type=\"sec\">Section <xref rid=\"sec3\" ref-type=\"sec\"/>\n</xref> presents the diffusion model basis of our proposed\nmodel MGDM-Sa. <xref rid=\"sec4\" ref-type=\"sec\">Section <xref rid=\"sec4\" ref-type=\"sec\"/>\n</xref> presents the detailed design of our proposed model MGDM-Sa. The\nexperimental results and the analyses of molecules generated by MGDM-Sa\nare included in <xref rid=\"sec5\" ref-type=\"sec\">Sections <xref rid=\"sec5\" ref-type=\"sec\"/>\n</xref> and <xref rid=\"sec6\" ref-type=\"sec\">6</xref>, respectively. Finally, <xref rid=\"sec7\" ref-type=\"sec\">Section <xref rid=\"sec7\" ref-type=\"sec\"/>\n</xref> concludes this\narticle with some discussions.</p></sec><sec id=\"sec2\"><label>2</label><title>Related Work</title><p>Generative\nmodels based on 1D strings or 2D molecular graphs have\nbeen well established. However, these generative models fail to account\nfor the spatial conformations of compound molecules. 3D molecular\nconformations encompass geometric information such as position as\nwell as important physical principles such as symmetry. In comparison\nwith 1D string and 2D molecular graph representations, 3D geometric\nrepresentations substantially broaden the molecular space to be explored\nwhile simultaneously increasing the complexity of the task. The primary\nchallenge lies in ensuring that the model exhibits equivariance under\nrotation and translation operations in the 3D space. Currently, research\non molecular geometric representation primarily investigates isotropy\nthrough two strategies: E(3)-Invariant and E(3)-Equivariant. Next,\nwe delve into the methodologies for generating 3D molecules under\ndiffusion model frameworks with these two strategies.</p><sec id=\"sec2.1\"><label>2.1</label><title>E&#173;(3)-Invariant</title><p>One approach is to\nleverage E(3)-invariant 3D information by utilizing intermediate geometric\nelements, such as interatomic distances and angular data. Notable\nworks in this domain include SchNet,<xref rid=\"ref22\" ref-type=\"bibr\"/> PhysNet,<xref rid=\"ref35\" ref-type=\"bibr\"/> and DimNet.<xref rid=\"ref36\" ref-type=\"bibr\"/> MDM<xref rid=\"ref23\" ref-type=\"bibr\"/> employs SchNet for generating 3D molecular structures\nwhile enhancing the interatomic connections that are insufficiently\nrepresented in the 3D point cloud representation of molecules. MDM\nintroduces separate equivariant encoders to capture interatomic forces\nof varying strengths. Additionally, MDM incorporates a distribution\ncontrol variable at each diffusion-inversion step to enhance the molecular\ndiversity. Inspired by MDM, 3D-EDiffMG<xref rid=\"ref24\" ref-type=\"bibr\"/> introduces long-range dependence capture equivariant encoders to\nencode bonding and nonbonding information based on strong and weak\natomic interactions. Furthermore, 3D-EDiffMG integrates a gated multilayer\nperceptron module with minimal attention mechanisms to explicitly\nmodel complex long-sequence-feature interactions and long-range dependencies.\nAs a result, 3D-EDiffMG is capable of generating valid, stable, novel,\nunique, and diverse drug-like molecules.</p><p>Although our proposed\nmethod is grounded in the MDM framework,<xref rid=\"ref23\" ref-type=\"bibr\"/> it outperforms existing methods by leveraging an equivariant strategy\nfor constructing the diffusion model, thereby achieving superior performance.</p></sec><sec id=\"sec2.2\"><label>2.2</label><title>E&#173;(3)-Equivariant</title><p>The other is the\nequivariant strategy, whose representative works include SE(3)-Transformers,<xref rid=\"ref37\" ref-type=\"bibr\"/> EGNN,<xref rid=\"ref25\" ref-type=\"bibr\"/> etc. EGNN\nensures the equivariance of geometric features in the process of message\npropagation when dealing with graph structure data. Therefore, EGNN\noften plays a key role in molecular generation tasks. So far, there\nare many excellent frameworks that combine SE(3)-Transformers or EGNN\nfor molecular generation tasks. For instance, GFMDiff<xref rid=\"ref26\" ref-type=\"bibr\"/> is a generative diffusion model for molecules based on\nSE(3)-Transformers. GFMDiff<xref rid=\"ref26\" ref-type=\"bibr\"/> learns the\n3D geometry of molecules by acquiring features from atom features,\npairwise distance features, and three-way angle features and predicts\natom types, valences, and coordinates. In addition, the GFMDiff<xref rid=\"ref26\" ref-type=\"bibr\"/> model introduces GFLoss, which minimizes the\ndifference between the valence predicted by the dualTrack transformer\nnetwork (DTN) and the valence calculated from molecular geometry.\nDTN combined with geometrically facilitated loss achieves good molecular\nand atomic stability of the generated molecules.</p><p>Currently,\nmany diffusion model methods have achieved 3D molecule generation\ntasks by adopting an EGNN. EDM<xref rid=\"ref27\" ref-type=\"bibr\"/> is the\nfirst diffusion model that uses EGNN<xref rid=\"ref25\" ref-type=\"bibr\"/> to\ngenerate 3D molecules. However, EDM is incapable of learning the valence\nof different atom types and the constraint relationships between neighboring\natoms, which govern bond formation and distribution. Consequently,\nthe issue of inconsistent atom types and bonds arises, resulting in\nmolecular instability. Since then, a variety of models based on EGNN\nhave been proposed with the aim of enhancing the performance of EDM.\nFor instance, EEGSDE<xref rid=\"ref28\" ref-type=\"bibr\"/> uses the stochastic\ndifferential equations framework for capturing the dependencies between\ntwo variables and generating molecules with the desired properties.\nDiffBridges<xref rid=\"ref29\" ref-type=\"bibr\"/> introduced an energy function\ninto the diffusion bridge along with molecular geometry statistics\ncalculated from the data. However, the problem of atom types and bond\ninconsistencies that cause molecular instability remains. MolDiff<xref rid=\"ref30\" ref-type=\"bibr\"/> implements a two-stage diffusion model in order\nto solve the problem of inconsistent atom types and bonds. HierDiff<xref rid=\"ref31\" ref-type=\"bibr\"/> and GEOLDM<xref rid=\"ref32\" ref-type=\"bibr\"/> avoid\nthe atomic bond inconsistency problem by using EGNN<xref rid=\"ref25\" ref-type=\"bibr\"/> to embed structures into smaller domains.</p><p>The aforementioned\nmethod directly employs EGNN. In light of the\ncritical importance of capturing long-range dependencies, our proposed\nMGDM-Sa enhances EGNN by incorporating the Transformer encoder into\nthe EGNN layer, which consequently leads to a further improvement\nin model performance.</p></sec></sec><sec id=\"sec3\"><label>3</label><title>Preliminary</title><p>In this\nsection, we present the diffusion model basis of the method\nproposed in this paper. MGDM-Sa leverages DDPM<xref rid=\"ref38\" ref-type=\"bibr\"/> to perturb the data through a sequence of progressively\nincreasing Gaussian noise levels and simultaneously estimates the\nscore function for all noisy data distributions by training a deep\nneural network model conditioned on the noise magnitude. The DDPM\nis formulated as two Markov chains: the diffusion process and the\nreverse process.</p><sec id=\"sec3.1\"><label>3.1</label><title>Diffusion Process</title><p>Let <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m001.jpg\"/><mml:math id=\"d1e436\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> represents 3D molecular geometry. Here,\nthe <italic toggle=\"yes\">A</italic> &#8712; {0,1}<sup>\n<italic toggle=\"yes\">n</italic>&#215;<italic toggle=\"yes\">f</italic>\n</sup> represents the atomic features matrix, including\natomic types and atomic charges. <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m002.jpg\"/><mml:math id=\"d1e462\" display=\"inline\" overflow=\"scroll\"><mml:mi>R</mml:mi><mml:mo>&#8712;</mml:mo><mml:msup><mml:mi mathvariant=\"double-struck\">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#215;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></alternatives>\n</inline-formula> represents the atomic coordinates.</p><p>Given an initial molecular geometry <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m003.jpg\"/><mml:math id=\"d1e478\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#8764;</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>, we define\na fixed Markov chain over discrete\ntime steps <italic toggle=\"yes\">t</italic> &#8712; {1, ..., <italic toggle=\"yes\">T</italic>}. The forward process gradually perturbs the molecular conformation\nthrough Gaussian transitions controlled by a cosine variance schedule\n(&#946;<sub>1</sub>, ..., &#946;<sub>\n<italic toggle=\"yes\">T</italic>\n</sub>),\n&#946;<sub>\n<italic toggle=\"yes\">t</italic>\n</sub> &#8712; (0, 1).<xref rid=\"ref39\" ref-type=\"bibr\"/>\n<disp-formula id=\"eq1\"><label>1</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m004.jpg\"/><mml:math id=\"d1e517\" display=\"block\" overflow=\"scroll\"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m005.jpg\"/><mml:math id=\"d1e573\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"double-struck\">N</mml:mi></mml:math></alternatives>\n</inline-formula> indicates\nthat <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m006.jpg\"/><mml:math id=\"d1e580\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula> follows a normal distribution with a mean\nof <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m007.jpg\"/><mml:math id=\"d1e589\" display=\"inline\" overflow=\"scroll\"><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives>\n</inline-formula> and a variance\nof &#946;<sub>\n<italic toggle=\"yes\">t</italic>\n</sub>\n<italic toggle=\"yes\">I</italic>. In the\nsubsequent <xref rid=\"eq3\" ref-type=\"disp-formula\">eqs <xref rid=\"eq3\" ref-type=\"disp-formula\"/>\n</xref> and <xref rid=\"eq5\" ref-type=\"disp-formula\"/>, <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m008.jpg\"/><mml:math id=\"d1e621\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"double-struck\">N</mml:mi></mml:math></alternatives>\n</inline-formula> also\nrepresents a normal distribution.\nThe joint distribution conditioned on <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m009.jpg\"/><mml:math id=\"d1e628\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives>\n</inline-formula> satisfies the Markov property<disp-formula id=\"eq2\"><label>2</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m010.jpg\"/><mml:math id=\"d1e639\" display=\"block\" overflow=\"scroll\"><mml:mi>q</mml:mi><mml:mspace width=\"0.25em\"/><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>&#8719;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>Following ref <xref rid=\"ref40\" ref-type=\"bibr\" specific-use=\"ref-style=base-text\"/>, for all <italic toggle=\"yes\">t</italic> &#8712; {0, 1, ..., <italic toggle=\"yes\">T</italic>}, this Gaussian transition\nkernel allows us to marginalize the joint\ndistribution in <xref rid=\"eq1\" ref-type=\"disp-formula\">eq <xref rid=\"eq1\" ref-type=\"disp-formula\"/>\n</xref> to\nobtain an analytical form for <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m011.jpg\"/><mml:math id=\"d1e706\" display=\"inline\" overflow=\"scroll\"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>. For\n&#945;<sub>\n<italic toggle=\"yes\">t</italic>\n</sub>: = 1 &#8211; &#946;<sub>\n<italic toggle=\"yes\">t</italic>\n</sub> and <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m012.jpg\"/><mml:math id=\"d1e736\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#8719;</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:msub><mml:mi>&#945;</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula>, at any time step, the\ndata can be transformed\nby a reparameterization trick as follows:<disp-formula id=\"eq3\"><label>3</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m013.jpg\"/><mml:math id=\"d1e757\" display=\"block\" overflow=\"scroll\"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msqrt><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msqrt><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mspace width=\"0.25em\"/><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>If <italic toggle=\"yes\">t</italic> &#8594; &#8734;,\nthen <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m014.jpg\"/><mml:math id=\"d1e816\" display=\"inline\" overflow=\"scroll\"><mml:msqrt><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msqrt><mml:mo>&#8594;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#8594;</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives>\n</inline-formula>. So as the step size <italic toggle=\"yes\">t</italic> gradually increases, the\nfinal distribution will be closer to the\nstandard Gaussian distribution.</p></sec><sec id=\"sec3.2\"><label>3.2</label><title>Reverse\nProcess</title><p>To generate novel\nmolecular conformations, the reverse process progressively removes\nnoise from an initial Gaussian prior <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m015.jpg\"/><mml:math id=\"d1e848\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>&#8764;</mml:mo><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant=\"bold\">I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>, through a learned Markov chain. The joint\ndenoising distribution is factorized as<disp-formula id=\"eq4\"><label>4</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m016.jpg\"/><mml:math id=\"d1e870\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo>&#8719;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>\n<inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m017.jpg\"/><mml:math id=\"d1e928\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> is reverse transition, which follows a\nparameterized Gaussian distribution<disp-formula id=\"eq5\"><label>5</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m018.jpg\"/><mml:math id=\"d1e955\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>&#956;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m019.jpg\"/><mml:math id=\"d1e1017\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>&#956;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> is the denoising function parameterized\nby the neural network and &#963;<sub arrange=\"stack\">\n<italic toggle=\"yes\">t</italic>\n</sub>\n<sup arrange=\"stack\">2</sup> is the time-step dependent variance.</p><p>Following ref <xref rid=\"ref38\" ref-type=\"bibr\" specific-use=\"ref-style=base-text\"/>, we parameterize the denoising mean &#956;<sub>&#952;</sub> using\na noise prediction network <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m020.jpg\"/><mml:math id=\"d1e1049\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi></mml:math></alternatives>\n</inline-formula>\n<sub>&#952;</sub>:<disp-formula id=\"eq6\"><label>6</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m021.jpg\"/><mml:math id=\"d1e1058\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"bold-italic\">&#956;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mfrac><mml:mrow><mml:mo stretchy=\"true\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mfrac><mml:msub><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"true\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>Set &#963; to <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m022.jpg\"/><mml:math id=\"d1e1125\" display=\"inline\" overflow=\"scroll\"><mml:mfrac><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#945;&#773;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mfrac></mml:math></alternatives>\n</inline-formula>.The &#8722;<inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m023.jpg\"/><mml:math id=\"d1e1141\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi></mml:math></alternatives>\n</inline-formula>\n<sub>&#952;</sub>&#183;&#963; score can\nbe treated as the score,<xref rid=\"ref41\" ref-type=\"bibr\"/> so <italic toggle=\"yes\">S</italic>\n<sub>&#952;</sub> = &#8722;<inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m024.jpg\"/><mml:math id=\"d1e1156\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi></mml:math></alternatives>\n</inline-formula>\n<sub>&#952;</sub>&#183;&#963; is set.\nIt is the log density of the data points at each time step, pointing\nin the direction of the largest growth rate of the probability density\nfunction. Since the reverse process removes the noisy component added\nto the data during the diffusion process at each time step, it is\nequivalent to a traversal of the data distribution, starting from\nlow-density regions and progressively moving toward high-density regions\nguided by the log gradient. Thus, we can use <italic toggle=\"yes\">S</italic>\n<sub>&#952;</sub> in all relevant formulas in the following sections.\nWe parameterize &#956;<sub>&#952;</sub> to<disp-formula id=\"eq7\"><label>7</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m025.jpg\"/><mml:math id=\"d1e1171\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>&#956;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mfrac><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#946;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#183;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>\n</p></sec></sec><sec id=\"sec4\"><label>4</label><title>Methodology</title><p>In this section, we present\nthe detailed design of our proposed\nmodel MGDM-Sa.</p><sec id=\"sec4.1\"><label>4.1</label><title>Overview</title><p>\n<xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>a illustrates our proposed model MGDM-Sa,\nwhich is a framework for the 3D molecular generation diffusion model\nfor drug design. The framework of MGDM-Sa is implemented by denoising\ndiffusion probabilistic models (DDPM).<xref rid=\"ref38\" ref-type=\"bibr\"/> MGDM-Sa consists of two modules: the diffusion process and the reverse\nprocess. The diffusion process is formally defined as a Markov chain,\nwherein Gaussian noise is systematically introduced into the data\nacross a sequence of <italic toggle=\"yes\">T</italic> steps. The reverse process\nis to estimate the added noise by the dual equivariant score neural\nnetwork, named <italic toggle=\"yes\">DualESNet</italic>, thereby generating new\nmolecules from the training data. <italic toggle=\"yes\">DualESNet</italic> concurrently\nprocesses the global graph-level features and the local atomic environment\nto enhance the relationship modeling between nodes. Specially, <italic toggle=\"yes\">DualESNet</italic> is composed of three components: edge construction,\ntwo equivariant encoders <italic toggle=\"yes\">eEncoders</italic>, and two scoring\nblocks. Edge constructor, shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>b, is to extract features of edges in the\nmolecular graph and construct long and short edge representations\naccording to the bond length distribution characteristic. <italic toggle=\"yes\">eEncoder</italic>, shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>c, integrates the EGNN and self-attention layer. EGNN\nensures the equivariation of geometric features, while the self-attention\nmechanism addresses its limitation in modeling long-range dependencies.\n<italic toggle=\"yes\">eEncoder</italic> effectively fuses global and local information\nto comprehensively capture complex relationships and dependencies\nin molecular graphs. Scoring blocks, shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>d, aim to estimate the gradient of the log\ndensity of atomic features and map it to a score vector.</p><fig position=\"float\" id=\"fig1\" fig-type=\"figure\" orientation=\"portrait\"><label>1</label><caption><p>Our proposed\nmodel comprises two main components: the diffusion\nprocess and the reverse process. (a) Framework of MGDM-Sa, which implements\nthe diffusion model. (b) Edge encoder, which processes the edge information\non molecular graphs. (c) Equivariant encoder <italic toggle=\"yes\">eEncoder</italic>, whichupdates the atomic and coordinate features of the <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m074.jpg\"/><mml:math id=\"d1e1283\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula>. (d) Scoring block.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr1\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0001.jpg\"/></fig></sec><sec id=\"sec4.2\"><label>4.2</label><title>DualESNet</title><p>The 3D generated molecular\ngeometry is represented in the form of a point cloud, which requires\nrotation and translation equivariance. Therefore, MGDM-Sa should set\nan equivariant Markov kernel according to this property. K&#246;hler\net al.<xref rid=\"ref42\" ref-type=\"bibr\"/> proposed equivariant invertible\nfunctions that transform one invariant distribution into another.\nXu et al.<xref rid=\"ref43\" ref-type=\"bibr\"/> demonstrated that Markov chains\ninitialized with invariant priors and evolving via equivariant Markov\nkernels can induce invariant marginal distributions. Formally, setting <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m026.jpg\"/><mml:math id=\"d1e1302\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"double-struck\">T</mml:mi></mml:math></alternatives>\n</inline-formula> is\na rotation or translation operation. <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m027.jpg\"/><mml:math id=\"d1e1309\" display=\"inline\" overflow=\"scroll\"><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi mathvariant=\"double-struck\">T</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>, <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m028.jpg\"/><mml:math id=\"d1e1342\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi mathvariant=\"double-struck\">T</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">|</mml:mo><mml:mi mathvariant=\"double-struck\">T</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>. Furthermore, ref <xref rid=\"ref43\" ref-type=\"bibr\" specific-use=\"ref-style=base-text\"/> proved that the sample\ndistribution is guaranteed to be invariant to <italic toggle=\"yes\">x</italic>\n<sub>\n<italic toggle=\"yes\">T</italic>\n</sub>, that is <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m029.jpg\"/><mml:math id=\"d1e1414\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi mathvariant=\"double-struck\">T</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi mathvariant=\"bold\">x</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>. Thus, provided that the prior\nand transition\nkernels exhibit identical invariance properties, it is possible to\nconstruct a diffusion model capable of generating molecular conformations\ninvariant with rotation and translation.</p><p>As shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>, <italic toggle=\"yes\">DualESNet</italic> is composed of three components: edge construction, two <italic toggle=\"yes\">eEncoders</italic>, and two scoring blocks. We will present the detailed\nprinciples of <italic toggle=\"yes\">DualESNet</italic> and the workflow in the following.</p></sec><sec id=\"sec4.3\"><label>4.3</label><title>Edge Constructor</title><p>The generated 3D\nmolecular geometry is represented as a point cloud. How to model the\nedge of molecular conformation generation is of great significance\nfor molecular generation. For instance, ConfGF<xref rid=\"ref44\" ref-type=\"bibr\"/> uses Langevin dynamics sampling to ensure rotation and\ntranslation. However, ConfGF only considers the local distances and\nignores the long-range intramolecular nonbond interactions, such as\nvan der Waals forces. EDM<xref rid=\"ref27\" ref-type=\"bibr\"/> introduced\nfully connected edges. However, in EDM, all interatomic interactions\nare treated equally, resulting in the loss of covalent bond specificity\nand interference with redundant information. To ensure the effective\nprocessing of subsequent equivariant kernels, we systematically construct\nthe connecting edges between point clouds, by using the method proposed\nby ref <xref rid=\"ref23\" ref-type=\"bibr\" specific-use=\"ref-style=base-text\"/>\n</p><p>The\nbasic idea of the edge constructor is that the threshold radius &#964;\n= 2 &#197; is set according to the bond length distribution characteristics.\nSuch that a series of graph representations are generated after screening\nbased on atomic connections inside and outside the radius of the intramolecular\ninteraction force. These representations are then encoded through\nan edge encoder, shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>b. The edge encoder is responsible for encoding the\nchemical bond features into a vector form. Specifically, the module\nprocesses two types of key information: (1) discrete key types are\nmapped to fixed-dimensional vectors by embedding layers; and (2) continuous\nbond length features are projected through linear layers. Thus, the\nbond type and bond distance information are integrated through the\nfeature fusion layer to form a representation vector containing the\ncomplete characteristics of chemical bonds, which provides parsable\ninput for subsequent graph neural networks. Mathematically, this procedure\nof the edge encoder is formulated as follows.<disp-formula id=\"eq8\"><label>8</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m030.jpg\"/><mml:math id=\"d1e1479\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>h</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">P</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#8857;</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant=\"normal\">t</mml:mi><mml:mi mathvariant=\"normal\">y</mml:mi><mml:mi mathvariant=\"normal\">p</mml:mi><mml:mi mathvariant=\"normal\">e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></disp-formula>where MLP<sub>\n<italic toggle=\"yes\">e</italic>\n</sub> is\na multilayer perceptron structured as (<italic toggle=\"yes\">Linear</italic>, <italic toggle=\"yes\">ReLU</italic>, <italic toggle=\"yes\">Linear</italic>), <italic toggle=\"yes\">d</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub> = &#8741;<italic toggle=\"yes\">r</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> &#8211; <italic toggle=\"yes\">r</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">j</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup>&#8741;<sup>2</sup> is the Euclidean distance between atomic coordinates of node <italic toggle=\"yes\">i</italic> and <italic toggle=\"yes\">j</italic>, and <italic toggle=\"yes\">e</italic>\n<sub>type</sub> is the embedding of edge type, which is determined by the distance\nbetween atoms and chemical properties. <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">e</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>\n</sub> denotes the edge feature\nbetween the <italic toggle=\"yes\">i</italic>th atom and the <italic toggle=\"yes\">j</italic>th\natom. This design not only preserves the discrete chemical characteristics\nof covalent bonds but also incorporates continuous spatial information\non geometric constraints to realize multidimensional modeling of molecular\ninteractions.</p></sec><sec id=\"sec4.4\"><label>4.4</label><title>eEncoders</title><p>For\nthe long edge set and\nthe short edge set from the edge constructor, we design a dual equivalent\nencoder, consisting of a long-distance equivalent encoder and a short-distance\nequivalent encoder. Both long-distance equivariant encoders and short-distance\nequivariant encoders have the same structure as that of <italic toggle=\"yes\">eEncoder</italic>, which is an equivariant Markov kernel. The 3D molecular structure\nhas denaturation, such as translation and rotation. For this, we introduce\nEGNN<xref rid=\"ref25\" ref-type=\"bibr\"/> to achieve the equivariant property\nin <italic toggle=\"yes\">eEncoder</italic>. Furthermore, to enhance the representation\ncapabilities of the MGMD-Sa model, we consider incorporating the attention\nmechanism<xref rid=\"ref45\" ref-type=\"bibr\"/> into EGNN, to capture the relationship\nand dependency between nodes. As illustrated in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>c, <italic toggle=\"yes\">eEncoder</italic> consists of <italic toggle=\"yes\">M</italic> layers of EGNN and <italic toggle=\"yes\">N</italic> self-attention layers.\nSpecifically, when training the MGMD-Sa on the QM9 data set, the structure\nof <italic toggle=\"yes\">eEnconder</italic> is as follows:<disp-formula id=\"eq9\"><label>9</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m031.jpg\"/><mml:math id=\"d1e1623\" display=\"block\" overflow=\"scroll\"><mml:mrow><mml:mo stretchy=\"true\">{</mml:mo><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">Sa</italic> represents the self-attention\nlayer and <italic toggle=\"yes\">Eg</italic> represents the EGNN layer. Here, both <italic toggle=\"yes\">eEncoder</italic>\n<sub>\n<italic toggle=\"yes\">l</italic>\n</sub> and <italic toggle=\"yes\">eEncoder</italic>\n<sub>\n<italic toggle=\"yes\">s</italic>\n</sub> are composed of 3 self-attention layers\nand 6 EGNN layers. When training the MGMD-Sa GEOM-Drug data set, <italic toggle=\"yes\">eEnconder</italic> is as follows:<disp-formula id=\"eq10\"><label>10</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m032.jpg\"/><mml:math id=\"d1e1784\" display=\"block\" overflow=\"scroll\"><mml:mrow><mml:mo stretchy=\"true\">{</mml:mo><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>e</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>Here, <italic toggle=\"yes\">eEncoder</italic>\n<sub>\n<italic toggle=\"yes\">l</italic>\n</sub> consists of 1 self-attention\nlayer and 6 EGNN layers,\nwhile the <italic toggle=\"yes\">eEncoder</italic>\n<sub>\n<italic toggle=\"yes\">s</italic>\n</sub> consists\nof 1 self-attention layer and 4 EGNN layers. <italic toggle=\"yes\">eEncoder</italic> takes nodes embeddings <italic toggle=\"yes\">h</italic> = {<italic toggle=\"yes\">h</italic>\n<sub>0</sub>, ..., <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">n</italic>&#8211;1</sub>}, coordinate embeddings <italic toggle=\"yes\">r</italic> = {<italic toggle=\"yes\">r</italic>\n<sub>0</sub>, ..., <italic toggle=\"yes\">r</italic>\n<sub>\n<italic toggle=\"yes\">n</italic>&#8211;1</sub>}, and side information <italic toggle=\"yes\">e</italic> = {<italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">e</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>\n</sub>|<italic toggle=\"yes\">i</italic>,<italic toggle=\"yes\">j</italic> = 0, ..., <italic toggle=\"yes\">n</italic> &#8211; 1} as input.\nThe detailed procedures for <italic toggle=\"yes\">eEncoder</italic> are as follows.</p><p>(1) EGNN layer: We take the <italic toggle=\"yes\">l</italic>th EGNN layer as\nan example. It takes <italic toggle=\"yes\">h</italic>\n<sup>(<italic toggle=\"yes\">l</italic>&#8211;1)</sup>, <italic toggle=\"yes\">r</italic>\n<sup>(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> and <italic toggle=\"yes\">h</italic>\n<sub arrange=\"stack\">e</sub>\n<sup arrange=\"stack\">(l&#8211;1)</sup> as input. In detail, the processes of this EGNN layer are as follows.</p><p>Step 1: The message <italic toggle=\"yes\">m</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">ij</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> from\nnode <italic toggle=\"yes\">i</italic> to node <italic toggle=\"yes\">j</italic> is computed by<disp-formula id=\"eq11\"><label>11</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m033.jpg\"/><mml:math id=\"d1e1982\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">P</mml:mi></mml:mrow><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>,</mml:mo><mml:mo form=\"prefix\">&#8741;</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#8722;</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy=\"false\">&#8741;</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">e</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">ij</italic>\n</sub>\n<sup arrange=\"stack\">(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> is the feature\nof the edge at the (<italic toggle=\"yes\">l</italic> &#8211; 1)&#173;th layer, and MLP<sub>\n<italic toggle=\"yes\">e</italic>\n</sub> is the\nmultilayer perceptron of the edge used to compute the message <italic toggle=\"yes\">m</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">ij</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup>.</p><p>Step 2: The weight <italic toggle=\"yes\">w</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">ij</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> between\nthe solution nodes <italic toggle=\"yes\">i</italic> and <italic toggle=\"yes\">j</italic> is calculated\nas follows.<disp-formula id=\"eq12\"><label>12</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m034.jpg\"/><mml:math id=\"d1e2125\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>&#963;</mml:mi><mml:mo>&#183;</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>&#981;</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where MLP<sub>\n<italic toggle=\"yes\">w</italic>\n</sub> is\nthe multilayer perceptron, and &#963; is the Sigmoid activation function\nused to convert the output of MLP<sub>\n<italic toggle=\"yes\">w</italic>\n</sub> into\nweights.</p><p>Step 3: The message of node <italic toggle=\"yes\">i</italic>th at <italic toggle=\"yes\">l</italic>th layer is aggregated by<disp-formula id=\"eq13\"><label>13</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m035.jpg\"/><mml:math id=\"d1e2176\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#8712;</mml:mo><mml:mi mathvariant=\"script\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>&#183;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m036.jpg\"/><mml:math id=\"d1e2212\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> is the set of neighbor nodes of node <italic toggle=\"yes\">i</italic>.</p><p>Step\n4: Output the updated atomic coordinates along with the corresponding\nnodes. The feature representation <italic toggle=\"yes\">h</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">(<italic toggle=\"yes\">l</italic>)</sup> of node <italic toggle=\"yes\">i</italic> can be expressed as follows:<disp-formula id=\"eq14\"><label>14</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m037.jpg\"/><mml:math id=\"d1e2245\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">P</mml:mi></mml:mrow><mml:mi>h</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">h</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> and <italic toggle=\"yes\">h</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> are the\nfeature representations of node <italic toggle=\"yes\">i</italic> at layer <italic toggle=\"yes\">l</italic> and layer (<italic toggle=\"yes\">l</italic> &#8211; 1), respectively.\nMLP<sub>\n<italic toggle=\"yes\">h</italic>\n</sub> is a multilayer perception that fuses\nthe feature representation of the current layer and aggregates messages\nto generate the feature representation of the next layer.</p><p>For\nthe positional updating of node <italic toggle=\"yes\">i</italic>, we consider\nthe relative position difference between node <italic toggle=\"yes\">i</italic> and\nall its neighboring nodes. The coordinate of node <italic toggle=\"yes\">i</italic> at <italic toggle=\"yes\">l</italic>th layer is updated by<disp-formula id=\"eq15\"><label>15</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m038.jpg\"/><mml:math id=\"d1e2335\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#8800;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#8712;</mml:mo><mml:mi mathvariant=\"script\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#8722;</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#183;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">r</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> and <italic toggle=\"yes\">r</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> are the\nlocal representations of node <italic toggle=\"yes\">i</italic> at <italic toggle=\"yes\">l</italic>th layer and (<italic toggle=\"yes\">l</italic> &#8211; 1)&#173;th layer, respectively. <italic toggle=\"yes\">m</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">ij</italic>\n</sub>\n<sup arrange=\"stack\">\n<italic toggle=\"yes\">l</italic>\n</sup> is the message between node <italic toggle=\"yes\">i</italic> and its neighbor node <italic toggle=\"yes\">j</italic> at layer (<italic toggle=\"yes\">l</italic> + 1).</p><p>(2) Self-attention layer: To capture the relationship\nand dependency\nbetween nodes, we consider incorporating the attention mechanism into\nEGNN. The attention mechanism is an improved multihead attention mechanism,\nwhich aggregates the features of different nodes by calculating the\nsimilarity between queries, keys, and values. Mathematically, our\nproposed self-attention can be described by<disp-formula id=\"eq16\"><label>16</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m039.jpg\"/><mml:math id=\"d1e2462\" display=\"block\" overflow=\"scroll\"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">C</mml:mi><mml:mi mathvariant=\"normal\">A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">h</italic>\n<sub arrange=\"stack\">\n<italic toggle=\"yes\">i</italic>\n</sub>\n<sup arrange=\"stack\">(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> is the output\nof feature of node <italic toggle=\"yes\">i</italic> at the (<italic toggle=\"yes\">l</italic> &#8211;\n1)&#173;th layer. It should be noted that MCA takes\nnodes embeddings and coordinate embeddings as input in the current\ntime step, when <italic toggle=\"yes\">l</italic> = 1. <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m040.jpg\"/><mml:math id=\"d1e2521\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula> is a learned parameter used for aggregating\nthe global features of the graph. As shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>c, the self-attention layer has two attention\nlayers to process global labels and node features, respectively. The\nfirst attention layer interacts with global labels with node features\nto generate induced features. The second attention layer uses these\ninduced features to update the node features. In detail, the processes\nof this MCA module are as follows.</p><p>Step 1: Layer normalization\nfor feature of nodes <italic toggle=\"yes\">h</italic>\n<sup>(<italic toggle=\"yes\">l</italic>&#8211;1)</sup> and <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m041.jpg\"/><mml:math id=\"d1e2544\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula>. In this step, the input node feature <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">l</italic>\n</sub> and <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m042.jpg\"/><mml:math id=\"d1e2559\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula> are normalized first. Through the LN operator\nshown in <xref rid=\"eq17\" ref-type=\"disp-formula\">eq <xref rid=\"eq17\" ref-type=\"disp-formula\"/>\n</xref>, we can\nobtain features of nodes <italic toggle=\"yes\">h</italic>\n<sub>ln</sub> and <italic toggle=\"yes\">q</italic>\n<sub>ln</sub>.<disp-formula id=\"eq17\"><label>17</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m043.jpg\"/><mml:math id=\"d1e2582\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>h</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>LN</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>LN</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msubsup><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>Step 2: Residual connection with the\ntransformer encoder. This\noperator can be a formula as <xref rid=\"eq18\" ref-type=\"disp-formula\"/>.<disp-formula id=\"eq18\"><label>18</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m044.jpg\"/><mml:math id=\"d1e2622\" display=\"block\" overflow=\"scroll\"><mml:mrow><mml:mo stretchy=\"true\">{</mml:mo><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">T</mml:mi><mml:mi mathvariant=\"normal\">F</mml:mi><mml:mi mathvariant=\"normal\">e</mml:mi><mml:mi mathvariant=\"normal\">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">T</mml:mi><mml:mi mathvariant=\"normal\">F</mml:mi><mml:mi mathvariant=\"normal\">e</mml:mi><mml:mi mathvariant=\"normal\">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>where TFer (<italic toggle=\"yes\">h</italic>\n<sub>ln</sub>, <italic toggle=\"yes\">q</italic>\n<sub>ln</sub>) and TFer (<italic toggle=\"yes\">h</italic>\n<sub>ln</sub>, <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">t</italic>1</sub>) are the\nstandard transformer encoder with <italic toggle=\"yes\">S</italic> = 8 multihead\nself-attention mechanism. For brevity, we only present the procedure\nof <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m045.jpg\"/><mml:math id=\"d1e2718\" display=\"inline\" overflow=\"scroll\"><mml:mrow><mml:mi mathvariant=\"normal\">T</mml:mi><mml:mi mathvariant=\"normal\">F</mml:mi><mml:mi mathvariant=\"normal\">e</mml:mi><mml:mi mathvariant=\"normal\">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>ln</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>. First,\nfor the <italic toggle=\"yes\">i</italic>th head, <italic toggle=\"yes\">Q</italic>, <italic toggle=\"yes\">K</italic>, and <italic toggle=\"yes\">V</italic> are computed\nby linear transformation by <xref rid=\"eq19\" ref-type=\"disp-formula\"/>.<disp-formula id=\"eq19\"><label>19</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m046.jpg\"/><mml:math id=\"d1e2761\" display=\"block\" overflow=\"scroll\"><mml:mrow><mml:mo stretchy=\"true\">{</mml:mo><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>Q</mml:mi></mml:msub><mml:mo>&#183;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>ln</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>&#183;</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>&#183;</mml:mo><mml:msub><mml:mi mathvariant=\"script\">T</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">W</italic>\n<sub>\n<italic toggle=\"yes\">Q</italic>\n</sub>, <italic toggle=\"yes\">W</italic>\n<sub>\n<italic toggle=\"yes\">K</italic>\n</sub>, and <italic toggle=\"yes\">W</italic>\n<sub>\n<italic toggle=\"yes\">V</italic>\n</sub> are the learnable\nmatrixes.\nThen, the dot product between the query and the key is computed and\nscaled before applying the softmax function to obtain the attention\nweights. Thus, the output of the <italic toggle=\"yes\">s</italic>th head can be\nobtained by<disp-formula id=\"eq20\"><label>20</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m047.jpg\"/><mml:math id=\"d1e2829\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>z</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">s</mml:mi><mml:mi mathvariant=\"normal\">o</mml:mi><mml:mi mathvariant=\"normal\">f</mml:mi><mml:mi mathvariant=\"normal\">t</mml:mi></mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy=\"true\">(</mml:mo><mml:mfrac><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:msqrt><mml:mi>d</mml:mi></mml:msqrt></mml:mfrac><mml:mo stretchy=\"true\">)</mml:mo></mml:mrow><mml:mo>&#183;</mml:mo><mml:mi>V</mml:mi></mml:math></alternatives></disp-formula>\n</p><p>Finally,\nthe output of TFer (<italic toggle=\"yes\">h</italic>\n<sub>ln</sub>, <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">t</italic>\n</sub>) is obtained by a linear\ntransformation.<disp-formula id=\"eq21\"><label>21</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m048.jpg\"/><mml:math id=\"d1e2875\" display=\"block\" overflow=\"scroll\"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">C</mml:mi><mml:mi mathvariant=\"normal\">o</mml:mi><mml:mi mathvariant=\"normal\">n</mml:mi><mml:mi mathvariant=\"normal\">c</mml:mi><mml:mi mathvariant=\"normal\">a</mml:mi><mml:mi mathvariant=\"normal\">t</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#183;</mml:mo><mml:mi>W</mml:mi></mml:math></alternatives></disp-formula>where <italic toggle=\"yes\">z</italic> is\nthe output of\nthe transformer encoder, <italic toggle=\"yes\">W</italic> is the linear transformer\nmatrix, and <italic toggle=\"yes\">z</italic>\n<sub>\n<italic toggle=\"yes\">s</italic>\n</sub> is the\noutput of head <italic toggle=\"yes\">s</italic>.</p><p>Step 3: Residual layer with\nFFN. Like <xref rid=\"eq22\" ref-type=\"disp-formula\"/>,\nthe feed-forward neural network is used to output the final node features.<disp-formula id=\"eq22\"><label>22</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m049.jpg\"/><mml:math id=\"d1e2932\" display=\"block\" overflow=\"scroll\"><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>ln</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>LN</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>h</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>ln</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant=\"normal\">F</mml:mi><mml:mi mathvariant=\"normal\">F</mml:mi><mml:mi mathvariant=\"normal\">N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>ln</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></alternatives></disp-formula>\n</p></sec><sec id=\"sec4.5\"><label>4.5</label><title>Scoring Block</title><p>The scoring block aims\nto estimate the gradient of the log density of atomic features and\nmap the result into a score vector. As shown in <xref rid=\"fig1\" ref-type=\"fig\">Figure <xref rid=\"fig1\" ref-type=\"fig\"/>\n</xref>d, the scoring block consists of node MLP,\npairwise block, distance MLP, and dist-transition block modules. Next,\nthe score feature vectors are extracted by two aspects: node information\nand spatial information.</p><p>On the one hand, to estimate the gradient\nof the log density of atomic features, we utilize a MLP to transform\nthe latent hidden vectors <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">i</italic>\n</sub>, which are the outputs of the <italic toggle=\"yes\">eEncoder</italic>.<disp-formula id=\"eq23\"><label>23</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m050.jpg\"/><mml:math id=\"d1e3013\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>S</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">P</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where MLP<sub>\n<italic toggle=\"yes\">n</italic>\n</sub> is\na multilayer perceptron structured as (<italic toggle=\"yes\">Linear</italic>, <italic toggle=\"yes\">ReLU</italic>, <italic toggle=\"yes\">Linear</italic>, <italic toggle=\"yes\">ReLU</italic>, <italic toggle=\"yes\">Linear</italic>).</p><p>On the other hand, for computing of gradient\nof pairwise distance,\ntwo nodes and edges are spliced according to the side information.\nSpecifically, given an edge <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">e</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>\n</sub>, we can obtain the feature of\nnode <italic toggle=\"yes\">i</italic> and node <italic toggle=\"yes\">j</italic>. Thus, we can\nextract the gradient of pairwise distance by a MLP.<disp-formula id=\"eq24\"><label>24</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m051.jpg\"/><mml:math id=\"d1e3085\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>s</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant=\"normal\">M</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">P</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#8857;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy=\"false\">&#8741;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where MLP<sub>\n<italic toggle=\"yes\">d</italic>\n</sub> is\na multilayer perceptron structured as (<italic toggle=\"yes\">Linear</italic>, <italic toggle=\"yes\">ReLU</italic>, <italic toggle=\"yes\">Linear</italic>, <italic toggle=\"yes\">ReLU</italic>, <italic toggle=\"yes\">Linear</italic>). &#8857; is an element-wise multiply operator,\nand &#8741; is the concatenate operator. <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">i</italic>\n</sub> and <italic toggle=\"yes\">h</italic>\n<sub>\n<italic toggle=\"yes\">j</italic>\n</sub> are the features of nodes <italic toggle=\"yes\">i</italic> and <italic toggle=\"yes\">j</italic>, respectively. Second, the information on the score vector derived\nfrom pairwise distances and atomic coordinates <italic toggle=\"yes\">R</italic> is\nsubsequently integrated.<disp-formula id=\"eq25\"><label>25</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m052.jpg\"/><mml:math id=\"d1e3178\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi>s</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#8712;</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>&#183;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#183;</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>In <xref rid=\"eq25\" ref-type=\"disp-formula\">eq <xref rid=\"eq25\" ref-type=\"disp-formula\"/>\n</xref>, since <italic toggle=\"yes\">s</italic>\n<sub>&#952;</sub>(<italic toggle=\"yes\">d</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>) depends only on <italic toggle=\"yes\">d</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>, which is symmetrically\ninvariant, <italic toggle=\"yes\">s</italic>\n<sub>&#952;</sub>(<italic toggle=\"yes\">d</italic>\n<sub>\n<italic toggle=\"yes\">ij</italic>\n</sub>) is\ntranslation invariant. Additionally, (<italic toggle=\"yes\">r</italic>\n<sub>\n<italic toggle=\"yes\">i</italic>\n</sub> &#8211; <italic toggle=\"yes\">r</italic>\n<sub>\n<italic toggle=\"yes\">j</italic>\n</sub>) is the rotation and translation equivariance. Therefore, <italic toggle=\"yes\">s</italic>\n<sub>&#952;</sub>(<italic toggle=\"yes\">R</italic>) has an equivariant\nproperty, thereby ensuring that the whole Markov chain process preserves\nrotation and translation invariance.</p></sec><sec id=\"sec4.6\"><label>4.6</label><title>Loss\nFunction</title><p>In general, the key\nto diffusion models is to train the reverse Markov chain to match\nthe forward Markov chain. Therefore, the parameter &#952; needs to\nbe adjusted so that the joint distribution of <xref rid=\"eq4\" ref-type=\"disp-formula\">eq <xref rid=\"eq4\" ref-type=\"disp-formula\"/>\n</xref> of the reverse Markov chain is close to that\nof <xref rid=\"eq2\" ref-type=\"disp-formula\">eq <xref rid=\"eq2\" ref-type=\"disp-formula\"/>\n</xref> of the forward\nprocess. This can be achieved by minimizing the Kullback&#8211;Leibler\ndivergence between these two distributions<disp-formula id=\"eq26\"><label>26</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m053.jpg\"/><mml:math id=\"d1e3309\" display=\"block\" overflow=\"scroll\"><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:mstyle lineleading=\".25ex\" rowspacing=\"2ex\"><mml:mtable columnalign=\"left\" displaystyle=\"true\"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant=\"normal\">K</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">&#8741;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mover><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi mathvariant=\"double-struck\">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy=\"false\">[</mml:mo><mml:mi>log</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy=\"false\">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mover><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mi mathvariant=\"double-struck\">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy=\"true\">[</mml:mo><mml:mo form=\"prefix\">&#8722;</mml:mo><mml:mi>log</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&#8722;</mml:mo><mml:mrow><mml:munderover><mml:mo>&#8721;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo stretchy=\"true\">]</mml:mo></mml:mrow></mml:mrow><mml:mo>&#65080;</mml:mo></mml:munder><mml:mrow><mml:mo>&#8788;</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi mathvariant=\"normal\">V</mml:mi><mml:mi mathvariant=\"normal\">L</mml:mi><mml:mi mathvariant=\"normal\">B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mo>&#8805;</mml:mo><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:mover><mml:mi mathvariant=\"double-struck\">E</mml:mi><mml:mrow><mml:mo stretchy=\"false\">[</mml:mo><mml:mo form=\"prefix\">&#8722;</mml:mo><mml:mi>log</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></alternatives></disp-formula>where (<italic toggle=\"yes\">i</italic>) is the definition\nof KL divergence. Both <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m054.jpg\"/><mml:math id=\"d1e3626\" display=\"inline\" overflow=\"scroll\"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> and <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m055.jpg\"/><mml:math id=\"d1e3654\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi>p</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>...</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> in (<italic toggle=\"yes\">ii</italic>) are products of\ndistributions. (iii) follows from Jensen&#8217;s inequality.<xref rid=\"ref46\" ref-type=\"bibr\"/> In <xref rid=\"eq26\" ref-type=\"disp-formula\">eq <xref rid=\"eq26\" ref-type=\"disp-formula\"/>\n</xref>, (<italic toggle=\"yes\">ii</italic>) is the variational lower bound (VLB)\non the log-likelihood of the data <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m056.jpg\"/><mml:math id=\"d1e3695\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives>\n</inline-formula>, which is the objective function for training\na probabilistic generative model. Ho et al.<xref rid=\"ref38\" ref-type=\"bibr\"/> proposed a reweighting term in <italic toggle=\"yes\">L</italic>\n<sub>VLB</sub> to\nimprove the sample quality. Here, we use the following simplified\ntraining objective in reference to DDPM:<xref rid=\"ref38\" ref-type=\"bibr\"/>\n<disp-formula id=\"eq27\"><label>27</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m057.jpg\"/><mml:math id=\"d1e3713\" display=\"block\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">L</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant=\"double-struck\">E</mml:mi><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy=\"false\">[</mml:mo><mml:mi>&#955;</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy=\"false\">&#8741;</mml:mo><mml:msub><mml:mi mathvariant=\"normal\">&#8711;</mml:mi><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msub><mml:mspace width=\"0.25em\"/><mml:mi>log</mml:mi><mml:mo linebreak=\"nobreak\" lspace=\"0em\" rspace=\"0.25em\">&#8289;</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy=\"false\">|</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo>&#8722;</mml:mo><mml:msub><mml:mi mathvariant=\"bold\">s</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow><mml:mo stretchy=\"false\">&#8741;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy=\"false\">]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>\n</p><p>The above formula is derived from reference,<xref rid=\"ref47\" ref-type=\"bibr\"/> and we use it to denote a positive weighting\nfunction. We refer to PDMD<xref rid=\"ref48\" ref-type=\"bibr\"/> in the training\nphase in order to ignore &#955;, &#955; is set to 1 to simplify\nthe objective function. Such a simplified objective is equivalent\nto learning s<sub>&#952;</sub> according to the gradient of the log\ndensity of the data distribution by sampling the diffusion molecules <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m058.jpg\"/><mml:math id=\"d1e3803\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula> at a random time step <italic toggle=\"yes\">t</italic>. Alg. 1 gives out the pseudocode\nof the training process.<graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"dgr1\" position=\"anchor\" orientation=\"portrait\" xlink:href=\"ao5c10621_0011.jpg\"/>\n<graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"dgr2\" position=\"anchor\" orientation=\"portrait\" xlink:href=\"ao5c10621_0012.jpg\"/>\n</p></sec><sec id=\"sec4.7\"><label>4.7</label><title>Sampling</title><p>In the\nsampling process,\nwe employ Langevin dynamics to draw samples from the probability density.\nThe detailed steps of the sampling process are as follows: first,\nthe initial chaotic state <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m059.jpg\"/><mml:math id=\"d1e3823\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives>\n</inline-formula> is sampled from the normal distribution <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m060.jpg\"/><mml:math id=\"d1e3832\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula>. The\nStein score &#956;<sub>&#952;</sub> is then obtained through the <italic toggle=\"yes\">DualESNet</italic>. Subsequently,\naccording to <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m061.jpg\"/><mml:math id=\"d1e3852\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"double-struck\">N</mml:mi><mml:mrow><mml:mo stretchy=\"false\">(</mml:mo><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>&#956;</mml:mi><mml:mi>&#952;</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#963;</mml:mi><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy=\"false\">)</mml:mo></mml:mrow></mml:math></alternatives>\n</inline-formula> to obtain the chaotic state <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m062.jpg\"/><mml:math id=\"d1e3879\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>&#8722;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives>\n</inline-formula> at the\nnext time step. By repeating this\nprocess <italic toggle=\"yes\">T</italic> times, we finally generate the target molecule <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m063.jpg\"/><mml:math id=\"d1e3894\" display=\"inline\" overflow=\"scroll\"><mml:msub><mml:mi mathvariant=\"script\">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives>\n</inline-formula>. Alg. 2 is the pseudocode of the Sampling\nprocess.</p></sec></sec><sec id=\"sec5\"><label>5</label><title>Experiments</title><p>In this\nsection, we present a discussion around the experiments\nof MGDM-Sa. We conducted an experiment to evaluate both molecular\ngeometry generation and conditional molecular generation.</p><sec id=\"sec5.1\"><label>5.1</label><title>Data Set</title><p>Experiments for MGDM-Sa\nwere performed on two public chemical spatial data sets: QM9.<xref rid=\"ref33\" ref-type=\"bibr\"/> and GEOM-Drugs.<xref rid=\"ref34\" ref-type=\"bibr\"/> The detailed information regarding the data set is presented below.<list list-type=\"bullet\"><list-item><p>GEOM is a benchmark data set for\n3D molecule generation,\ncontaining millions of conformations of over 430k molecules, obtained\nfrom first-principles simulations. GEOM is split into two subsets:\nGeom-qm9 and Geom-Drugs. We use the GEOM-Drugs data set in this article.\nThe GEOM-Drugs data set consists of medium-size drug molecules with\na maximum of 181 atoms (91 heavy atoms) and contains an average of\n44.2 atoms with an average of 6.5 rotatable bonds per molecule.</p></list-item><list-item><p>QM9 is a benchmark data set for quantum\nproperty prediction,\nfrom the GDB17 data set. QM9 contains 133,885 small organic molecules\nconsisting of no more than 9 heavy atoms (C, O, N, and F). Each molecule\nhas 12 quantum properties such as geometry, energy, electron and thermodynamics,\nwhich are calculated by DFT.</p></list-item></list>\n</p></sec><sec id=\"sec5.2\"><label>5.2</label><title>Molecular Geometry Generation</title><p>In\nthis subsection, we discuss the experiments of MGDM-Sa in molecular\ngeometry generation from three aspects: baselines, metrics, and results.</p></sec><sec id=\"sec5.3\"><label>5.3</label><title>Baselines</title><p>In this experiment, MGDM-Sa\nperformed the geometric molecular generation task on the QM9 data\nset and GEOM-Drug data set. On the QM9 data set, we compare MGDM-Sa\nwith ENF,<xref rid=\"ref15\" ref-type=\"bibr\"/> SemlaFlow,<xref rid=\"ref50\" ref-type=\"bibr\"/> EDM,<xref rid=\"ref27\" ref-type=\"bibr\"/> MDM,<xref rid=\"ref23\" ref-type=\"bibr\"/> JODO,<xref rid=\"ref49\" ref-type=\"bibr\"/> 3D-EDiffMG,<xref rid=\"ref24\" ref-type=\"bibr\"/> and G-SchNet.<xref rid=\"ref13\" ref-type=\"bibr\"/> On\nthe GEOM-Drug data set, we compare MGDM-Sa with ENF, EDM, G-SchNet,\nand MDM.</p></sec><sec id=\"sec5.4\"><label>5.4</label><title>Metrics</title><p>We evaluate the quality of\nthe generated molecular mass using four metrics:<list list-type=\"bullet\"><list-item><p>Validity: the percentage of molecules generated according\nto the chemical valence rule.</p></list-item></list>\n<disp-formula id=\"eq28\"><label>28</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m064.jpg\"/><mml:math id=\"d1e3954\" display=\"block\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m065.jpg\"/><mml:math id=\"d1e3969\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi></mml:math></alternatives>\n</inline-formula> denotes the\nefficient rate, <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub> is\nthe number of effective molecules\nin the generated sample, and <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> is the number of generated molecules. The validity of the\ngenerated molecules was assessed using the RDKit chemistry toolkit.\nMolecules containing any atoms that violate standard chemical valence\nrules were deemed invalid.<list list-type=\"bullet\"><list-item><p>Uniqueness:\nthe proportion of unique effective molecules\nin the generated molecular sample.</p></list-item></list>\n<disp-formula id=\"eq29\"><label>29</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m066.jpg\"/><mml:math id=\"d1e3993\" display=\"block\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m067.jpg\"/><mml:math id=\"d1e4010\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi></mml:math></alternatives>\n</inline-formula> denotes uniqueness, <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">uv</italic>\n</sub> is the unique number of\neffective molecules\nin the generated sample, and <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> is the number of generated molecules.<list list-type=\"bullet\"><list-item><p>Novelty: the proportion of molecules not included in\nthe training data set.</p></list-item></list>\n<disp-formula id=\"eq30\"><label>30</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m068.jpg\"/><mml:math id=\"d1e4034\" display=\"block\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m069.jpg\"/><mml:math id=\"d1e4049\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi></mml:math></alternatives>\n</inline-formula> denotes the\nnovelty, <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">n</italic>\n</sub> is the number\nof generated novel molecules,\nthat is, the number of molecules that are not in the training data\nset, and <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub> denotes the\neffective number of molecules.<list list-type=\"bullet\"><list-item><p>Stability: the percentage of stable molecules in which\nall the atoms are in a stable state among the generated molecular\nsamples.</p></list-item></list>\n<disp-formula id=\"eq31\"><label>31</label><alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m070.jpg\"/><mml:math id=\"d1e4073\" display=\"block\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></disp-formula>where <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m071.jpg\"/><mml:math id=\"d1e4088\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi></mml:math></alternatives>\n</inline-formula> denotes the\nmolecular stability, <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">s</italic>\n</sub> denotes the number of stable\nmolecules, and <italic toggle=\"yes\">N</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub> is\nthe number of effective molecules.</p></sec><sec id=\"sec5.5\"><label>5.5</label><title>Results</title><p>\n<xref rid=\"tbl1\" ref-type=\"table\">Tables <xref rid=\"tbl1\" ref-type=\"table\"/>\n</xref> and <xref rid=\"tbl2\" ref-type=\"table\"/> and <xref rid=\"fig2\" ref-type=\"fig\">Figures <xref rid=\"fig2\" ref-type=\"fig\"/>\n</xref> and <xref rid=\"fig3\" ref-type=\"fig\"/> present the performance comparison\nbetween MGDM-Sa and baseline\nmodels. As shown in <xref rid=\"tbl1\" ref-type=\"table\">Table <xref rid=\"tbl1\" ref-type=\"table\"/>\n</xref>, MGDM-Sa significantly outperforms existing baseline models\non several key metrics of molecular generation. On the QM9 data set,\nin comparison with EDM, the MGDM-Sa exhibits significant enhancements\nin validity, stability, novelty, and uniqueness, with respective improvements\nof 8.27%, 7.16%, 27.9%, and 9.97%. Compared with MDM, MGDM-Sa achieves\nimprovements of 1.3%, 6.36%, and 2.87% in effectiveness, stability,\nand uniqueness, respectively. MGDM-Sa has a higher effectiveness rate\nof 4.86% compared to JODO. Compared to 3D-EDiffMG-atten, MGDM-Sa demonstrates\nincreases of 0.54%, 2.06%, and 5.07% in validity, stability, and uniqueness,\nrespectively. Compared with SemlaFlow, MGDM-Sa has increased the effectiveness\nby 0.54% and the uniqueness by 2.07%. Additionally, MGDM-Sa-NA achieves\nperformance comparable to that of 3D-EDiffMG-atten in terms of efficiency,\nstability, and uniqueness.</p><table-wrap position=\"float\" id=\"tbl1\" orientation=\"portrait\"><label>1</label><caption><title>Comparison of MGDM-Sa\nand the Baseline\nMethod in Three-Dimensional Molecular Generation Based on the QM9\nData Set<xref rid=\"t1fn1\" ref-type=\"table-fn\"/>\n</title></caption><table frame=\"hsides\" rules=\"groups\"><colgroup span=\"1\"><col align=\"left\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/></colgroup><thead><tr><th align=\"center\" colspan=\"1\" rowspan=\"1\">methods</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m075.jpg\"/><mml:math id=\"d1e4156\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m076.jpg\"/><mml:math id=\"d1e4166\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m077.jpg\"/><mml:math id=\"d1e4176\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m078.jpg\"/><mml:math id=\"d1e4186\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th></tr></thead><tbody><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">ENF<xref rid=\"ref15\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">41.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">40.1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">39.5</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">24.6</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">G-SchNet<xref rid=\"ref13\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">85.9</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">80.9</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">57.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">85.6</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">EDM<xref rid=\"ref27\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">91.7</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">90.5</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">59.9</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">91.1</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MDM-NV<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">97.8</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">91.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">80.1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">88.6</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MDM<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">98.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">94.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">90.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">91.9</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">JODO<xref rid=\"ref49\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">-</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">-</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">-</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">93.4</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">3D-EDiffMG<xref rid=\"ref24\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.3</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">90.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">98.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">96.0</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">3D-EDiffMG-attn<xref rid=\"ref24\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.4</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">92.4</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>99.3</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">96.2</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">SemlaFlow<xref rid=\"ref50\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.4</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">95.4</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">-</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>99.7</bold>\n</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MGDM-Sa-NA</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">98.71</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">90.38</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">87.42</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">96.7</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MGDM-Sa</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.97</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">97.47</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>87.8</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>98.26</bold>\n</td></tr></tbody></table><table-wrap-foot><fn id=\"t1fn1\"><label>a</label><p>This result\nis derived from comparing\nthe performance of 10,000 molecules generated by MGDM-Sa with that\nof the benchmark model in the molecular geometry generation task.\nAn upward arrow (&#8593;) denotes that higher values are indicative\nof superior performance. <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m079.jpg\"/><mml:math id=\"d1e4370\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi></mml:math></alternatives>\n</inline-formula>: validity; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m080.jpg\"/><mml:math id=\"d1e4377\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi></mml:math></alternatives>\n</inline-formula>: uniqueness; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m081.jpg\"/><mml:math id=\"d1e4384\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi></mml:math></alternatives>\n</inline-formula>: novelty; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m082.jpg\"/><mml:math id=\"d1e4391\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi></mml:math></alternatives>\n</inline-formula>: stability.</p></fn></table-wrap-foot></table-wrap><table-wrap position=\"float\" id=\"tbl2\" orientation=\"portrait\"><label>2</label><caption><title>Comparison of MGDM-Sa\nand the Baseline\nMethod in Three-Dimensional Molecular Generation Based on the GEOM-Drug\nData Set<xref rid=\"t2fn1\" ref-type=\"table-fn\"/>\n</title></caption><table frame=\"hsides\" rules=\"groups\"><colgroup span=\"1\"><col align=\"left\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/></colgroup><thead><tr><th align=\"center\" colspan=\"1\" rowspan=\"1\">methods</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m083.jpg\"/><mml:math id=\"d1e4427\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m084.jpg\"/><mml:math id=\"d1e4437\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m085.jpg\"/><mml:math id=\"d1e4447\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">% <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m086.jpg\"/><mml:math id=\"d1e4457\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi><mml:mo>&#8593;</mml:mo></mml:math></alternatives>\n</inline-formula>\n</th></tr></thead><tbody><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">ENF<xref rid=\"ref15\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">7.68</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">5.19</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">5.16</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">G-SchNet<xref rid=\"ref13\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">14.9</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">14.7</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">14.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">8.07</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">EDM<xref rid=\"ref27\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">68.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">68.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">68.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">13.7</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MDM-NV<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>99.8</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>99.5</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.5</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">42.3</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MDM<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.5</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">90.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">62.2</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">SemlaFlow<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">93.9</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">100.0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.6</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">97.3</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MGDM-Sa-NA</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">98.67</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">98.43</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">99.79</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">83.39</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MGDM-Sa</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">97.04</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">97.04</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>99.98</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>89.98</bold>\n</td></tr></tbody></table><table-wrap-foot><fn id=\"t2fn1\"><label>a</label><p>This result is derived from comparing\nthe performance of 10,000 molecules generated by MGDM-Sa with that\nof the benchmark model in the molecular geometry generation task.\nAn upward arrow (&#8593;) denotes that higher values are indicative\nof superior performance. <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m087.jpg\"/><mml:math id=\"d1e4596\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">V</mml:mi></mml:math></alternatives>\n</inline-formula>: validity; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m088.jpg\"/><mml:math id=\"d1e4603\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">U</mml:mi></mml:math></alternatives>\n</inline-formula>: uniqueness; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m089.jpg\"/><mml:math id=\"d1e4610\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">N</mml:mi></mml:math></alternatives>\n</inline-formula>: novelty; <inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m090.jpg\"/><mml:math id=\"d1e4617\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"script\">S</mml:mi></mml:math></alternatives>\n</inline-formula>: stability.</p></fn></table-wrap-foot></table-wrap><fig position=\"float\" id=\"fig2\" fig-type=\"figure\" orientation=\"portrait\"><label>2</label><caption><p>On the QM9 data set, the performance comparison\nbetween the MGDM-Sa\nand the benchmark models was conducted for the geometric molecule\ngeneration task. Orange indicates the most outstanding method.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr4\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0002.jpg\"/></fig><fig position=\"float\" id=\"fig3\" fig-type=\"figure\" orientation=\"portrait\"><label>3</label><caption><p>On the GEOM-Drug data set, the performance comparison\nbetween the\nMGDM-Sa and the benchmark models was conducted for the geometric molecule\ngeneration task. The orange color represents the method that demonstrated\nthe most outstanding performance.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr5\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0003.jpg\"/></fig><p>On the GEOM-Drug data set, in comparison with EDM,\nthe MGDM-Sa\nexhibits significant enhancements in validity, stability, novelty,\nand uniqueness, with respective improvements of 28.44%, 28.44%, 31.38%,\nand 76.28%. Compared with MDM, MGDM-Sa achieves improvements of 27.78%,\nand 9.98% in stability and uniqueness, respectively. Meanwhile, MGDM-Sa-NA\nachieves comparable performance to 3D-EDiffMG-atten in terms of validity\nand uniqueness. The experimental results show that in the GEOM-Drug\ndata set, MGDM-Sa has achieved a significant improvement in stability\nperformance.</p><p>These results indicate that MGDM-Sa possesses significant\nadvantages\nin the generation of high-quality molecular conformations. The essence\nof the performance improvement lies in the refined modeling of molecular\ninteractions achieved by the MGDM-Sa. Specifically, <italic toggle=\"yes\">DualESNet</italic> captures the differential characteristics of short-range strong\ninteractions and long-range weak interactions, while effectively addressing\nthe significant disparities in strength and range between these two\ntypes of interactions. In addition, MGDM-Sa follows the principle\nof equivariance of the molecular geometry to ensure the physical consistency\nof the generated conformations under translation and rotation operations. <italic toggle=\"yes\">eEncoder</italic> enhances the representation capability of the relationship\nbetween nodes by capturing and integrating global and local information,\nso as to significantly improve the chemical rationality and structural\ndiversity of the generated molecules.</p><p>On the other hand, we\nconducted ablation experiments to demonstrate\nthe impact of attention in <italic toggle=\"yes\">eEncoder</italic> on the performance\nof MGDM-Sa. We removed the self-attention layer in <italic toggle=\"yes\">eEncoder</italic> as a variant of MGDM-Sa and named it MGDM-Sa-NA. The experimental\nresults show that MGDM-Sa outperforms its variant MGDM-Sa-NA in terms\nof the validity, uniqueness, and stability of the generated molecules.\nFrom this, we can conclude that <italic toggle=\"yes\">eEncoder</italic> can more\ncomprehensively capture the relationships between nodes, thereby improving\nthe accuracy and rationality of the generated molecules and enhancing\nthe model&#8217;s expressive power. These results indicate that MGDM-Sa\nhas a significant advantage in generating high-quality molecular conformations.</p></sec></sec><sec id=\"sec6\"><label>6</label><title>Conditional Molecular Generation</title><p>Generating\nmolecules that satisfy certain desired properties is\nof positive significance for us to obtain drugs with specific properties.\nNext, we discuss the experiments of MGDM-Sa in conditional molecular\ngeneration from three aspects: metrics, baselines, and results.</p><sec id=\"sec6.1\"><label>6.1</label><title>Metrics</title><p>There are properties, that\nare often conditioned are<list list-type=\"bullet\"><list-item><p>&#945;:\nPolarizability in cubic Bohr radius (Bohr<sup>3</sup>).</p></list-item><list-item><p>&#956;: Dipole moment invariant (<italic toggle=\"yes\">D</italic>).</p></list-item><list-item><p>\n<inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m072.jpg\"/><mml:math id=\"d1e4677\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi></mml:math></alternatives>\n</inline-formula>\n<sub>HOMO</sub>: The highest occupied molecular\norbital energy in millielectron volts (meV).</p></list-item><list-item><p>\n<inline-formula>\n<alternatives><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_m073.jpg\"/><mml:math id=\"d1e4687\" display=\"inline\" overflow=\"scroll\"><mml:mi mathvariant=\"bold-italic\">&#1013;</mml:mi></mml:math></alternatives>\n</inline-formula>\n<sub>LUMO</sub>: The lowest unoccupied molecular\norbital energy in millielectron volts (meV).</p></list-item><list-item><p>&#1013;<sub>gap</sub>: The difference between &#1013;<sub>HOMO</sub> and &#1013;<sub>LUMO</sub>.</p></list-item><list-item><p>\n<italic toggle=\"yes\">C</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub>: The\nresulting molecules do not include the percentage of ions.</p></list-item></list>\n</p></sec><sec id=\"sec6.2\"><label>6.2</label><title>Experimental Setup</title><p>MGDM-Sa introduces\nthe above six attributes to condition the generated molecules. Based\non previous work EMD,<xref rid=\"ref27\" ref-type=\"bibr\"/> we utilize the\nattribute classifier in EGNN.<xref rid=\"ref25\" ref-type=\"bibr\"/> The set\nof QM9<xref rid=\"ref33\" ref-type=\"bibr\"/> is divided into two parts, each\ncontaining 50K samples. One-half denoted as <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> is used for classifier training, and the\nother half denoted as <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> is used for generative model training. The classifier &#981;<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> then evaluates the attribute-based conditional\ngeneration samples by the mean absolute error between the predicted\nattribute value and the true attribute value.</p></sec><sec id=\"sec6.3\"><label>6.3</label><title>Baselines</title><p>Here, we compare with several\nbaseline references:<list list-type=\"bullet\"><list-item><p>Naive (Upper-Bond):\nThe relationship between molecule\nand attribute is removed. The <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> is evaluated by the classifier &#981;<sub>\n<italic toggle=\"yes\">c</italic>\n</sub>. The labels are shuffled in <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> to predict molecules whose molecular properties\nrequire properties.</p></list-item><list-item><p>Atoms: The classifier\n&#981;<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> predicts the molecular properties\non <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub> by the number of\natoms.</p></list-item><list-item><p>EDM:<xref rid=\"ref27\" ref-type=\"bibr\"/> The first diffusion\nmodel uses EGNN to generate 3D molecules.</p></list-item><list-item><p>MDM:<xref rid=\"ref23\" ref-type=\"bibr\"/> A diffusion model\nemploys SchNet for the generation of 3D molecular structures, introduces\nseparate equivariant encoders to capture interatomic forces of varying\nstrengths, and incorporates a distribution control variable at each\ndiffusion-inversion step to enhance molecular diversity.</p></list-item><list-item><p>QM9 (Lower-Bond): The classifier &#981;<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> evaluates the original <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> to predict molecular properties.</p></list-item></list>\n</p></sec><sec id=\"sec6.4\"><label>6.4</label><title>Results</title><p>The results of conditional\nmolecule generation are shown in <xref rid=\"tbl3\" ref-type=\"table\">Table <xref rid=\"tbl3\" ref-type=\"table\"/>\n</xref> and <xref rid=\"fig4\" ref-type=\"fig\">Figure <xref rid=\"fig4\" ref-type=\"fig\"/>\n</xref>. First, MGDM-Sa performs well in predicting electronic structures:\nthe mean absolute errors of &#1013;<sub>HOMO</sub> and &#1013;<sub>LUMO</sub> are 0.0049 and 0.0151 lower than those of MDM, respectively,\nand even outperform the QM9 benchmark. Second, the experimental results\nof MGDM-Sa on &#1013;<sub>gap</sub> are 0.0145 lower than those of\nthe comparison model MDM and 0.0345 lower than the QM9 benchmark.\nMeanwhile, in terms of &#956;, MGDM-Sa outperforms EDM<xref rid=\"ref27\" ref-type=\"bibr\"/> and MDM,<xref rid=\"ref23\" ref-type=\"bibr\"/> with the\nmean absolute error of MGDM-Sa being 0.0061 lower than that of EDM.\nHowever, the results of MGDM-Sa on <italic toggle=\"yes\">C</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub> and &#945; are not ideal. This might be due to\nthe fact that MGDM-Sa may overfit the electronic property targets\nduring the generation process, sacrificing the rationality and diversity\nof molecular structures. Particularly, the lower index results compared\nto the QM9<xref rid=\"ref33\" ref-type=\"bibr\"/> benchmark might be attributed\nto the smaller distribution difference between <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">c</italic>\n</sub> and <italic toggle=\"yes\">D</italic>\n<sub>\n<italic toggle=\"yes\">g</italic>\n</sub>. The experimental results indicate that MGDM-Sa has the ability\nto generate molecules with the targeted properties.</p><table-wrap position=\"float\" id=\"tbl3\" orientation=\"portrait\"><label>3</label><caption><title>A Performance Comparison of the MGDM-Sa\nagainst Baseline Models in the Conditional Molecule Generation Task<xref rid=\"t3fn1\" ref-type=\"table-fn\"/>\n</title></caption><table frame=\"hsides\" rules=\"groups\"><colgroup span=\"1\"><col align=\"left\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/></colgroup><thead><tr><th align=\"center\" colspan=\"1\" rowspan=\"1\">methods</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">&#945; &#8595;</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">&#956;\n&#8595;</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">&#1013;<sub>HOMO</sub> &#8595;</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">&#1013;<sub>LUMO</sub> &#8595;</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">&#1013;<sub>gap</sub> &#8595;</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<italic toggle=\"yes\">C</italic>\n<sub>\n<italic toggle=\"yes\">v</italic>\n</sub> &#8595;</th></tr></thead><tbody><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">naive (U)</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">9.013</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.616</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.645</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.457</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.472</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">6.857</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">#atoms</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">3.862</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.053</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.426</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.813</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.866</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.971</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">EDM<xref rid=\"ref27\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">2.760</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.111</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.356</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.584</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.655</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.101</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MDM<xref rid=\"ref23\" ref-type=\"bibr\"/>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.591</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.177</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.019</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.040</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.044</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.647</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">MGDM-Sa</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">3.0811</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>1.1049</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>0.0141</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>0.0249</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<bold>0.0295</bold>\n</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">5.2179</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">QM9&#160;(L)</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.100</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.043</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.039</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.036</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.064</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.040</td></tr></tbody></table><table-wrap-foot><fn id=\"t3fn1\"><label>a</label><p>The downward arrow (&#8595;) signifies\nthat lower values correspond to improved model performance.</p></fn></table-wrap-foot></table-wrap><fig position=\"float\" id=\"fig4\" fig-type=\"figure\" orientation=\"portrait\"><label>4</label><caption><p>Comparison of various methods in the conditional\nmolecule generation\ntask. Orange represents MGMD-Sa.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr6\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0004.jpg\"/></fig></sec></sec><sec id=\"sec7\"><label>7</label><title>Analysis</title><sec id=\"sec7.1\"><label>7.1</label><title>Statistical Analysis</title><p>In this subsection,\nwe will analyze the molecules generated by MGDM-Sa from three perspectives:\nthe distribution of molecular properties, the distribution of data\ntypes, and the comparison of molecular structures.</p></sec><sec id=\"sec7.2\"><label>7.2</label><title>Distribution of Molecular Properties</title><p>To validate that\nMGDM-Sa is capable of generating molecules with\nreasonable physicochemical and pharmacokinetic properties, we conducted\nan analysis of the distribution of 10,000 molecular samples generated\nby MGDM-Sa across five key properties, essential for drug development. <xref rid=\"fig5\" ref-type=\"fig\">Figures <xref rid=\"fig5\" ref-type=\"fig\"/>\n</xref> and <xref rid=\"fig6\" ref-type=\"fig\"/>, respectively, illustrate the distribution of five properties\nfor 10,000 samples generated by MGDM-Sa on the QM9 data set and GEOM-Drug.\nThe specific analysis is as follows:<list list-type=\"bullet\"><list-item><p>log <italic toggle=\"yes\">P</italic>: The median values of log <italic toggle=\"yes\">P</italic> on the QM9 data set and the GEOM-Drug data set are 1.17\nand 2.82, respectively. Lipinski&#8217;s five rules<xref rid=\"ref51\" ref-type=\"bibr\"/> suggest that log <italic toggle=\"yes\">P</italic> should be less than\nor equal to 5. This suggests that these molecules maintain a favorable\nbalance in terms of hydrophilicity.</p></list-item><list-item><p>SAScore: The median values of SAScore in the QM9 data\nset and the GEOM-Drug data set are 3.87 and 4.02, respectively. Moreover,\nthe IQRs are (3.2, 4.5) and (3.5, 4.5), respectively. This suggests\nthat the synthetic accessibility of these molecules is moderate, indicating\nthat they can be synthesized through feasible routes without introducing\nexcessive complexity during the manufacturing process.</p></list-item><list-item><p>TPSA: The molecules in the QM9 data set generally exhibit\nrelatively low TPSA values, as they are predominantly small and low-polarity\ncompounds. These molecules typically lack polar functional groups\nor large structural frameworks, which results in the low TPSA values\nobserved in the molecules generated by MGDM-Sa. The median TPSA was\n12.47 &#197;<sup>2</sup>, with an IQR of 3.0 &#197;<sup>2</sup> to\n23 &#197;<sup>2</sup>. The low value indicates that most of these\nmolecules are relatively hydrophobic, have strong lipophilicity, and\nhave a good ability to penetrate cell membranes. On the GEOM-Drug\ndata set, the median value of TPSA is 61.44 &#197;<sup>2</sup>. It\nis indicated that the molecule as a whole has a certain degree of\npolarity. Furthermore, the IQR range is wide, indicating that the\npolarity distribution of the molecules is broad, possibly encompassing\nvarious structures ranging from polar to nonpolar. This also indicates\nthe complexity and diversity of the molecular structures in the GEOM-Drug\ndata set.</p></list-item><list-item><p>MolWt: On the QM9 data set,\nthe median MolWt is 110.20\nDa. This complies with Lipinski&#8217;s five rules,<xref rid=\"ref51\" ref-type=\"bibr\"/> as typically an oral drug molecule should have a molecular\nweight of less than 500 Da. Additionally, in the GEOM-Drug data set,\nthe median MolWt is 337.460 Da, which falls within the ideal range\nof (200,500) Da. Moreover, the IQR shows that most molecules are concentrated\nin the range of (280,390) Da, which meets the drug-likeness requirements.</p></list-item><list-item><p>QED: Although the QED value on the QM9 data\nset is slightly\nlower at 0.46, the median QED on the GEOM-Drug data set reaches 0.61.\nThis indicates that these compounds exhibit good drug similarity and\ncan be regarded as promising candidates for drug development.</p></list-item></list>\n</p><fig position=\"float\" id=\"fig5\" fig-type=\"figure\" orientation=\"portrait\"><label>5</label><caption><p>Distribution of 10,000 molecules generated by MGDM-Sa\non the QM9\ndata set in terms of log <italic toggle=\"yes\">P</italic>, SA score, TPSA, MolWt,\nand QED.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr7\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0005.jpg\"/></fig><fig position=\"float\" id=\"fig6\" fig-type=\"figure\" orientation=\"portrait\"><label>6</label><caption><p>Distribution of 10,000 molecules generated by\nMGDM-Sa on the GEOM-Drug\ndata set in terms of log <italic toggle=\"yes\">P</italic>, SA score, TPSA, MolWt,\nand QED.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr8\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0006.jpg\"/></fig></sec><sec id=\"sec7.3\"><label>7.3</label><title>Comparison\nof Molecular Structures</title><p>We compared the three-dimensional\nstructures of the molecules in\nthe QM9 data set with those generated by MGDM-Sa and also compared\nthe molecules in the GEOM-Drug data set with those generated by MGDM-Sa.\nFor example, <xref rid=\"fig7\" ref-type=\"fig\">Figure <xref rid=\"fig7\" ref-type=\"fig\"/>\n</xref>a reveals that the difference in bond angle at the same position\nof the two molecules is merely 0.9d&#176;, the difference in bond\nlength is only 0.1 &#197;, and the difference in the dihedral angle\nis 44.8&#176;. The six comparison diagrams presented in <xref rid=\"fig7\" ref-type=\"fig\">Figure <xref rid=\"fig7\" ref-type=\"fig\"/>\n</xref> demonstrate that there are\nminor differences in bond length and bond angle between the molecules\nof QM9 and MGDM-Sa. However, a certain disparity exists in the dihedral\nangle. Therefore, it can be evidenced that MGDM-Sa has the capacity\nto learn molecular topology and is capable of generating drug-like\nmolecules that are both similar to and novel compared to those in\nthe QM9 data set or GEOM-Drug data set.</p><fig position=\"float\" id=\"fig7\" fig-type=\"figure\" orientation=\"portrait\"><label>7</label><caption><p>Light blue represents\nthe molecule generated by MGDM-Sa, while\ngreen represents the molecules in the original data set. (a,c,e) Molecules\nformed by the interaction of the molecules in QM9 with MGDM-Sa. (b,d,f)\nMolecules generated by the interaction of the molecules in GEOM-Drug\nwith MGDM-Sa. Among them, the purple ones are bond angles, the blue\nones are dihedral angles, and the red ones are bond lengths.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr9\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0007.jpg\"/></fig></sec><sec id=\"sec7.4\"><label>7.4</label><title>Molecular Property Analysis</title><p>In this\nsubsection, to verify the potential of the molecules generated by\nMGDM-Sa to become drug candidates, we will discuss and analyze the\nnew molecules from three aspects: basic molecular properties, ADMET\npredictions, and molecular docking.</p><p>First, the molecules generated\nby MGDM-Sa have the potential to be viable drug candidates. We randomly\nselected four molecules from the samples, which were generated by\nMGDM-Sa. These molecular structures are shown in <xref rid=\"fig8\" ref-type=\"fig\">Figure <xref rid=\"fig8\" ref-type=\"fig\"/>\n</xref>. Furthermore, <xref rid=\"tbl4\" ref-type=\"table\">Table <xref rid=\"tbl4\" ref-type=\"table\"/>\n</xref> presents the prediction results\nof the nine properties. For instance, the log <italic toggle=\"yes\">P</italic> of\nM-1 is 2.7, which falls within the reasonable range of (1.5). The\nQED of M-2 is 0.8. A QED greater than 0.67 is generally regarded as\nhaving good drug potential. The SAScores of the four molecules are\nall less than 5, which indicates that they are relatively easy-to-synthesize\ncompounds.</p><fig position=\"float\" id=\"fig8\" fig-type=\"figure\" orientation=\"portrait\"><label>8</label><caption><p>(a,b) Structural fragments generated by MGDM-Sa in the QM9 data\nset. (c,d) Molecular structures generated by MGDM-Sa in the GEOM-Drug\ndata set.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr10\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0008.jpg\"/></fig><table-wrap position=\"float\" id=\"tbl4\" orientation=\"portrait\"><label>4</label><caption><title>Prediction of Nine\nFundamental Properties\nof Some Generated Molecules<xref rid=\"t4fn1\" ref-type=\"table-fn\"/>\n</title></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr11\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0015.jpg\"/><table-wrap-foot><fn id=\"t4fn1\"><label>a</label><p>Log <italic toggle=\"yes\">P</italic>: logarithm\nof partition coefficient; QED: quantitative score of drug similarity;\nSAScore: composite feasibility score; MolWt: molecular weight; TPSA:\ntopological polar surface area; HBA: number of hydrogen bond acceptors;\nHBD: number of hydrogen bond donors; rotatable bonds: number of rotatable\nkeys; aromatic rings: number of aromatic rings.M1 and M2 are the molecules\ngenerated by MGDM-Sa on the QM9 data set. M3 and M4 are the molecules\ngenerated by MGDM-Sa on the GEOM-Drug data set.</p></fn></table-wrap-foot></table-wrap><p>Second, to verify the capability\nof MGDM-Sa to generate drug-like\nmolecules, we conducted an analysis of the absorption, distribution,\nmetabolism, excretion, and toxicity (ADMET) properties of the generated\nmolecules. As shown in <xref rid=\"tbl5\" ref-type=\"table\">Table <xref rid=\"tbl5\" ref-type=\"table\"/>\n</xref>, the compounds are mostly within a reasonable\nrange in drug development, meeting the common standards for drug candidates.\nAs shown in <xref rid=\"tbl5\" ref-type=\"table\">Table <xref rid=\"tbl5\" ref-type=\"table\"/>\n</xref>, most of these properties fall within the reasonable range for drug\ndevelopment and meet the common standards for drug candidates. For\ninstance, the Coca-2 of M-1 is &#8722;4.67, which is greater than\n&#8722;1.15. The PPB of M-2 is 47.892%, which is less than 90%. The\nCYD2D6-I of M-3 is 0, indicating it belongs to the noninhibitor category.\nThe DILI of M-4 is 0, suggesting that it is a drug without DILI risk.\nMoreover, combining <xref rid=\"tbl4\" ref-type=\"table\">Tables <xref rid=\"tbl4\" ref-type=\"table\"/>\n</xref> and <xref rid=\"tbl5\" ref-type=\"table\"/>, we can see that the molecules\ngenerated by MGDM-Sa perform well in terms of physical and chemical\nproperties, drug-like properties, absorption, distribution, and toxicity.\nTherefore, MGDM-Sa can generate molecules with a potential druggability.</p><table-wrap position=\"float\" id=\"tbl5\" orientation=\"landscape\"><label>5</label><caption><title>Prediction of Molecular Absorption,\nDistribution, Metabolism, Excretion, and Toxicity (ADMET Properties<xref rid=\"t5fn1\" ref-type=\"table-fn\"/>,<xref rid=\"t5fn2\" ref-type=\"table-fn\"/>\n</title></caption><table frame=\"hsides\" rules=\"groups\"><colgroup span=\"1\"><col align=\"left\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/><col align=\"char\" char=\".\" span=\"1\"/></colgroup><thead><tr><th align=\"center\" colspan=\"1\" rowspan=\"1\">molecules</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">Caco-2</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">HIA</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">PPB</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">BBB</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">VDss</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2D6-I</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 3A4-I</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2C9-I</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2D6-S</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 3A4-S</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2C9-S</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2C19-I</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2C19-S</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2B6-I</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CYP 2B6-S</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">CL</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">\n<italic toggle=\"yes\">T</italic>\n<sub>1/2</sub>\n</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">hERG</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">AMES</th><th align=\"center\" char=\".\" colspan=\"1\" rowspan=\"1\">DILI</th></tr></thead><tbody><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">M-1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">&#8211;4.67</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">38.174</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.361</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">12.028</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.718</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">M-2</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">&#8211;4.323</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">47.892</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.412</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">11.074</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.286</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">M-3</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">&#8211;5.182</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">53.633</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">&#8211;0.035</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">6.771</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.77</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td></tr><tr><td align=\"left\" colspan=\"1\" rowspan=\"1\">M-4</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">&#8211;4.959</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">59.046</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0.242</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">8.97</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">1.623</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td><td align=\"char\" char=\".\" colspan=\"1\" rowspan=\"1\">0</td></tr></tbody></table><table-wrap-foot><fn id=\"t5fn1\"><label>a</label><p>In the table, a value of 0 indicates\nno activity and 1 indicates significant activity.</p></fn><fn id=\"t5fn2\"><label>b</label><p>Caco-2/Caco-2 permeability; HIA:\nhuman intestinal absorption; PPB: plasma protein binding; BBB: plasma\nprotein binding; VDss: volume distribution; CYP/CYP450 enzyme; CL:\nclearance; <italic toggle=\"yes\">T</italic>\n<sub>1/2</sub>: half-life; DLI: drug\ninduced liver injury. M1 and M2 are the molecules generated by MGDM-Sa\non the QM9 data set. M3 and M4 are the molecules generated by MGDM-Sa\non the GEOM-Drug data set.</p></fn></table-wrap-foot></table-wrap><fig position=\"float\" id=\"fig9\" fig-type=\"figure\" orientation=\"portrait\"><label>9</label><caption><p>Molecular docking\nstructure; yellow dashed lines indicate hydrogen\nbonds. (a) Shows the docking of the molecules generated by MGDM-Sa\non the QM9 data set with HPK1. (b) Shows the docking of the molecules\ngenerated by MGDM-Sa on the GEOM-Drug data set with LRRK2.</p></caption><graphic xmlns:xlink=\"http://www.w3.org/1999/xlink\" id=\"gr12\" position=\"float\" orientation=\"portrait\" xlink:href=\"ao5c10621_0009.jpg\"/></fig><p>Finally, to evaluate the ability of our model to\ngenerate\nbioactive\nmolecules, two popular targets, hematopoietic progenitor kinase 1\n(HPK1, PDB ID: <ext-link xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"7M0M\" ext-link-type=\"PDB\">7M0M</ext-link>) and leucine-rich repeat kinase 2 (LRRK2, PDB ID: <ext-link xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"8FO7\" ext-link-type=\"PDB\">8FO7</ext-link>), were used as examples\nto study the docking of the generated molecules with the targets.\nAs shown in <xref rid=\"fig9\" ref-type=\"fig\">Figure <xref rid=\"fig9\" ref-type=\"fig\"/>\n</xref>, the case study reveals that the molecules generated via MGDM-Sa\nare not only biologically active but also exhibit drug-like properties,\nstructural diversity, and novelty. This underscores the capability\nof our approach to generate high-quality candidates with desired characteristics,\nmaking it a valuable tool for de novo drug design.</p></sec></sec><sec id=\"sec8\"><label>8</label><title>Conclusion</title><p>In this article, we propose\na novel diffusion\nmodel MGDM-Sa for\n3D molecular generation tasks, which combines a biequivariant fractional\nneural network called <italic toggle=\"yes\">DualESNet</italic>. The <italic toggle=\"yes\">DualESNet</italic> models the bond lengths of different interatomic forces to capture\ncomplex interatomic interaction relationships and enhances the ability\nof the model to characterize atomic connectivity. In particular, in <italic toggle=\"yes\">DualESNet</italic>, we design a new equivariant encoder, <italic toggle=\"yes\">eEncoder</italic>, which integrates the EGNN and self-attention.\neEncoder effectively integrates global and local information to comprehensively\ncapture complex relationships and dependencies in the molecular graph,\nthereby enhancing the expression ability of the model.</p><p>We performed\nboth geometric molecule generation and conditional\nmolecule generation experiments. Experimental results show that MGDM-Sa\ncan generate effective and stable molecules. By comparing MGDM-Sa\nwith the baseline model, it is proven that MGDM-Sa has advantages\nin both geometric molecular generation performance and generation\nof molecules with expected properties.</p><p>We performed physicochemical\nand medicinal chemical property prediction,\nADMET prediction, and molecular docking on the molecules generated\nby MGDM-Sa. The results show that the molecules generated based on\nMGDM-Sa not only have good biological activities but also maintain\ngood drug-like properties. We demonstrate that MGDM-Sa is capable\nof generating effective candidates and will be a useful de novo drug\ndesign tool.</p></sec></body><back><ack id=\"ack1\"><p>This work was supported in part by\nthe National\nNatural Science Foundation of China under Grant 62362002.</p></ack><notes id=\"notes2\" notes-type=\"data-availability\"><p>The data sets\nand codes used in this study are available at GitHub: <uri xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"https://github.com/yha2333/MGDM.git\">https://github.com/yha2333/MGDM.git</uri>.</p></notes><notes id=\"notes1\" notes-type=\"conflict-of-interest\"><p>The authors\ndeclare no competing financial interest.</p></notes><ref-list><ref id=\"ref1\"><element-citation publication-type=\"journal\" id=\"cit1\"><name name-style=\"western\"><surname>Gaudelet</surname><given-names>T.</given-names></name><name name-style=\"western\"><surname>Day</surname><given-names>B.</given-names></name><name name-style=\"western\"><surname>Jamasb</surname><given-names>A. R.</given-names></name><name name-style=\"western\"><surname>Soman</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Regep</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Liu</surname><given-names>G.</given-names></name><name name-style=\"western\"><surname>Hayter</surname><given-names>J. B.</given-names></name><name name-style=\"western\"><surname>Vickers</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Roberts</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Tang</surname><given-names>J.</given-names></name><etal/><article-title>Utilizing graph machine learning within drug discovery and development</article-title><source>Briefings Bioinf.</source><year>2021</year><volume>22</volume><fpage>bbab159</fpage><pub-id pub-id-type=\"doi\">10.1093/bib/bbab159</pub-id><pub-id pub-id-type=\"pmcid\">PMC8574649</pub-id><pub-id pub-id-type=\"pmid\">34013350</pub-id></element-citation></ref><ref id=\"ref2\"><element-citation publication-type=\"journal\" id=\"cit2\"><name name-style=\"western\"><surname>Sidorova</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Anisimova</surname><given-names>M.</given-names></name><article-title>NLP-inspired\nstructural pattern recognition in chemical\napplication</article-title><source>Pattern Recognit. Lett.</source><year>2014</year><volume>45</volume><fpage>11</fpage><lpage>16</lpage><pub-id pub-id-type=\"doi\">10.1016/j.patrec.2014.02.012</pub-id></element-citation></ref><ref id=\"ref3\"><element-citation publication-type=\"journal\" id=\"cit3\"><name name-style=\"western\"><surname>Kotsias</surname><given-names>P.-C.</given-names></name><name name-style=\"western\"><surname>Ar&#250;s-Pous</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Chen</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Engkvist</surname><given-names>O.</given-names></name><name name-style=\"western\"><surname>Tyrchan</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Bjerrum</surname><given-names>E. J.</given-names></name><article-title>Direct\nsteering of de novo molecular generation with\ndescriptor conditional recurrent neural networks</article-title><source>Nat. Mach. Intell.</source><year>2020</year><volume>2</volume><fpage>254</fpage><lpage>265</lpage><pub-id pub-id-type=\"doi\">10.1038/s42256-020-0174-5</pub-id></element-citation></ref><ref id=\"ref4\"><element-citation publication-type=\"journal\" id=\"cit4\"><name name-style=\"western\"><surname>Ar&#250;s-Pous</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Johansson</surname><given-names>S. V.</given-names></name><name name-style=\"western\"><surname>Prykhodko</surname><given-names>O.</given-names></name><name name-style=\"western\"><surname>Bjerrum</surname><given-names>E. J.</given-names></name><name name-style=\"western\"><surname>Tyrchan</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Reymond</surname><given-names>J.-L.</given-names></name><name name-style=\"western\"><surname>Chen</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Engkvist</surname><given-names>O.</given-names></name><article-title>Randomized SMILES strings\nimprove the quality of molecular generative models</article-title><source>J. Cheminf.</source><year>2019</year><volume>11</volume><fpage>71</fpage><pub-id pub-id-type=\"doi\">10.1186/s13321-019-0393-0</pub-id><pub-id pub-id-type=\"pmcid\">PMC6873550</pub-id><pub-id pub-id-type=\"pmid\">33430971</pub-id></element-citation></ref><ref id=\"ref5\"><element-citation publication-type=\"journal\" id=\"cit5\"><name name-style=\"western\"><surname>De\nCao</surname><given-names>N.</given-names></name><name name-style=\"western\"><surname>Kipf</surname><given-names>T.</given-names></name><article-title>MolGAN: An implicit generative model for small molecular\ngraphs</article-title><source>arXiv</source><year>2018</year><fpage>arXiv:1805.11973</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1805.11973</pub-id></element-citation></ref><ref id=\"ref6\"><element-citation publication-type=\"journal\" id=\"cit6\"><name name-style=\"western\"><surname>Bagal</surname><given-names>V.</given-names></name><name name-style=\"western\"><surname>Aggarwal</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Vinod</surname><given-names>P.</given-names></name><name name-style=\"western\"><surname>Priyakumar</surname><given-names>U. D.</given-names></name><article-title>MolGPT:\nmolecular generation using a transformer-decoder model</article-title><source>J. Chem. Inf. Model.</source><year>2022</year><volume>62</volume><fpage>2064</fpage><lpage>2076</lpage><pub-id pub-id-type=\"doi\">10.1021/acs.jcim.1c00600</pub-id><pub-id pub-id-type=\"pmid\">34694798</pub-id></element-citation></ref><ref id=\"ref7\"><element-citation publication-type=\"journal\" id=\"cit7\"><name name-style=\"western\"><surname>Kipf</surname><given-names>T. N.</given-names></name><name name-style=\"western\"><surname>Welling</surname><given-names>M.</given-names></name><article-title>Variational\nGraph Auto-Encoders</article-title><source>arXiv</source><year>2016</year><fpage>arXiv:1611.07308</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1611.07308</pub-id></element-citation></ref><ref id=\"ref8\"><element-citation publication-type=\"journal\" id=\"cit8\"><name name-style=\"western\"><surname>Wang</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Song</surname><given-names>T.</given-names></name><name name-style=\"western\"><surname>Zhang</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Jiang</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Wei</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Li</surname><given-names>Z.</given-names></name><article-title>Molecular substructure\ntree generative model for de novo drug design</article-title><source>Briefings Bioinf.</source><year>2022</year><volume>23</volume><fpage>bbab592</fpage><pub-id pub-id-type=\"doi\">10.1093/bib/bbab592</pub-id><pub-id pub-id-type=\"pmid\">35039853</pub-id></element-citation></ref><ref id=\"ref9\"><element-citation publication-type=\"journal\" id=\"cit9\"><name name-style=\"western\"><surname>Cao</surname><given-names>N. D.</given-names></name><name name-style=\"western\"><surname>Kipf</surname><given-names>T.</given-names></name><article-title>MolGAN: An implicit\ngenerative model for small molecular graphs</article-title><source>arXiv</source><year>2022</year><fpage>arXiv:1805.11973</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1805.11973</pub-id></element-citation></ref><ref id=\"ref10\"><element-citation publication-type=\"journal\" id=\"cit10\"><name name-style=\"western\"><surname>Madhawa</surname><given-names>K.</given-names></name><name name-style=\"western\"><surname>Ishiguro</surname><given-names>K.</given-names></name><name name-style=\"western\"><surname>Nakago</surname><given-names>K.</given-names></name><name name-style=\"western\"><surname>Abe</surname><given-names>M.</given-names></name><article-title>GraphNVP:\nAn Invertible\nFlow Model for Generating Molecular Graphs</article-title><source>arXiv</source><year>2019</year><fpage>arXiv:1905.11600</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1905.11600</pub-id></element-citation></ref><ref id=\"ref11\"><element-citation publication-type=\"journal\" id=\"cit11\"><name name-style=\"western\"><surname>Yao</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Feng</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Zhong</surname><given-names>S.</given-names></name><article-title>Research progress of 3D molecular\ngenerative models based on deep learning</article-title><source>Sci.\nChina, Ser. B:Chem.</source><year>2023</year><volume>53</volume><fpage>174</fpage><lpage>195</lpage></element-citation></ref><ref id=\"ref12\"><element-citation publication-type=\"journal\" id=\"cit12\"><name name-style=\"western\"><surname>Bronstein</surname><given-names>M. M.</given-names></name><name name-style=\"western\"><surname>Bruna</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>LeCun</surname><given-names>Y.</given-names></name><name name-style=\"western\"><surname>Szlam</surname><given-names>A.</given-names></name><name name-style=\"western\"><surname>Vandergheynst</surname><given-names>P.</given-names></name><article-title>Geometric\nDeep Learning: Going beyond Euclidean data</article-title><source>IEEE Signal Process. Mag.</source><year>2017</year><volume>34</volume><fpage>18</fpage><lpage>42</lpage><pub-id pub-id-type=\"doi\">10.1109/MSP.2017.2693418</pub-id></element-citation></ref><ref id=\"ref13\"><element-citation publication-type=\"journal\" id=\"cit13\"><name name-style=\"western\"><surname>Gebauer</surname><given-names>N. W. A.</given-names></name><name name-style=\"western\"><surname>Gastegger</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Sch&#252;tt</surname><given-names>K.</given-names></name><article-title>Symmetry-adapted generation of 3d\npoint sets for the targeted discovery of molecules</article-title><source>arXiv</source><year>2019</year><volume>32</volume><fpage>arXiv:1906.00957</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1906.00957</pub-id></element-citation></ref><ref id=\"ref14\"><element-citation publication-type=\"journal\" id=\"cit14\"><name name-style=\"western\"><surname>Nesterov</surname><given-names>V.</given-names></name><name name-style=\"western\"><surname>Wieser</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Roth</surname><given-names>V.</given-names></name><article-title>3DMolNet:\na generative network for\nmolecular structures</article-title><source>arXiv</source><year>2020</year><fpage>arXiv:2010.06477</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2010.06477</pub-id></element-citation></ref><ref id=\"ref15\"><element-citation publication-type=\"journal\" id=\"cit15\"><name name-style=\"western\"><surname>Garcia\nSatorras</surname><given-names>V.</given-names></name><name name-style=\"western\"><surname>Hoogeboom</surname><given-names>E.</given-names></name><name name-style=\"western\"><surname>Fuchs</surname><given-names>F.</given-names></name><name name-style=\"western\"><surname>Posner</surname><given-names>I.</given-names></name><name name-style=\"western\"><surname>Welling</surname><given-names>M.</given-names></name><article-title>E&#173;(n) equivariant normalizing flows</article-title><source>Adv. Neural Inf. Process. Syst.</source><year>2021</year><volume>34</volume><fpage>4181</fpage><lpage>4192</lpage></element-citation></ref><ref id=\"ref16\"><mixed-citation publication-type=\"confproc\" id=\"cit16\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Luo</surname>, <given-names>Y.</given-names></string-name>; <string-name name-style=\"western\"><surname>Ji</surname>, <given-names>S.</given-names></string-name></person-group><article-title>An autoregressive\nflow model\nfor 3d molecular geometry generation from scratch</article-title>. <source>International Conference on Learning Representations (ICLR)</source>, <year>2022</year>.</mixed-citation></ref><ref id=\"ref17\"><mixed-citation publication-type=\"confproc\" id=\"cit17\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Simm</surname>, <given-names>G.</given-names></string-name>; <string-name name-style=\"western\"><surname>Pinsler</surname>, <given-names>R.</given-names></string-name>; <string-name name-style=\"western\"><surname>Hern&#225;ndez-Lobato</surname>, <given-names>J. M.</given-names></string-name></person-group><article-title>Reinforcement learning for molecular design guided by quantum mechanics</article-title>. <source>International Conference on Machine Learning</source>, <year>2020</year>; pp <fpage>8959</fpage>&#8211;<lpage>8969</lpage>.</mixed-citation></ref><ref id=\"ref18\"><element-citation publication-type=\"journal\" id=\"cit18\"><name name-style=\"western\"><surname>Zhou</surname><given-names>G.</given-names></name><name name-style=\"western\"><surname>Gao</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Ding</surname><given-names>Q.</given-names></name><name name-style=\"western\"><surname>Zheng</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Xu</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Wei</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Zhang</surname><given-names>L.</given-names></name><name name-style=\"western\"><surname>Ke</surname><given-names>G.</given-names></name><article-title>Uni-Mol: A Universal\n3D Molecular\nRepresentation Learning Framework</article-title><source>chemrxiv</source><year>2023</year><fpage>chemrxiv-2022-jjm0j</fpage><pub-id pub-id-type=\"doi\">10.26434/chemrxiv-2022-jjm0j</pub-id></element-citation></ref><ref id=\"ref19\"><element-citation publication-type=\"journal\" id=\"cit19\"><name name-style=\"western\"><surname>Huang</surname><given-names>Y.</given-names></name><name name-style=\"western\"><surname>Peng</surname><given-names>X.</given-names></name><name name-style=\"western\"><surname>Ma</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Zhang</surname><given-names>M.</given-names></name><article-title>3DLinker:\nan E (3)\nequivariant variational autoencoder for molecular linker design</article-title><source>arXiv</source><year>2022</year><fpage>arXiv:2205.07309</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2205.07309</pub-id></element-citation></ref><ref id=\"ref20\"><element-citation publication-type=\"journal\" id=\"cit20\"><name name-style=\"western\"><surname>Ganea</surname><given-names>O.-E.</given-names></name><name name-style=\"western\"><surname>Pattanaik</surname><given-names>L.</given-names></name><name name-style=\"western\"><surname>Coley</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Barzilay</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Jensen</surname><given-names>K.</given-names></name><name name-style=\"western\"><surname>Green</surname><given-names>W.</given-names></name><name name-style=\"western\"><surname>Jaakkola</surname><given-names>T.</given-names></name><article-title>Geomol: Torsional geometric generation\nof molecular 3d conformer ensembles</article-title><source>Adv. Neural\nInf. Process. Syst.</source><year>2021</year><volume>34</volume><fpage>13757</fpage><lpage>13769</lpage></element-citation></ref><ref id=\"ref21\"><mixed-citation publication-type=\"confproc\" id=\"cit21\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Xu</surname>, <given-names>M.</given-names></string-name>; <string-name name-style=\"western\"><surname>Wang</surname>, <given-names>W.</given-names></string-name>; <string-name name-style=\"western\"><surname>Luo</surname>, <given-names>S.</given-names></string-name>; <string-name name-style=\"western\"><surname>Shi</surname>, <given-names>C.</given-names></string-name>; <string-name name-style=\"western\"><surname>Bengio</surname>, <given-names>Y.</given-names></string-name>; <string-name name-style=\"western\"><surname>Gomez-Bombarelli</surname>, <given-names>R.</given-names></string-name>; <string-name name-style=\"western\"><surname>Tang</surname>, <given-names>J.</given-names></string-name></person-group><article-title>An end-to-end framework for molecular conformation\ngeneration via bilevel programming</article-title>. <source>International\nConference on Machine Learning</source>, <year>2021</year>; pp <fpage>11537</fpage>&#8211;<lpage>11547</lpage>.</mixed-citation></ref><ref id=\"ref22\"><element-citation publication-type=\"journal\" id=\"cit22\"><name name-style=\"western\"><surname>Sch&#252;tt</surname><given-names>K. T.</given-names></name><name name-style=\"western\"><surname>Kindermans</surname><given-names>P.-J.</given-names></name><name name-style=\"western\"><surname>Sauceda Felix</surname><given-names>H. E.</given-names></name><name name-style=\"western\"><surname>Chmiela</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Tkatchenko</surname><given-names>A.</given-names></name><name name-style=\"western\"><surname>M&#252;ller</surname><given-names>K.-R.</given-names></name><article-title>Schnet: A continuous-filter convolutional neural network\nfor modeling quantum interactions</article-title><source>Adv. Neural\nInf. Process. Syst.</source><year>2017</year><volume>30</volume><fpage>1</fpage></element-citation></ref><ref id=\"ref23\"><mixed-citation publication-type=\"journal\" id=\"cit23\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Huang</surname>, <given-names>L.</given-names></string-name>; <string-name name-style=\"western\"><surname>Zhang</surname>, <given-names>H.</given-names></string-name>; <string-name name-style=\"western\"><surname>Xu</surname>, <given-names>T.</given-names></string-name>; <string-name name-style=\"western\"><surname>Wong</surname>, <given-names>K.-C.</given-names></string-name></person-group><article-title>MDM: Molecular Diffusion Model for\n3D Molecule Generation</article-title>. <source>Proceedings of the\nAAAI Conference on Artificial Intelligence</source>, <year>2023</year>; Vol. <volume>37</volume>, pp <fpage>5105</fpage>&#8211;<lpage>5112</lpage>.</mixed-citation></ref><ref id=\"ref24\"><element-citation publication-type=\"journal\" id=\"cit24\"><name name-style=\"western\"><surname>Xu</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Liu</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Yao</surname><given-names>Y.</given-names></name><name name-style=\"western\"><surname>Huang</surname><given-names>W.</given-names></name><name name-style=\"western\"><surname>Li</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Luo</surname><given-names>H.-B.</given-names></name><article-title>3D-EDiffMG:\n3D equivariant diffusion-driven molecular generation to accelerate\ndrug discovery</article-title><source>J. Pharm. Anal.</source><year>2025</year><volume>15</volume><fpage>101257</fpage><pub-id pub-id-type=\"doi\">10.1016/j.jpha.2025.101257</pub-id><pub-id pub-id-type=\"pmid\">40678485</pub-id><pub-id pub-id-type=\"pmcid\">PMC12268068</pub-id></element-citation></ref><ref id=\"ref25\"><mixed-citation publication-type=\"confproc\" id=\"cit25\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Satorras</surname>, <given-names>V. G.</given-names></string-name>; <string-name name-style=\"western\"><surname>Hoogeboom</surname>, <given-names>E.</given-names></string-name>; <string-name name-style=\"western\"><surname>Welling</surname>, <given-names>M. E.</given-names></string-name></person-group><article-title>(n) equivariant\ngraph neural networks</article-title>. <source>International Conference\non Machine Learning</source>, <year>2021</year>; pp <fpage>9323</fpage>&#8211;<lpage>9332</lpage>.</mixed-citation></ref><ref id=\"ref26\"><mixed-citation publication-type=\"journal\" id=\"cit26\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Xu</surname>, <given-names>C.</given-names></string-name>; <string-name name-style=\"western\"><surname>Wang</surname>, <given-names>H.</given-names></string-name>; <string-name name-style=\"western\"><surname>Wang</surname>, <given-names>W.</given-names></string-name>; <string-name name-style=\"western\"><surname>Zheng</surname>, <given-names>P.</given-names></string-name>; <string-name name-style=\"western\"><surname>Chen</surname>, <given-names>H.</given-names></string-name></person-group><article-title>Geometric-facilitated denoising diffusion model for\n3D molecule generation</article-title>. <source>Proceedings of the\nAAAI Conference on Artificial Intelligence</source>, <year>2024</year>; Vol. <volume>38</volume>, pp <fpage>338</fpage>&#8211;<lpage>346</lpage>.</mixed-citation></ref><ref id=\"ref27\"><mixed-citation publication-type=\"confproc\" id=\"cit27\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Hoogeboom</surname>, <given-names>E.</given-names></string-name>; <string-name name-style=\"western\"><surname>Satorras</surname>, <given-names>V. G.</given-names></string-name>; <string-name name-style=\"western\"><surname>Vignac</surname>, <given-names>C.</given-names></string-name>; <string-name name-style=\"western\"><surname>Welling</surname>, <given-names>M.</given-names></string-name></person-group><article-title>Equivariant diffusion\nfor molecule generation in 3d</article-title>. <source>International\nConference on Machine Learning</source>, <year>2022</year>; pp <fpage>8867</fpage>&#8211;<lpage>8887</lpage>.</mixed-citation></ref><ref id=\"ref28\"><element-citation publication-type=\"journal\" id=\"cit28\"><name name-style=\"western\"><surname>Bao</surname><given-names>F.</given-names></name><name name-style=\"western\"><surname>Zhao</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Hao</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Li</surname><given-names>P.</given-names></name><name name-style=\"western\"><surname>Li</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Zhu</surname><given-names>J.</given-names></name><article-title>Equivariant energy-guided sde for inverse molecular design</article-title><source>arXiv</source><year>2022</year><fpage>arXiv:2209.15408</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2209.15408</pub-id></element-citation></ref><ref id=\"ref29\"><mixed-citation publication-type=\"confproc\" id=\"cit29\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Jo</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Lee</surname>, <given-names>S.</given-names></string-name>; <string-name name-style=\"western\"><surname>Hwang</surname>, <given-names>S. J.</given-names></string-name></person-group><article-title>Score-based\ngenerative modeling\nof graphs via the system of stochastic differential equations</article-title>. <source>International Conference on Machine Learning</source>, <year>2022</year>; pp <fpage>10362</fpage>&#8211;<lpage>10383</lpage>.</mixed-citation></ref><ref id=\"ref30\"><element-citation publication-type=\"journal\" id=\"cit30\"><name name-style=\"western\"><surname>Peng</surname><given-names>X.</given-names></name><name name-style=\"western\"><surname>Guan</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Liu</surname><given-names>Q.</given-names></name><name name-style=\"western\"><surname>Ma</surname><given-names>J.</given-names></name><article-title>Moldiff: Addressing\nthe atom-bond inconsistency problem in 3d molecule diffusion generation</article-title><source>arXiv</source><year>2023</year><fpage>arXiv:2305.07508</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2305.07508</pub-id></element-citation></ref><ref id=\"ref31\"><mixed-citation publication-type=\"confproc\" id=\"cit31\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Qiang</surname>, <given-names>B.</given-names></string-name>; <string-name name-style=\"western\"><surname>Song</surname>, <given-names>Y.</given-names></string-name>; <string-name name-style=\"western\"><surname>Xu</surname>, <given-names>M.</given-names></string-name>; <string-name name-style=\"western\"><surname>Gong</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Gao</surname>, <given-names>B.</given-names></string-name>; <string-name name-style=\"western\"><surname>Zhou</surname>, <given-names>H.</given-names></string-name>; <string-name name-style=\"western\"><surname>Ma</surname>, <given-names>W.-Y.</given-names></string-name>; <string-name name-style=\"western\"><surname>Lan</surname>, <given-names>Y.</given-names></string-name></person-group><article-title>Coarse-to-fine:\na hierarchical diffusion model for molecule generation in 3d</article-title>. <source>International Conference on Machine Learning</source>, <year>2023</year>; pp <fpage>28277</fpage>&#8211;<lpage>28299</lpage>.</mixed-citation></ref><ref id=\"ref32\"><mixed-citation publication-type=\"confproc\" id=\"cit32\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Xu</surname>, <given-names>M.</given-names></string-name>; <string-name name-style=\"western\"><surname>Powers</surname>, <given-names>A. S.</given-names></string-name>; <string-name name-style=\"western\"><surname>Dror</surname>, <given-names>R. O.</given-names></string-name>; <string-name name-style=\"western\"><surname>Ermon</surname>, <given-names>S.</given-names></string-name>; <string-name name-style=\"western\"><surname>Leskovec</surname>, <given-names>J.</given-names></string-name></person-group><article-title>Geometric\nlatent\ndiffusion models for 3d molecule generation</article-title>. <source>International Conference on Machine Learning</source>, <year>2023</year>; pp <fpage>38592</fpage>&#8211;<lpage>38610</lpage>.</mixed-citation></ref><ref id=\"ref33\"><element-citation publication-type=\"journal\" id=\"cit33\"><name name-style=\"western\"><surname>Ramakrishnan</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Dral</surname><given-names>P. O.</given-names></name><name name-style=\"western\"><surname>Rupp</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Von Lilienfeld</surname><given-names>O. A.</given-names></name><article-title>Quantum\nchemistry structures and properties of 134 kilo molecules</article-title><source>Sci. Data</source><year>2014</year><volume>1</volume><fpage>140022</fpage><pub-id pub-id-type=\"doi\">10.1038/sdata.2014.22</pub-id><pub-id pub-id-type=\"pmid\">25977779</pub-id><pub-id pub-id-type=\"pmcid\">PMC4322582</pub-id></element-citation></ref><ref id=\"ref34\"><element-citation publication-type=\"journal\" id=\"cit34\"><name name-style=\"western\"><surname>Axelrod</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Gomez-Bombarelli</surname><given-names>R. G. E. O. M.</given-names></name><article-title>GEOM, energy-annotated molecular\nconformations for property prediction and molecular generation</article-title><source>Sci. Data</source><year>2022</year><volume>9</volume><fpage>185</fpage><pub-id pub-id-type=\"doi\">10.1038/s41597-022-01288-4</pub-id><pub-id pub-id-type=\"pmid\">35449137</pub-id><pub-id pub-id-type=\"pmcid\">PMC9023519</pub-id></element-citation></ref><ref id=\"ref35\"><element-citation publication-type=\"journal\" id=\"cit35\"><name name-style=\"western\"><surname>Unke</surname><given-names>O. T.</given-names></name><name name-style=\"western\"><surname>Meuwly</surname><given-names>M.</given-names></name><article-title>PhysNet: A neural network\nfor predicting energies,\nforces, dipole moments, and partial charges</article-title><source>J. Chem. Theory Comput.</source><year>2019</year><volume>15</volume><fpage>3678</fpage><lpage>3693</lpage><pub-id pub-id-type=\"doi\">10.1021/acs.jctc.9b00181</pub-id><pub-id pub-id-type=\"pmid\">31042390</pub-id></element-citation></ref><ref id=\"ref36\"><element-citation publication-type=\"journal\" id=\"cit36\"><name name-style=\"western\"><surname>Gasteiger</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Gro&#223;</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>G&#252;nnemann</surname><given-names>S.</given-names></name><article-title>Directional message passing for molecular\ngraphs</article-title><source>arXiv</source><year>2020</year><fpage>arXiv:2003.03123</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2003.03123</pub-id></element-citation></ref><ref id=\"ref37\"><element-citation publication-type=\"journal\" id=\"cit37\"><name name-style=\"western\"><surname>Fuchs</surname><given-names>F. B.</given-names></name><name name-style=\"western\"><surname>Worrall</surname><given-names>D.</given-names></name><name name-style=\"western\"><surname>Fischer</surname><given-names>V.</given-names></name><name name-style=\"western\"><surname>Welling</surname><given-names>M.</given-names></name><article-title>Se (3)-transformers:\n3d roto-translation equivariant attention networks</article-title><source>Adv. Neural Inf. Process. Syst.</source><year>2020</year><volume>33</volume><fpage>1970</fpage><lpage>1981</lpage></element-citation></ref><ref id=\"ref38\"><mixed-citation publication-type=\"book\" id=\"cit38\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Ho</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Jain</surname>, <given-names>A.</given-names></string-name>; <string-name name-style=\"western\"><surname>Abbeel</surname>, <given-names>P.</given-names></string-name></person-group><article-title>Denoising diffusion\nprobabilistic\nmodels</article-title>. <source>Proceedings of the 34th International\nConference on Neural Information Processing Systems</source>: <publisher-loc>Red Hook, NY, USA</publisher-loc>, <year>2020</year>.</mixed-citation></ref><ref id=\"ref39\"><mixed-citation publication-type=\"confproc\" id=\"cit39\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Nichol</surname>, <given-names>A. Q.</given-names></string-name>; <string-name name-style=\"western\"><surname>Dhariwal</surname>, <given-names>P.</given-names></string-name></person-group><article-title>Improved denoising\ndiffusion probabilistic models</article-title>. <source>International\nConference on Machine Learning</source>, <year>2021</year>; pp <fpage>8162</fpage>&#8211;<lpage>8171</lpage>.</mixed-citation></ref><ref id=\"ref40\"><mixed-citation publication-type=\"confproc\" id=\"cit40\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Sohl-Dickstein</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Weiss</surname>, <given-names>E.</given-names></string-name>; <string-name name-style=\"western\"><surname>Maheswaranathan</surname>, <given-names>N.</given-names></string-name>; <string-name name-style=\"western\"><surname>Ganguli</surname>, <given-names>S.</given-names></string-name></person-group><article-title>Deep unsupervised\nlearning using nonequilibrium thermodynamics</article-title>. <source>International Conference on Machine Learning</source>, <year>2015</year>; pp <fpage>2256</fpage>&#8211;<lpage>2265</lpage>.</mixed-citation></ref><ref id=\"ref41\"><mixed-citation publication-type=\"confproc\" id=\"cit41\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Liu</surname>, <given-names>Q.</given-names></string-name>; <string-name name-style=\"western\"><surname>Lee</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Jordan</surname>, <given-names>M.</given-names></string-name></person-group><article-title>A kernelized Stein discrepancy\nfor goodness-of-fit tests</article-title>. <source>International Conference\non Machine Learning</source>, <year>2016</year>; pp <fpage>276</fpage>&#8211;<lpage>284</lpage>.</mixed-citation></ref><ref id=\"ref42\"><mixed-citation publication-type=\"confproc\" id=\"cit42\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>K&#246;hler</surname>, <given-names>J.</given-names></string-name>; <string-name name-style=\"western\"><surname>Klein</surname>, <given-names>L.</given-names></string-name>; <string-name name-style=\"western\"><surname>No&#233;</surname>, <given-names>F.</given-names></string-name></person-group><article-title>Equivariant flows:\nexact likelihood generative learning for symmetric densities</article-title>. <source>International Conference on Machine Learning</source>, <year>2020</year>; pp <fpage>5361</fpage>&#8211;<lpage>5370</lpage>.</mixed-citation></ref><ref id=\"ref43\"><element-citation publication-type=\"journal\" id=\"cit43\"><name name-style=\"western\"><surname>Xu</surname><given-names>M.</given-names></name><name name-style=\"western\"><surname>Yu</surname><given-names>L.</given-names></name><name name-style=\"western\"><surname>Song</surname><given-names>Y.</given-names></name><name name-style=\"western\"><surname>Shi</surname><given-names>C.</given-names></name><name name-style=\"western\"><surname>Ermon</surname><given-names>S.</given-names></name><name name-style=\"western\"><surname>Tang</surname><given-names>J. G.</given-names></name><article-title>A geometric\ndiffusion model for molecular conformation generation</article-title><source>arXiv</source><year>2022</year><fpage>arXiv:2203.02923</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2203.02923</pub-id></element-citation></ref><ref id=\"ref44\"><mixed-citation publication-type=\"confproc\" id=\"cit44\"><person-group person-group-type=\"allauthors\"><string-name name-style=\"western\"><surname>Shi</surname>, <given-names>C.</given-names></string-name>; <string-name name-style=\"western\"><surname>Luo</surname>, <given-names>S.</given-names></string-name>; <string-name name-style=\"western\"><surname>Xu</surname>, <given-names>M.</given-names></string-name>; <string-name name-style=\"western\"><surname>Tang</surname>, <given-names>J.</given-names></string-name></person-group><article-title>Learning gradient fields for\nmolecular conformation\ngeneration</article-title>. <source>International Conference on Machine\nLearning</source>, <year>2021</year>; pp <fpage>9558</fpage>&#8211;<lpage>9568</lpage>.</mixed-citation></ref><ref id=\"ref45\"><element-citation publication-type=\"journal\" id=\"cit45\"><name name-style=\"western\"><surname>Vaswani</surname><given-names>A.</given-names></name><article-title>Attention\nis all you need</article-title><source>arXiv</source><year>2017</year><fpage>arXiv:1706.03762</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.1706.03762</pub-id></element-citation></ref><ref id=\"ref46\"><element-citation publication-type=\"journal\" id=\"cit46\"><name name-style=\"western\"><surname>Jensen</surname><given-names>J. L. W. V.</given-names></name><article-title>Sur\nles fonctions convexes et les in&#233;galit&#233;s entre les valeurs\nmoyennes</article-title><source>Acta Math.</source><year>1906</year><volume>30</volume><fpage>175</fpage><lpage>193</lpage><pub-id pub-id-type=\"doi\">10.1007/BF02418571</pub-id></element-citation></ref><ref id=\"ref47\"><element-citation publication-type=\"journal\" id=\"cit47\"><name name-style=\"western\"><surname>Vincent</surname><given-names>P.</given-names></name><article-title>A connection\nbetween score matching and denoising autoencoders</article-title><source>Neural Comput.</source><year>2011</year><volume>23</volume><fpage>1661</fpage><lpage>1674</lpage><pub-id pub-id-type=\"doi\">10.1162/NECO_a_00142</pub-id><pub-id pub-id-type=\"pmid\">21492012</pub-id></element-citation></ref><ref id=\"ref48\"><element-citation publication-type=\"journal\" id=\"cit48\"><name name-style=\"western\"><surname>Huang</surname><given-names>L.</given-names></name><name name-style=\"western\"><surname>Xu</surname><given-names>T.</given-names></name><name name-style=\"western\"><surname>Yu</surname><given-names>Y.</given-names></name><name name-style=\"western\"><surname>Zhao</surname><given-names>P.</given-names></name><name name-style=\"western\"><surname>Chen</surname><given-names>X.</given-names></name><name name-style=\"western\"><surname>Han</surname><given-names>J.</given-names></name><name name-style=\"western\"><surname>Xie</surname><given-names>Z.</given-names></name><name name-style=\"western\"><surname>Li</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Zhong</surname><given-names>W.</given-names></name><name name-style=\"western\"><surname>Wong</surname><given-names>K.-C.</given-names></name><etal/><article-title>A dual\ndiffusion model enables 3D molecule generation and lead optimization\nbased on target pockets</article-title><source>Nat. Commun.</source><year>2024</year><volume>15</volume><fpage>2657</fpage><pub-id pub-id-type=\"doi\">10.1038/s41467-024-46569-1</pub-id><pub-id pub-id-type=\"pmid\">38531837</pub-id><pub-id pub-id-type=\"pmcid\">PMC10965937</pub-id></element-citation></ref><ref id=\"ref49\"><element-citation publication-type=\"journal\" id=\"cit49\"><name name-style=\"western\"><surname>Huang</surname><given-names>H.</given-names></name><name name-style=\"western\"><surname>Sun</surname><given-names>L.</given-names></name><name name-style=\"western\"><surname>Du</surname><given-names>B.</given-names></name><name name-style=\"western\"><surname>Lv</surname><given-names>W.</given-names></name><article-title>Learning Joint\n2-D and 3-D Graph\nDiffusion Models for Complete Molecule Generation</article-title><source>IEEE Transact. Neural Networks Learn. Syst.</source><year>2024</year><volume>35</volume><fpage>11857</fpage><lpage>11871</lpage><pub-id pub-id-type=\"doi\">10.1109/TNNLS.2024.3416328</pub-id><pub-id pub-id-type=\"pmid\">38976472</pub-id></element-citation></ref><ref id=\"ref50\"><element-citation publication-type=\"journal\" id=\"cit50\"><name name-style=\"western\"><surname>Irwin</surname><given-names>R.</given-names></name><name name-style=\"western\"><surname>Tibo</surname><given-names>A.</given-names></name><name name-style=\"western\"><surname>Janet</surname><given-names>J. P.</given-names></name><name name-style=\"western\"><surname>Olsson</surname><given-names>S.</given-names></name><article-title>SemlaFlow&#8211;Efficient\n3D Molecular Generation with Latent Attention and Equivariant Flow\nMatching</article-title><source>arXiv</source><year>2024</year><fpage>arXiv:2406.07266</fpage><pub-id pub-id-type=\"doi\">10.48550/arXiv.2406.07266</pub-id></element-citation></ref><ref id=\"ref51\"><element-citation publication-type=\"journal\" id=\"cit51\"><name name-style=\"western\"><surname>Lipinski</surname><given-names>C. A.</given-names></name><name name-style=\"western\"><surname>Lombardo</surname><given-names>F.</given-names></name><name name-style=\"western\"><surname>Dominy</surname><given-names>B. W.</given-names></name><name name-style=\"western\"><surname>Feeney</surname><given-names>P. J.</given-names></name><article-title>Experimental and\ncomputational approaches to estimate solubility and permeability in\ndrug discovery and development settings</article-title><source>Adv.\nDrug Delivery Rev.</source><year>1997</year><volume>23</volume><fpage>3</fpage><lpage>25</lpage><pub-id pub-id-type=\"doi\">10.1016/S0169-409X(96)00423-1</pub-id><pub-id pub-id-type=\"pmid\">11259830</pub-id></element-citation></ref></ref-list></back></article></pmc-articleset>",
  "text": "pmc ACS Omega ACS Omega 3686 acsomega ao ACS Omega 2470-1343 American Chemical Society http://pubs.acs.org/journal/acsodf PMC12676313 PMC12676313.1 12676313 12676313 41358140 10.1021/acsomega.5c10621 1 Article 3D Molecule Generation via Diffusion Model with a Self-Attention-Based EGNN 7752631 https://orcid.org/0009-0006-9276-0251 Yang Huanai 7754897 https://orcid.org/0009-0008-8530-4973 Zhong Qi 7752339 https://orcid.org/0000-0003-0792-7792 Wang Min 7755006 https://orcid.org/0009-0005-5162-1362 Peng Jianrong 7754900 https://orcid.org/0000-0003-0527-2251 Shen Dingcai &#8224; School of Mathematics and Computer Science , 12450 Gannan Normal University , Ganzhou 341000 , China &#8225; School of Intelligent Manufacturing and Future Energy , Gannan Normal University , Ganzhou 341000 , China &#167; Key Laboratory of Data Science and Artificial Intelligence of Jiangxi Education Institutes , Gannan Normal University , Ganzhou 341000 , China * Email: zhongqi@gnnu.edu.cn . * Email: wangmin@gnnu.edu.cn . 17 11 2025 02 12 2025 10 47 501830 57813 57829 11 10 2025 04 11 2025 03 11 2025 17 11 2025 17 11 2025 05 12 2025 08 12 2025 &#169; 2025 The Authors. Published by American Chemical Society 2025 The Authors https://creativecommons.org/licenses/by-nc-nd/4.0/ This article is licensed under CC-BY-NC-ND 4.0 The discovery of new drugs is of great significance to human health. The diffusion model has emerged as a powerful tool for generating 3D molecular structures, achieving significant success in various applications. However, existing models lack direct interatomic confinement features and are difficult to capture long-range dependencies in macromolecules. These issues lead to the generation of molecular structures that are either inaccurate or lack rationality. To address the above issues, this paper proposes a novel 3D Molecule Generation via Diffusion Model with a self-attention-based E&#173;( n ) equivariant graph neural network (EGNN) named MGDM-Sa, which incorporates a dual equivariant score neural network DualESNet , to capture the global graph features and the local atomic environment. Especially, in DualESNet , we design a novel equivariant encoder eEncoder , which integrates EGNN and self-attention. During message propagation, EGNN ensures the equivariation of geometric features, and self-attention layer captures the long-range dependencies in the molecular graph. Thus, this design enhances the representation capability of MGDM-Sa. The experimental results demonstrate that MGDM-Sa is capable of generating valid, unique, novel, stable, and diverse drug-like molecules, thereby underscoring its potential to accelerate the drug discovery process. National Natural Science Foundation of China 10.13039/501100001809 62362002 pmc-status-qastatus 0 pmc-status-live yes pmc-status-embargo no pmc-status-released yes pmc-prop-open-access yes pmc-prop-olf no pmc-prop-manuscript no pmc-prop-legally-suppressed no pmc-prop-has-pdf yes pmc-prop-has-supplement no pmc-prop-pdf-only no pmc-prop-suppress-copyright no pmc-prop-is-real-version no pmc-prop-is-scanned-article no pmc-prop-preprint no pmc-prop-in-epmc yes document-id-old-9 ao5c10621 document-id-new-14 ao5c10621 production-flag-MathML-config-version 3 production-flag-journal-citation-display-style acs-titles production-flag-journal-date-display-style dates-used-rcd-rvd-acc document-id-alt-64 f0c9d65d7703b5f2e38e22dc502ab95ac9c8bccc28bc3d86efad92cc2af904a2 1 Introduction Innovative drugs represent a critical approach to addressing human diseases. However, the cost associated with designing new drugs is prohibitively high. On average, developing a new drug from discovery to preclinical testing, clinical trials, approval, and marketing takes approximately 10 years and incurs an expense of US $2.6 billion, with a return on investment of less than 2%. With the rapid development of deep learning, various deep generative models have shown great potential in generating stable and diverse molecules with desired properties and have achieved great success in the de novo generation of drug-like molecules with desired properties. In recent years, deep-learning-based molecular generation methods have mainly focused on three categories: SMILES-based methods, two-dimensional molecular graph representation methods, and three-dimensional (3D) molecular graph representation methods. SMILES is a representation method that converts molecules into ASCII strings based on predefined atomic rules. Due to the sequential nature of SMILES representation, natural language processing algorithms can be effectively applied to molecular generation tasks. Therefore, researchers have adopted deep learning models, including recurrent neural networks (RNN), long short-term memory networks (LSTM), generative adversarial networks (GAN), and generative pretraining (GPT), to generate molecules based on SMILES representation. In molecular graphs, atoms are represented as nodes and chemical bonds are represented as edges. The types of atoms and chemical bonds correspond to the labels of the nodes and edges, respectively. Representative methods for generating molecules based on molecular graphs using deep generative models include VGAE, JTVAE, MolGAN, and GraphNVP. However, neither molecular graphs nor SMILES take into account the spatial conformation of compound molecules. 3D molecular conformation determines the biological, chemical, and physical properties of the molecule, such as charge distribution, potential energy, molecular docking, pharmacophore search, etc. In 3D molecular generation, capturing the 3D spatial structure features is crucial. In recent years, with the rapid development of geometric deep learning in processing geometric data, deep generative models for 3D molecular conformations have gradually become a research hotspot, for instance, G-SchNet, 3DMolNet, ENF, G-SphereNet, MolGym, Uni-Mol, 3DLinker, GeoMol, ConfVAE, etc. It is evident that 3D molecular structure design leveraging deep learning has experienced rapid development and achieved remarkable success. By combining deep learning with statistical physics, diffusion models can efficiently generate molecules with complex 3D structures and can be applied to novel drug design tasks. To address the challenge of maintaining equivariance in the 3D space, two strategies are primarily adopted. One is to leverage the equivariance of spatial geometric structures, with representative works including MDM and 3D-EDiffMG. The other is to utilize the E(3) equivariance of intermediate geometric elements, with representative works including GFMDiff, EDM, EEGSDE, DiffBridges, MolDiff, Hier-Diff, and GEOLDM. However, the existing diffusion models for 3D molecular generation lack direct interatomic constraint features, making it difficult to capture long-range dependencies in molecules. This results in suboptimal generated structures, thereby limiting the stability and diversity of the generated molecules. To address the above problems, we propose a 3D Molecule Generation via Diffusion Model with a self-attention-based EGNN, named MGDM-Sa, for molecule generation. In MGDM-Sa, the diffusion process is defined as a Markov chain, wherein Gaussian noise is systematically introduced to the data across a sequence of T steps. To process the global graph-level features and the local atomic environment, the reverse process is to estimate the added noise by a dual equivariant score neural network, named DualESNet . Specifically, DualESNet is composed of three components: edge construction, two equivariant encoders named eEncoder , and two scoring blocks. The edge constructor constructs a long-distance encoder and a short-distance encoder to deal with different interatomic forces, respectively. eEncoder is designed as an equivariant encoder implemented by an improved EGNN combined with a self-attention decoder. eEncoder not only acquires node features and atomic coordinates through the message-passing mechanism but also overcomes the problem of remote information loss in the native EGNN. Scoring blocks aim to estimate the gradient of the log density of atomic features and map it into a score vector. The experiments are conducted on two molecular data sets: QM9 and GEOM-Drug. The experimental results demonstrate that MGDM-Sa outperforms the baseline model in terms of performance. The main contributions of our work are as follows: For 3D molecular generation, we propose a novel diffusion model named MGDM-Sa, which incorporates a novel dual equivariant score neural network named DualESNet , to capture global and local information on molecular graphs and satisfy the E(3) equivariant property. It can generate effective and stable 3D structural molecules. We design an equivariant encoder named eEncoder , which utilizes EGNN to ensure the equivariance of geometric features and employs self-attention layer to capture long-range dependencies within molecular graphs. The experimental results show that MGDM-Sa can generate geometric molecules and molecules with expected properties. Moreover, its performance is superior to that of the baseline models. Additionally, we have demonstrated that the molecules generated by MGDM-Sa have the potential to be candidate drugs. The rest of this article is organized as follows. Section provides background information and discusses related work. Section presents the diffusion model basis of our proposed model MGDM-Sa. Section presents the detailed design of our proposed model MGDM-Sa. The experimental results and the analyses of molecules generated by MGDM-Sa are included in Sections and 6 , respectively. Finally, Section concludes this article with some discussions. 2 Related Work Generative models based on 1D strings or 2D molecular graphs have been well established. However, these generative models fail to account for the spatial conformations of compound molecules. 3D molecular conformations encompass geometric information such as position as well as important physical principles such as symmetry. In comparison with 1D string and 2D molecular graph representations, 3D geometric representations substantially broaden the molecular space to be explored while simultaneously increasing the complexity of the task. The primary challenge lies in ensuring that the model exhibits equivariance under rotation and translation operations in the 3D space. Currently, research on molecular geometric representation primarily investigates isotropy through two strategies: E(3)-Invariant and E(3)-Equivariant. Next, we delve into the methodologies for generating 3D molecules under diffusion model frameworks with these two strategies. 2.1 E&#173;(3)-Invariant One approach is to leverage E(3)-invariant 3D information by utilizing intermediate geometric elements, such as interatomic distances and angular data. Notable works in this domain include SchNet, PhysNet, and DimNet. MDM employs SchNet for generating 3D molecular structures while enhancing the interatomic connections that are insufficiently represented in the 3D point cloud representation of molecules. MDM introduces separate equivariant encoders to capture interatomic forces of varying strengths. Additionally, MDM incorporates a distribution control variable at each diffusion-inversion step to enhance the molecular diversity. Inspired by MDM, 3D-EDiffMG introduces long-range dependence capture equivariant encoders to encode bonding and nonbonding information based on strong and weak atomic interactions. Furthermore, 3D-EDiffMG integrates a gated multilayer perceptron module with minimal attention mechanisms to explicitly model complex long-sequence-feature interactions and long-range dependencies. As a result, 3D-EDiffMG is capable of generating valid, stable, novel, unique, and diverse drug-like molecules. Although our proposed method is grounded in the MDM framework, it outperforms existing methods by leveraging an equivariant strategy for constructing the diffusion model, thereby achieving superior performance. 2.2 E&#173;(3)-Equivariant The other is the equivariant strategy, whose representative works include SE(3)-Transformers, EGNN, etc. EGNN ensures the equivariance of geometric features in the process of message propagation when dealing with graph structure data. Therefore, EGNN often plays a key role in molecular generation tasks. So far, there are many excellent frameworks that combine SE(3)-Transformers or EGNN for molecular generation tasks. For instance, GFMDiff is a generative diffusion model for molecules based on SE(3)-Transformers. GFMDiff learns the 3D geometry of molecules by acquiring features from atom features, pairwise distance features, and three-way angle features and predicts atom types, valences, and coordinates. In addition, the GFMDiff model introduces GFLoss, which minimizes the difference between the valence predicted by the dualTrack transformer network (DTN) and the valence calculated from molecular geometry. DTN combined with geometrically facilitated loss achieves good molecular and atomic stability of the generated molecules. Currently, many diffusion model methods have achieved 3D molecule generation tasks by adopting an EGNN. EDM is the first diffusion model that uses EGNN to generate 3D molecules. However, EDM is incapable of learning the valence of different atom types and the constraint relationships between neighboring atoms, which govern bond formation and distribution. Consequently, the issue of inconsistent atom types and bonds arises, resulting in molecular instability. Since then, a variety of models based on EGNN have been proposed with the aim of enhancing the performance of EDM. For instance, EEGSDE uses the stochastic differential equations framework for capturing the dependencies between two variables and generating molecules with the desired properties. DiffBridges introduced an energy function into the diffusion bridge along with molecular geometry statistics calculated from the data. However, the problem of atom types and bond inconsistencies that cause molecular instability remains. MolDiff implements a two-stage diffusion model in order to solve the problem of inconsistent atom types and bonds. HierDiff and GEOLDM avoid the atomic bond inconsistency problem by using EGNN to embed structures into smaller domains. The aforementioned method directly employs EGNN. In light of the critical importance of capturing long-range dependencies, our proposed MGDM-Sa enhances EGNN by incorporating the Transformer encoder into the EGNN layer, which consequently leads to a further improvement in model performance. 3 Preliminary In this section, we present the diffusion model basis of the method proposed in this paper. MGDM-Sa leverages DDPM to perturb the data through a sequence of progressively increasing Gaussian noise levels and simultaneously estimates the score function for all noisy data distributions by training a deep neural network model conditioned on the noise magnitude. The DDPM is formulated as two Markov chains: the diffusion process and the reverse process. 3.1 Diffusion Process Let M = ( A , R ) represents 3D molecular geometry. Here, the A &#8712; {0,1} n &#215; f represents the atomic features matrix, including atomic types and atomic charges. R &#8712; R n &#215; 3 represents the atomic coordinates. Given an initial molecular geometry M 0 &#8764; q ( M 0 ) , we define a fixed Markov chain over discrete time steps t &#8712; {1, ..., T }. The forward process gradually perturbs the molecular conformation through Gaussian transitions controlled by a cosine variance schedule (&#946; 1 , ..., &#946; T ), &#946; t &#8712; (0, 1). 1 q ( M t | M t &#8722; 1 ) = N ( M t ; 1 &#8722; &#946; t M t &#8722; 1 , &#946; t I ) where N indicates that M t follows a normal distribution with a mean of 1 &#8722; &#946; t M t &#8722; 1 and a variance of &#946; t I . In the subsequent eqs and , N also represents a normal distribution. The joint distribution conditioned on M 0 satisfies the Markov property 2 q ( M 1 : T | M 0 ) = &#8719; t = 1 T q ( M t | M t &#8722; 1 ) Following ref , for all t &#8712; {0, 1, ..., T }, this Gaussian transition kernel allows us to marginalize the joint distribution in eq to obtain an analytical form for q ( M t | M 0 ) . For &#945; t : = 1 &#8211; &#946; t and &#945;&#773; t : = &#8719; s = 1 t &#945; s , at any time step, the data can be transformed by a reparameterization trick as follows: 3 q ( M t | M 0 ) = N ( M t ; &#945;&#773; t M 0 , ( 1 &#8722; &#945;&#773; t ) I ) If t &#8594; &#8734;, then &#945;&#773; t &#8594; 0 , ( 1 &#8722; &#945;&#773; t ) &#8594; 1 . So as the step size t gradually increases, the final distribution will be closer to the standard Gaussian distribution. 3.2 Reverse Process To generate novel molecular conformations, the reverse process progressively removes noise from an initial Gaussian prior M T &#8764; N ( 0 , I ) , through a learned Markov chain. The joint denoising distribution is factorized as 4 p &#952; ( M 0 : T &#8722; 1 | M T ) = &#8719; t &#8722; 1 T p &#952; ( M t &#8722; 1 | M t ) p &#952; ( M t &#8722; 1 | M t ) is reverse transition, which follows a parameterized Gaussian distribution 5 p &#952; ( M t &#8722; 1 | M t ) = N ( M t &#8722; 1 ; &#956; &#952; ( M t , t ) , &#963; t 2 I ) where &#956; &#952; ( M t , t ) is the denoising function parameterized by the neural network and &#963; t 2 is the time-step dependent variance. Following ref , we parameterize the denoising mean &#956; &#952; using a noise prediction network &#1013; &#952; : 6 &#956; &#952; ( M t , t ) = 1 1 &#8722; &#946; t ( M t &#8722; &#946; t 1 &#8722; &#945;&#773; t &#1013; &#952; ( M t , t ) ) Set &#963; to &#946; t 1 &#8722; &#945;&#773; t .The &#8722; &#1013; &#952; &#183;&#963; score can be treated as the score, so S &#952; = &#8722; &#1013; &#952; &#183;&#963; is set. It is the log density of the data points at each time step, pointing in the direction of the largest growth rate of the probability density function. Since the reverse process removes the noisy component added to the data during the diffusion process at each time step, it is equivalent to a traversal of the data distribution, starting from low-density regions and progressively moving toward high-density regions guided by the log gradient. Thus, we can use S &#952; in all relevant formulas in the following sections. We parameterize &#956; &#952; to 7 &#956; &#952; ( M t , t ) = 1 1 &#8722; &#946; t ( M t + &#946; t &#183; s &#952; ( M t , t ) ) 4 Methodology In this section, we present the detailed design of our proposed model MGDM-Sa. 4.1 Overview Figure a illustrates our proposed model MGDM-Sa, which is a framework for the 3D molecular generation diffusion model for drug design. The framework of MGDM-Sa is implemented by denoising diffusion probabilistic models (DDPM). MGDM-Sa consists of two modules: the diffusion process and the reverse process. The diffusion process is formally defined as a Markov chain, wherein Gaussian noise is systematically introduced into the data across a sequence of T steps. The reverse process is to estimate the added noise by the dual equivariant score neural network, named DualESNet , thereby generating new molecules from the training data. DualESNet concurrently processes the global graph-level features and the local atomic environment to enhance the relationship modeling between nodes. Specially, DualESNet is composed of three components: edge construction, two equivariant encoders eEncoders , and two scoring blocks. Edge constructor, shown in Figure b, is to extract features of edges in the molecular graph and construct long and short edge representations according to the bond length distribution characteristic. eEncoder , shown in Figure c, integrates the EGNN and self-attention layer. EGNN ensures the equivariation of geometric features, while the self-attention mechanism addresses its limitation in modeling long-range dependencies. eEncoder effectively fuses global and local information to comprehensively capture complex relationships and dependencies in molecular graphs. Scoring blocks, shown in Figure d, aim to estimate the gradient of the log density of atomic features and map it to a score vector. 1 Our proposed model comprises two main components: the diffusion process and the reverse process. (a) Framework of MGDM-Sa, which implements the diffusion model. (b) Edge encoder, which processes the edge information on molecular graphs. (c) Equivariant encoder eEncoder , whichupdates the atomic and coordinate features of the M t . (d) Scoring block. 4.2 DualESNet The 3D generated molecular geometry is represented in the form of a point cloud, which requires rotation and translation equivariance. Therefore, MGDM-Sa should set an equivariant Markov kernel according to this property. K&#246;hler et al. proposed equivariant invertible functions that transform one invariant distribution into another. Xu et al. demonstrated that Markov chains initialized with invariant priors and evolving via equivariant Markov kernels can induce invariant marginal distributions. Formally, setting T is a rotation or translation operation. p ( x T ) = p ( T ( x T ) ) , p &#952; ( x t &#8722; 1 | x t ) = p &#952; ( T ( x t &#8722; 1 ) | T ( x t ) ) . Furthermore, ref proved that the sample distribution is guaranteed to be invariant to x T , that is p 0 ( x ) = p 0 ( T ( x ) ) . Thus, provided that the prior and transition kernels exhibit identical invariance properties, it is possible to construct a diffusion model capable of generating molecular conformations invariant with rotation and translation. As shown in Figure , DualESNet is composed of three components: edge construction, two eEncoders , and two scoring blocks. We will present the detailed principles of DualESNet and the workflow in the following. 4.3 Edge Constructor The generated 3D molecular geometry is represented as a point cloud. How to model the edge of molecular conformation generation is of great significance for molecular generation. For instance, ConfGF uses Langevin dynamics sampling to ensure rotation and translation. However, ConfGF only considers the local distances and ignores the long-range intramolecular nonbond interactions, such as van der Waals forces. EDM introduced fully connected edges. However, in EDM, all interatomic interactions are treated equally, resulting in the loss of covalent bond specificity and interference with redundant information. To ensure the effective processing of subsequent equivariant kernels, we systematically construct the connecting edges between point clouds, by using the method proposed by ref The basic idea of the edge constructor is that the threshold radius &#964; = 2 &#197; is set according to the bond length distribution characteristics. Such that a series of graph representations are generated after screening based on atomic connections inside and outside the radius of the intramolecular interaction force. These representations are then encoded through an edge encoder, shown in Figure b. The edge encoder is responsible for encoding the chemical bond features into a vector form. Specifically, the module processes two types of key information: (1) discrete key types are mapped to fixed-dimensional vectors by embedding layers; and (2) continuous bond length features are projected through linear layers. Thus, the bond type and bond distance information are integrated through the feature fusion layer to form a representation vector containing the complete characteristics of chemical bonds, which provides parsable input for subsequent graph neural networks. Mathematically, this procedure of the edge encoder is formulated as follows. 8 h e i j = M L P e ( d i j ) &#8857; e t y p e where MLP e is a multilayer perceptron structured as ( Linear , ReLU , Linear ), d ij = &#8741; r i l &#8211; r j l &#8741; 2 is the Euclidean distance between atomic coordinates of node i and j , and e type is the embedding of edge type, which is determined by the distance between atoms and chemical properties. h e ij denotes the edge feature between the i th atom and the j th atom. This design not only preserves the discrete chemical characteristics of covalent bonds but also incorporates continuous spatial information on geometric constraints to realize multidimensional modeling of molecular interactions. 4.4 eEncoders For the long edge set and the short edge set from the edge constructor, we design a dual equivalent encoder, consisting of a long-distance equivalent encoder and a short-distance equivalent encoder. Both long-distance equivariant encoders and short-distance equivariant encoders have the same structure as that of eEncoder , which is an equivariant Markov kernel. The 3D molecular structure has denaturation, such as translation and rotation. For this, we introduce EGNN to achieve the equivariant property in eEncoder . Furthermore, to enhance the representation capabilities of the MGMD-Sa model, we consider incorporating the attention mechanism into EGNN, to capture the relationship and dependency between nodes. As illustrated in Figure c, eEncoder consists of M layers of EGNN and N self-attention layers. Specifically, when training the MGMD-Sa on the QM9 data set, the structure of eEnconder is as follows: 9 { e E n c o d e r l : ( S a 1 , E g 1 , E g 2 , S a 2 , E g 3 , E g 4 , S a 3 , E g 5 , E g 6 ) e E n c o d e r s : ( S a 1 , E g 1 , E g 2 , S a 2 , E g 3 , E g 4 , S a 3 , E g 5 , E g 6 ) where Sa represents the self-attention layer and Eg represents the EGNN layer. Here, both eEncoder l and eEncoder s are composed of 3 self-attention layers and 6 EGNN layers. When training the MGMD-Sa GEOM-Drug data set, eEnconder is as follows: 10 { e E n c o d e r l : ( S a 1 , E g 1 , ... , E g 6 ) e E n c o d e r s : ( S a 1 , E g 1 , ... , E g 4 ) Here, eEncoder l consists of 1 self-attention layer and 6 EGNN layers, while the eEncoder s consists of 1 self-attention layer and 4 EGNN layers. eEncoder takes nodes embeddings h = { h 0 , ..., h n &#8211;1 }, coordinate embeddings r = { r 0 , ..., r n &#8211;1 }, and side information e = { h e ij | i , j = 0, ..., n &#8211; 1} as input. The detailed procedures for eEncoder are as follows. (1) EGNN layer: We take the l th EGNN layer as an example. It takes h ( l &#8211;1) , r ( l &#8211;1) and h e (l&#8211;1) as input. In detail, the processes of this EGNN layer are as follows. Step 1: The message m ij l from node i to node j is computed by 11 m i j l = M L P e ( h i ( l &#8722; 1 ) , h j ( l &#8722; 1 ) , &#8741; r i ( l &#8722; 1 ) &#8722; r j ( l &#8722; 1 ) &#8741; 2 , h e i j ( l &#8722; 1 ) ) where e ij ( l &#8211;1) is the feature of the edge at the ( l &#8211; 1)&#173;th layer, and MLP e is the multilayer perceptron of the edge used to compute the message m ij l . Step 2: The weight w ij l between the solution nodes i and j is calculated as follows. 12 w i j l = &#963; &#183; ( &#981; w ( m i j l ) ) where MLP w is the multilayer perceptron, and &#963; is the Sigmoid activation function used to convert the output of MLP w into weights. Step 3: The message of node i th at l th layer is aggregated by 13 m i l = &#8721; j &#8712; N ( i ) w i j l &#183; m i j l where N ( i ) is the set of neighbor nodes of node i . Step 4: Output the updated atomic coordinates along with the corresponding nodes. The feature representation h i ( l ) of node i can be expressed as follows: 14 h i l = M L P h ( h i ( l &#8722; 1 ) , m i l ) where h i l and h i ( l &#8211;1) are the feature representations of node i at layer l and layer ( l &#8211; 1), respectively. MLP h is a multilayer perception that fuses the feature representation of the current layer and aggregates messages to generate the feature representation of the next layer. For the positional updating of node i , we consider the relative position difference between node i and all its neighboring nodes. The coordinate of node i at l th layer is updated by 15 r i l = r i ( l &#8722; 1 ) + &#8721; j &#8800; i , j &#8712; N ( i ) ( r i ( l + 1 ) &#8722; r j ( l + 1 ) ) &#183; m i j l where r i l and r i ( l &#8211;1) are the local representations of node i at l th layer and ( l &#8211; 1)&#173;th layer, respectively. m ij l is the message between node i and its neighbor node j at layer ( l + 1). (2) Self-attention layer: To capture the relationship and dependency between nodes, we consider incorporating the attention mechanism into EGNN. The attention mechanism is an improved multihead attention mechanism, which aggregates the features of different nodes by calculating the similarity between queries, keys, and values. Mathematically, our proposed self-attention can be described by 16 h i l = M C A ( h i ( l &#8722; 1 ) , T g ) where h i ( l &#8211;1) is the output of feature of node i at the ( l &#8211; 1)&#173;th layer. It should be noted that MCA takes nodes embeddings and coordinate embeddings as input in the current time step, when l = 1. T g is a learned parameter used for aggregating the global features of the graph. As shown in Figure c, the self-attention layer has two attention layers to process global labels and node features, respectively. The first attention layer interacts with global labels with node features to generate induced features. The second attention layer uses these induced features to update the node features. In detail, the processes of this MCA module are as follows. Step 1: Layer normalization for feature of nodes h ( l &#8211;1) and T g . In this step, the input node feature h l and T g are normalized first. Through the LN operator shown in eq , we can obtain features of nodes h ln and q ln . 17 h ln = LN ( h l ) , T ln = LN ( T g l ) Step 2: Residual connection with the transformer encoder. This operator can be a formula as . 18 { h t 1 = T F e r ( h ln , T ln ) h t 2 = T F e r ( h ln , h t 1 ) + h where TFer ( h ln , q ln ) and TFer ( h ln , h t 1 ) are the standard transformer encoder with S = 8 multihead self-attention mechanism. For brevity, we only present the procedure of T F e r ( h ln , T ln ) . First, for the i th head, Q , K , and V are computed by linear transformation by . 19 { Q = W Q &#183; h ln K = W K &#183; T g V = W V &#183; T g where W Q , W K , and W V are the learnable matrixes. Then, the dot product between the query and the key is computed and scaled before applying the softmax function to obtain the attention weights. Thus, the output of the s th head can be obtained by 20 z s = s o f t max ( Q K T d ) &#183; V Finally, the output of TFer ( h ln , h t ) is obtained by a linear transformation. 21 z = C o n c a t ( z 1 , ... , z S ) &#183; W where z is the output of the transformer encoder, W is the linear transformer matrix, and z s is the output of head s . Step 3: Residual layer with FFN. Like , the feed-forward neural network is used to output the final node features. 22 h ln &#8289; 1 = LN ( h t 2 ) h l = h ln &#8289; 1 + F F N ( h ln &#8289; 1 ) 4.5 Scoring Block The scoring block aims to estimate the gradient of the log density of atomic features and map the result into a score vector. As shown in Figure d, the scoring block consists of node MLP, pairwise block, distance MLP, and dist-transition block modules. Next, the score feature vectors are extracted by two aspects: node information and spatial information. On the one hand, to estimate the gradient of the log density of atomic features, we utilize a MLP to transform the latent hidden vectors h i , which are the outputs of the eEncoder . 23 S &#952; ( A i ) = M L P n ( h i ) where MLP n is a multilayer perceptron structured as ( Linear , ReLU , Linear , ReLU , Linear ). On the other hand, for computing of gradient of pairwise distance, two nodes and edges are spliced according to the side information. Specifically, given an edge h e ij , we can obtain the feature of node i and node j . Thus, we can extract the gradient of pairwise distance by a MLP. 24 s &#952; ( d i j ) = M L P d ( h i &#8857; h j &#8741; h e i j ) where MLP d is a multilayer perceptron structured as ( Linear , ReLU , Linear , ReLU , Linear ). &#8857; is an element-wise multiply operator, and &#8741; is the concatenate operator. h i and h j are the features of nodes i and j , respectively. Second, the information on the score vector derived from pairwise distances and atomic coordinates R is subsequently integrated. 25 s &#952; ( R i ) = &#8721; j &#8712; N ( i ) 1 d i j &#183; s &#952; ( d i j ) &#183; ( r i &#8722; r j ) In eq , since s &#952; ( d ij ) depends only on d ij , which is symmetrically invariant, s &#952; ( d ij ) is translation invariant. Additionally, ( r i &#8211; r j ) is the rotation and translation equivariance. Therefore, s &#952; ( R ) has an equivariant property, thereby ensuring that the whole Markov chain process preserves rotation and translation invariance. 4.6 Loss Function In general, the key to diffusion models is to train the reverse Markov chain to match the forward Markov chain. Therefore, the parameter &#952; needs to be adjusted so that the joint distribution of eq of the reverse Markov chain is close to that of eq of the forward process. This can be achieved by minimizing the Kullback&#8211;Leibler divergence between these two distributions 26 K L ( q ( M 0 , M 1 , ... , M T ) &#8741; p &#952; ( M 0 , M 1 , ... , M T ) ) = ( i ) &#8722; E q ( M 0 , M 1 , ... , M T ) [ log &#8289; p &#952; ( M 0 , M 1 , ... , M T ) ] = ( i i ) E q ( M 0 , M 1 , ... , M T ) [ &#8722; log &#8289; p ( M T ) &#8722; &#8721; t = 1 T log p &#952; ( M t &#8722; 1 | M t ) q ( M t | M t &#8722; 1 ) ] &#65080; &#8788; &#8722; L V L B ( M 0 ) &#8805; ( i i i ) E [ &#8722; log &#8289; p &#952; ( M 0 ) ] where ( i ) is the definition of KL divergence. Both q ( M 0 , M 1 , ... , M T ) and p &#952; ( M 0 , M 1 , ... , M T ) in ( ii ) are products of distributions. (iii) follows from Jensen&#8217;s inequality. In eq , ( ii ) is the variational lower bound (VLB) on the log-likelihood of the data M 0 , which is the objective function for training a probabilistic generative model. Ho et al. proposed a reweighting term in L VLB to improve the sample quality. Here, we use the following simplified training objective in reference to DDPM: 27 L t = E M 0 [ &#955; ( t ) &#963; t 2 &#8741; &#8711; M t log &#8289; q ( M t | M 0 ) &#8722; s &#952; ( M t , t ) &#8741; 2 ] The above formula is derived from reference, and we use it to denote a positive weighting function. We refer to PDMD in the training phase in order to ignore &#955;, &#955; is set to 1 to simplify the objective function. Such a simplified objective is equivalent to learning s &#952; according to the gradient of the log density of the data distribution by sampling the diffusion molecules M t at a random time step t . Alg. 1 gives out the pseudocode of the training process. 4.7 Sampling In the sampling process, we employ Langevin dynamics to draw samples from the probability density. The detailed steps of the sampling process are as follows: first, the initial chaotic state M t is sampled from the normal distribution N ( 0 , I ) . The Stein score &#956; &#952; is then obtained through the DualESNet . Subsequently, according to N ( M T ; &#956; &#952; , &#963; T 2 I ) to obtain the chaotic state M T &#8722; 1 at the next time step. By repeating this process T times, we finally generate the target molecule M 0 . Alg. 2 is the pseudocode of the Sampling process. 5 Experiments In this section, we present a discussion around the experiments of MGDM-Sa. We conducted an experiment to evaluate both molecular geometry generation and conditional molecular generation. 5.1 Data Set Experiments for MGDM-Sa were performed on two public chemical spatial data sets: QM9. and GEOM-Drugs. The detailed information regarding the data set is presented below. GEOM is a benchmark data set for 3D molecule generation, containing millions of conformations of over 430k molecules, obtained from first-principles simulations. GEOM is split into two subsets: Geom-qm9 and Geom-Drugs. We use the GEOM-Drugs data set in this article. The GEOM-Drugs data set consists of medium-size drug molecules with a maximum of 181 atoms (91 heavy atoms) and contains an average of 44.2 atoms with an average of 6.5 rotatable bonds per molecule. QM9 is a benchmark data set for quantum property prediction, from the GDB17 data set. QM9 contains 133,885 small organic molecules consisting of no more than 9 heavy atoms (C, O, N, and F). Each molecule has 12 quantum properties such as geometry, energy, electron and thermodynamics, which are calculated by DFT. 5.2 Molecular Geometry Generation In this subsection, we discuss the experiments of MGDM-Sa in molecular geometry generation from three aspects: baselines, metrics, and results. 5.3 Baselines In this experiment, MGDM-Sa performed the geometric molecular generation task on the QM9 data set and GEOM-Drug data set. On the QM9 data set, we compare MGDM-Sa with ENF, SemlaFlow, EDM, MDM, JODO, 3D-EDiffMG, and G-SchNet. On the GEOM-Drug data set, we compare MGDM-Sa with ENF, EDM, G-SchNet, and MDM. 5.4 Metrics We evaluate the quality of the generated molecular mass using four metrics: Validity: the percentage of molecules generated according to the chemical valence rule. 28 V = N v N g where V denotes the efficient rate, N v is the number of effective molecules in the generated sample, and N g is the number of generated molecules. The validity of the generated molecules was assessed using the RDKit chemistry toolkit. Molecules containing any atoms that violate standard chemical valence rules were deemed invalid. Uniqueness: the proportion of unique effective molecules in the generated molecular sample. 29 U = N u v N g where U denotes uniqueness, N uv is the unique number of effective molecules in the generated sample, and N g is the number of generated molecules. Novelty: the proportion of molecules not included in the training data set. 30 N = N n N v where N denotes the novelty, N n is the number of generated novel molecules, that is, the number of molecules that are not in the training data set, and N v denotes the effective number of molecules. Stability: the percentage of stable molecules in which all the atoms are in a stable state among the generated molecular samples. 31 S = N s N v where S denotes the molecular stability, N s denotes the number of stable molecules, and N v is the number of effective molecules. 5.5 Results Tables and and Figures and present the performance comparison between MGDM-Sa and baseline models. As shown in Table , MGDM-Sa significantly outperforms existing baseline models on several key metrics of molecular generation. On the QM9 data set, in comparison with EDM, the MGDM-Sa exhibits significant enhancements in validity, stability, novelty, and uniqueness, with respective improvements of 8.27%, 7.16%, 27.9%, and 9.97%. Compared with MDM, MGDM-Sa achieves improvements of 1.3%, 6.36%, and 2.87% in effectiveness, stability, and uniqueness, respectively. MGDM-Sa has a higher effectiveness rate of 4.86% compared to JODO. Compared to 3D-EDiffMG-atten, MGDM-Sa demonstrates increases of 0.54%, 2.06%, and 5.07% in validity, stability, and uniqueness, respectively. Compared with SemlaFlow, MGDM-Sa has increased the effectiveness by 0.54% and the uniqueness by 2.07%. Additionally, MGDM-Sa-NA achieves performance comparable to that of 3D-EDiffMG-atten in terms of efficiency, stability, and uniqueness. 1 Comparison of MGDM-Sa and the Baseline Method in Three-Dimensional Molecular Generation Based on the QM9 Data Set methods % V &#8593; % U &#8593; % N &#8593; % S &#8593; ENF 41.0 40.1 39.5 24.6 G-SchNet 85.9 80.9 57.6 85.6 EDM 91.7 90.5 59.9 91.1 MDM-NV 97.8 91.6 80.1 88.6 MDM 98.6 94.6 90.0 91.9 JODO - - - 93.4 3D-EDiffMG 99.3 90.0 98.6 96.0 3D-EDiffMG-attn 99.4 92.4 99.3 96.2 SemlaFlow 99.4 95.4 - 99.7 MGDM-Sa-NA 98.71 90.38 87.42 96.7 MGDM-Sa 99.97 97.47 87.8 98.26 a This result is derived from comparing the performance of 10,000 molecules generated by MGDM-Sa with that of the benchmark model in the molecular geometry generation task. An upward arrow (&#8593;) denotes that higher values are indicative of superior performance. V : validity; U : uniqueness; N : novelty; S : stability. 2 Comparison of MGDM-Sa and the Baseline Method in Three-Dimensional Molecular Generation Based on the GEOM-Drug Data Set methods % V &#8593; % U &#8593; % N &#8593; % S &#8593; ENF 7.68 5.19 5.16 0 G-SchNet 14.9 14.7 14.6 8.07 EDM 68.6 68.6 68.6 13.7 MDM-NV 99.8 99.5 99.5 42.3 MDM 99.5 99.0 90.0 62.2 SemlaFlow 93.9 100.0 99.6 97.3 MGDM-Sa-NA 98.67 98.43 99.79 83.39 MGDM-Sa 97.04 97.04 99.98 89.98 a This result is derived from comparing the performance of 10,000 molecules generated by MGDM-Sa with that of the benchmark model in the molecular geometry generation task. An upward arrow (&#8593;) denotes that higher values are indicative of superior performance. V : validity; U : uniqueness; N : novelty; S : stability. 2 On the QM9 data set, the performance comparison between the MGDM-Sa and the benchmark models was conducted for the geometric molecule generation task. Orange indicates the most outstanding method. 3 On the GEOM-Drug data set, the performance comparison between the MGDM-Sa and the benchmark models was conducted for the geometric molecule generation task. The orange color represents the method that demonstrated the most outstanding performance. On the GEOM-Drug data set, in comparison with EDM, the MGDM-Sa exhibits significant enhancements in validity, stability, novelty, and uniqueness, with respective improvements of 28.44%, 28.44%, 31.38%, and 76.28%. Compared with MDM, MGDM-Sa achieves improvements of 27.78%, and 9.98% in stability and uniqueness, respectively. Meanwhile, MGDM-Sa-NA achieves comparable performance to 3D-EDiffMG-atten in terms of validity and uniqueness. The experimental results show that in the GEOM-Drug data set, MGDM-Sa has achieved a significant improvement in stability performance. These results indicate that MGDM-Sa possesses significant advantages in the generation of high-quality molecular conformations. The essence of the performance improvement lies in the refined modeling of molecular interactions achieved by the MGDM-Sa. Specifically, DualESNet captures the differential characteristics of short-range strong interactions and long-range weak interactions, while effectively addressing the significant disparities in strength and range between these two types of interactions. In addition, MGDM-Sa follows the principle of equivariance of the molecular geometry to ensure the physical consistency of the generated conformations under translation and rotation operations. eEncoder enhances the representation capability of the relationship between nodes by capturing and integrating global and local information, so as to significantly improve the chemical rationality and structural diversity of the generated molecules. On the other hand, we conducted ablation experiments to demonstrate the impact of attention in eEncoder on the performance of MGDM-Sa. We removed the self-attention layer in eEncoder as a variant of MGDM-Sa and named it MGDM-Sa-NA. The experimental results show that MGDM-Sa outperforms its variant MGDM-Sa-NA in terms of the validity, uniqueness, and stability of the generated molecules. From this, we can conclude that eEncoder can more comprehensively capture the relationships between nodes, thereby improving the accuracy and rationality of the generated molecules and enhancing the model&#8217;s expressive power. These results indicate that MGDM-Sa has a significant advantage in generating high-quality molecular conformations. 6 Conditional Molecular Generation Generating molecules that satisfy certain desired properties is of positive significance for us to obtain drugs with specific properties. Next, we discuss the experiments of MGDM-Sa in conditional molecular generation from three aspects: metrics, baselines, and results. 6.1 Metrics There are properties, that are often conditioned are &#945;: Polarizability in cubic Bohr radius (Bohr 3 ). &#956;: Dipole moment invariant ( D ). &#1013; HOMO : The highest occupied molecular orbital energy in millielectron volts (meV). &#1013; LUMO : The lowest unoccupied molecular orbital energy in millielectron volts (meV). &#1013; gap : The difference between &#1013; HOMO and &#1013; LUMO . C v : The resulting molecules do not include the percentage of ions. 6.2 Experimental Setup MGDM-Sa introduces the above six attributes to condition the generated molecules. Based on previous work EMD, we utilize the attribute classifier in EGNN. The set of QM9 is divided into two parts, each containing 50K samples. One-half denoted as D c is used for classifier training, and the other half denoted as D g is used for generative model training. The classifier &#981; c then evaluates the attribute-based conditional generation samples by the mean absolute error between the predicted attribute value and the true attribute value. 6.3 Baselines Here, we compare with several baseline references: Naive (Upper-Bond): The relationship between molecule and attribute is removed. The D g is evaluated by the classifier &#981; c . The labels are shuffled in D g to predict molecules whose molecular properties require properties. Atoms: The classifier &#981; c predicts the molecular properties on D g by the number of atoms. EDM: The first diffusion model uses EGNN to generate 3D molecules. MDM: A diffusion model employs SchNet for the generation of 3D molecular structures, introduces separate equivariant encoders to capture interatomic forces of varying strengths, and incorporates a distribution control variable at each diffusion-inversion step to enhance molecular diversity. QM9 (Lower-Bond): The classifier &#981; c evaluates the original D c to predict molecular properties. 6.4 Results The results of conditional molecule generation are shown in Table and Figure . First, MGDM-Sa performs well in predicting electronic structures: the mean absolute errors of &#1013; HOMO and &#1013; LUMO are 0.0049 and 0.0151 lower than those of MDM, respectively, and even outperform the QM9 benchmark. Second, the experimental results of MGDM-Sa on &#1013; gap are 0.0145 lower than those of the comparison model MDM and 0.0345 lower than the QM9 benchmark. Meanwhile, in terms of &#956;, MGDM-Sa outperforms EDM and MDM, with the mean absolute error of MGDM-Sa being 0.0061 lower than that of EDM. However, the results of MGDM-Sa on C v and &#945; are not ideal. This might be due to the fact that MGDM-Sa may overfit the electronic property targets during the generation process, sacrificing the rationality and diversity of molecular structures. Particularly, the lower index results compared to the QM9 benchmark might be attributed to the smaller distribution difference between D c and D g . The experimental results indicate that MGDM-Sa has the ability to generate molecules with the targeted properties. 3 A Performance Comparison of the MGDM-Sa against Baseline Models in the Conditional Molecule Generation Task methods &#945; &#8595; &#956; &#8595; &#1013; HOMO &#8595; &#1013; LUMO &#8595; &#1013; gap &#8595; C v &#8595; naive (U) 9.013 1.616 0.645 1.457 1.472 6.857 #atoms 3.862 1.053 0.426 0.813 0.866 1.971 EDM 2.760 1.111 0.356 0.584 0.655 1.101 MDM 1.591 1.177 0.019 0.040 0.044 1.647 MGDM-Sa 3.0811 1.1049 0.0141 0.0249 0.0295 5.2179 QM9&#160;(L) 0.100 0.043 0.039 0.036 0.064 0.040 a The downward arrow (&#8595;) signifies that lower values correspond to improved model performance. 4 Comparison of various methods in the conditional molecule generation task. Orange represents MGMD-Sa. 7 Analysis 7.1 Statistical Analysis In this subsection, we will analyze the molecules generated by MGDM-Sa from three perspectives: the distribution of molecular properties, the distribution of data types, and the comparison of molecular structures. 7.2 Distribution of Molecular Properties To validate that MGDM-Sa is capable of generating molecules with reasonable physicochemical and pharmacokinetic properties, we conducted an analysis of the distribution of 10,000 molecular samples generated by MGDM-Sa across five key properties, essential for drug development. Figures and , respectively, illustrate the distribution of five properties for 10,000 samples generated by MGDM-Sa on the QM9 data set and GEOM-Drug. The specific analysis is as follows: log P : The median values of log P on the QM9 data set and the GEOM-Drug data set are 1.17 and 2.82, respectively. Lipinski&#8217;s five rules suggest that log P should be less than or equal to 5. This suggests that these molecules maintain a favorable balance in terms of hydrophilicity. SAScore: The median values of SAScore in the QM9 data set and the GEOM-Drug data set are 3.87 and 4.02, respectively. Moreover, the IQRs are (3.2, 4.5) and (3.5, 4.5), respectively. This suggests that the synthetic accessibility of these molecules is moderate, indicating that they can be synthesized through feasible routes without introducing excessive complexity during the manufacturing process. TPSA: The molecules in the QM9 data set generally exhibit relatively low TPSA values, as they are predominantly small and low-polarity compounds. These molecules typically lack polar functional groups or large structural frameworks, which results in the low TPSA values observed in the molecules generated by MGDM-Sa. The median TPSA was 12.47 &#197; 2 , with an IQR of 3.0 &#197; 2 to 23 &#197; 2 . The low value indicates that most of these molecules are relatively hydrophobic, have strong lipophilicity, and have a good ability to penetrate cell membranes. On the GEOM-Drug data set, the median value of TPSA is 61.44 &#197; 2 . It is indicated that the molecule as a whole has a certain degree of polarity. Furthermore, the IQR range is wide, indicating that the polarity distribution of the molecules is broad, possibly encompassing various structures ranging from polar to nonpolar. This also indicates the complexity and diversity of the molecular structures in the GEOM-Drug data set. MolWt: On the QM9 data set, the median MolWt is 110.20 Da. This complies with Lipinski&#8217;s five rules, as typically an oral drug molecule should have a molecular weight of less than 500 Da. Additionally, in the GEOM-Drug data set, the median MolWt is 337.460 Da, which falls within the ideal range of (200,500) Da. Moreover, the IQR shows that most molecules are concentrated in the range of (280,390) Da, which meets the drug-likeness requirements. QED: Although the QED value on the QM9 data set is slightly lower at 0.46, the median QED on the GEOM-Drug data set reaches 0.61. This indicates that these compounds exhibit good drug similarity and can be regarded as promising candidates for drug development. 5 Distribution of 10,000 molecules generated by MGDM-Sa on the QM9 data set in terms of log P , SA score, TPSA, MolWt, and QED. 6 Distribution of 10,000 molecules generated by MGDM-Sa on the GEOM-Drug data set in terms of log P , SA score, TPSA, MolWt, and QED. 7.3 Comparison of Molecular Structures We compared the three-dimensional structures of the molecules in the QM9 data set with those generated by MGDM-Sa and also compared the molecules in the GEOM-Drug data set with those generated by MGDM-Sa. For example, Figure a reveals that the difference in bond angle at the same position of the two molecules is merely 0.9d&#176;, the difference in bond length is only 0.1 &#197;, and the difference in the dihedral angle is 44.8&#176;. The six comparison diagrams presented in Figure demonstrate that there are minor differences in bond length and bond angle between the molecules of QM9 and MGDM-Sa. However, a certain disparity exists in the dihedral angle. Therefore, it can be evidenced that MGDM-Sa has the capacity to learn molecular topology and is capable of generating drug-like molecules that are both similar to and novel compared to those in the QM9 data set or GEOM-Drug data set. 7 Light blue represents the molecule generated by MGDM-Sa, while green represents the molecules in the original data set. (a,c,e) Molecules formed by the interaction of the molecules in QM9 with MGDM-Sa. (b,d,f) Molecules generated by the interaction of the molecules in GEOM-Drug with MGDM-Sa. Among them, the purple ones are bond angles, the blue ones are dihedral angles, and the red ones are bond lengths. 7.4 Molecular Property Analysis In this subsection, to verify the potential of the molecules generated by MGDM-Sa to become drug candidates, we will discuss and analyze the new molecules from three aspects: basic molecular properties, ADMET predictions, and molecular docking. First, the molecules generated by MGDM-Sa have the potential to be viable drug candidates. We randomly selected four molecules from the samples, which were generated by MGDM-Sa. These molecular structures are shown in Figure . Furthermore, Table presents the prediction results of the nine properties. For instance, the log P of M-1 is 2.7, which falls within the reasonable range of (1.5). The QED of M-2 is 0.8. A QED greater than 0.67 is generally regarded as having good drug potential. The SAScores of the four molecules are all less than 5, which indicates that they are relatively easy-to-synthesize compounds. 8 (a,b) Structural fragments generated by MGDM-Sa in the QM9 data set. (c,d) Molecular structures generated by MGDM-Sa in the GEOM-Drug data set. 4 Prediction of Nine Fundamental Properties of Some Generated Molecules a Log P : logarithm of partition coefficient; QED: quantitative score of drug similarity; SAScore: composite feasibility score; MolWt: molecular weight; TPSA: topological polar surface area; HBA: number of hydrogen bond acceptors; HBD: number of hydrogen bond donors; rotatable bonds: number of rotatable keys; aromatic rings: number of aromatic rings.M1 and M2 are the molecules generated by MGDM-Sa on the QM9 data set. M3 and M4 are the molecules generated by MGDM-Sa on the GEOM-Drug data set. Second, to verify the capability of MGDM-Sa to generate drug-like molecules, we conducted an analysis of the absorption, distribution, metabolism, excretion, and toxicity (ADMET) properties of the generated molecules. As shown in Table , the compounds are mostly within a reasonable range in drug development, meeting the common standards for drug candidates. As shown in Table , most of these properties fall within the reasonable range for drug development and meet the common standards for drug candidates. For instance, the Coca-2 of M-1 is &#8722;4.67, which is greater than &#8722;1.15. The PPB of M-2 is 47.892%, which is less than 90%. The CYD2D6-I of M-3 is 0, indicating it belongs to the noninhibitor category. The DILI of M-4 is 0, suggesting that it is a drug without DILI risk. Moreover, combining Tables and , we can see that the molecules generated by MGDM-Sa perform well in terms of physical and chemical properties, drug-like properties, absorption, distribution, and toxicity. Therefore, MGDM-Sa can generate molecules with a potential druggability. 5 Prediction of Molecular Absorption, Distribution, Metabolism, Excretion, and Toxicity (ADMET Properties , molecules Caco-2 HIA PPB BBB VDss CYP 2D6-I CYP 3A4-I CYP 2C9-I CYP 2D6-S CYP 3A4-S CYP 2C9-S CYP 2C19-I CYP 2C19-S CYP 2B6-I CYP 2B6-S CL T 1/2 hERG AMES DILI M-1 &#8211;4.67 1 38.174 1 0.361 0 0 0 0 0 1 0 0 0 1 12.028 1.718 0 0 0 M-2 &#8211;4.323 1 47.892 1 0.412 0 0 0 1 0 0 0 1 0 1 11.074 1.286 0 0 0 M-3 &#8211;5.182 1 53.633 1 &#8211;0.035 0 0 0 0 0 0 1 0 0 0 6.771 0.77 0 0 0 M-4 &#8211;4.959 1 59.046 1 0.242 0 0 0 0 1 0 0 1 1 0 8.97 1.623 0 0 0 a In the table, a value of 0 indicates no activity and 1 indicates significant activity. b Caco-2/Caco-2 permeability; HIA: human intestinal absorption; PPB: plasma protein binding; BBB: plasma protein binding; VDss: volume distribution; CYP/CYP450 enzyme; CL: clearance; T 1/2 : half-life; DLI: drug induced liver injury. M1 and M2 are the molecules generated by MGDM-Sa on the QM9 data set. M3 and M4 are the molecules generated by MGDM-Sa on the GEOM-Drug data set. 9 Molecular docking structure; yellow dashed lines indicate hydrogen bonds. (a) Shows the docking of the molecules generated by MGDM-Sa on the QM9 data set with HPK1. (b) Shows the docking of the molecules generated by MGDM-Sa on the GEOM-Drug data set with LRRK2. Finally, to evaluate the ability of our model to generate bioactive molecules, two popular targets, hematopoietic progenitor kinase 1 (HPK1, PDB ID: 7M0M ) and leucine-rich repeat kinase 2 (LRRK2, PDB ID: 8FO7 ), were used as examples to study the docking of the generated molecules with the targets. As shown in Figure , the case study reveals that the molecules generated via MGDM-Sa are not only biologically active but also exhibit drug-like properties, structural diversity, and novelty. This underscores the capability of our approach to generate high-quality candidates with desired characteristics, making it a valuable tool for de novo drug design. 8 Conclusion In this article, we propose a novel diffusion model MGDM-Sa for 3D molecular generation tasks, which combines a biequivariant fractional neural network called DualESNet . The DualESNet models the bond lengths of different interatomic forces to capture complex interatomic interaction relationships and enhances the ability of the model to characterize atomic connectivity. In particular, in DualESNet , we design a new equivariant encoder, eEncoder , which integrates the EGNN and self-attention. eEncoder effectively integrates global and local information to comprehensively capture complex relationships and dependencies in the molecular graph, thereby enhancing the expression ability of the model. We performed both geometric molecule generation and conditional molecule generation experiments. Experimental results show that MGDM-Sa can generate effective and stable molecules. By comparing MGDM-Sa with the baseline model, it is proven that MGDM-Sa has advantages in both geometric molecular generation performance and generation of molecules with expected properties. We performed physicochemical and medicinal chemical property prediction, ADMET prediction, and molecular docking on the molecules generated by MGDM-Sa. The results show that the molecules generated based on MGDM-Sa not only have good biological activities but also maintain good drug-like properties. We demonstrate that MGDM-Sa is capable of generating effective candidates and will be a useful de novo drug design tool. This work was supported in part by the National Natural Science Foundation of China under Grant 62362002. The data sets and codes used in this study are available at GitHub: https://github.com/yha2333/MGDM.git . The authors declare no competing financial interest. Gaudelet T. Day B. Jamasb A. R. Soman J. Regep C. Liu G. Hayter J. B. Vickers R. Roberts C. Tang J. Utilizing graph machine learning within drug discovery and development Briefings Bioinf. 2021 22 bbab159 10.1093/bib/bbab159 PMC8574649 34013350 Sidorova J. Anisimova M. NLP-inspired structural pattern recognition in chemical application Pattern Recognit. Lett. 2014 45 11 16 10.1016/j.patrec.2014.02.012 Kotsias P.-C. Ar&#250;s-Pous J. Chen H. Engkvist O. Tyrchan C. Bjerrum E. J. Direct steering of de novo molecular generation with descriptor conditional recurrent neural networks Nat. Mach. Intell. 2020 2 254 265 10.1038/s42256-020-0174-5 Ar&#250;s-Pous J. Johansson S. V. Prykhodko O. Bjerrum E. J. Tyrchan C. Reymond J.-L. Chen H. Engkvist O. Randomized SMILES strings improve the quality of molecular generative models J. Cheminf. 2019 11 71 10.1186/s13321-019-0393-0 PMC6873550 33430971 De Cao N. Kipf T. MolGAN: An implicit generative model for small molecular graphs arXiv 2018 arXiv:1805.11973 10.48550/arXiv.1805.11973 Bagal V. Aggarwal R. Vinod P. Priyakumar U. D. MolGPT: molecular generation using a transformer-decoder model J. Chem. Inf. Model. 2022 62 2064 2076 10.1021/acs.jcim.1c00600 34694798 Kipf T. N. Welling M. Variational Graph Auto-Encoders arXiv 2016 arXiv:1611.07308 10.48550/arXiv.1611.07308 Wang S. Song T. Zhang S. Jiang M. Wei Z. Li Z. Molecular substructure tree generative model for de novo drug design Briefings Bioinf. 2022 23 bbab592 10.1093/bib/bbab592 35039853 Cao N. D. Kipf T. MolGAN: An implicit generative model for small molecular graphs arXiv 2022 arXiv:1805.11973 10.48550/arXiv.1805.11973 Madhawa K. Ishiguro K. Nakago K. Abe M. GraphNVP: An Invertible Flow Model for Generating Molecular Graphs arXiv 2019 arXiv:1905.11600 10.48550/arXiv.1905.11600 Yao S. Feng J. Zhong S. Research progress of 3D molecular generative models based on deep learning Sci. China, Ser. B:Chem. 2023 53 174 195 Bronstein M. M. Bruna J. LeCun Y. Szlam A. Vandergheynst P. Geometric Deep Learning: Going beyond Euclidean data IEEE Signal Process. Mag. 2017 34 18 42 10.1109/MSP.2017.2693418 Gebauer N. W. A. Gastegger M. Sch&#252;tt K. Symmetry-adapted generation of 3d point sets for the targeted discovery of molecules arXiv 2019 32 arXiv:1906.00957 10.48550/arXiv.1906.00957 Nesterov V. Wieser M. Roth V. 3DMolNet: a generative network for molecular structures arXiv 2020 arXiv:2010.06477 10.48550/arXiv.2010.06477 Garcia Satorras V. Hoogeboom E. Fuchs F. Posner I. Welling M. E&#173;(n) equivariant normalizing flows Adv. Neural Inf. Process. Syst. 2021 34 4181 4192 Luo , Y. ; Ji , S. An autoregressive flow model for 3d molecular geometry generation from scratch . International Conference on Learning Representations (ICLR) , 2022 . Simm , G. ; Pinsler , R. ; Hern&#225;ndez-Lobato , J. M. Reinforcement learning for molecular design guided by quantum mechanics . International Conference on Machine Learning , 2020 ; pp 8959 &#8211; 8969 . Zhou G. Gao Z. Ding Q. Zheng H. Xu H. Wei Z. Zhang L. Ke G. Uni-Mol: A Universal 3D Molecular Representation Learning Framework chemrxiv 2023 chemrxiv-2022-jjm0j 10.26434/chemrxiv-2022-jjm0j Huang Y. Peng X. Ma J. Zhang M. 3DLinker: an E (3) equivariant variational autoencoder for molecular linker design arXiv 2022 arXiv:2205.07309 10.48550/arXiv.2205.07309 Ganea O.-E. Pattanaik L. Coley C. Barzilay R. Jensen K. Green W. Jaakkola T. Geomol: Torsional geometric generation of molecular 3d conformer ensembles Adv. Neural Inf. Process. Syst. 2021 34 13757 13769 Xu , M. ; Wang , W. ; Luo , S. ; Shi , C. ; Bengio , Y. ; Gomez-Bombarelli , R. ; Tang , J. An end-to-end framework for molecular conformation generation via bilevel programming . International Conference on Machine Learning , 2021 ; pp 11537 &#8211; 11547 . Sch&#252;tt K. T. Kindermans P.-J. Sauceda Felix H. E. Chmiela S. Tkatchenko A. M&#252;ller K.-R. Schnet: A continuous-filter convolutional neural network for modeling quantum interactions Adv. Neural Inf. Process. Syst. 2017 30 1 Huang , L. ; Zhang , H. ; Xu , T. ; Wong , K.-C. MDM: Molecular Diffusion Model for 3D Molecule Generation . Proceedings of the AAAI Conference on Artificial Intelligence , 2023 ; Vol. 37 , pp 5105 &#8211; 5112 . Xu C. Liu R. Yao Y. Huang W. Li Z. Luo H.-B. 3D-EDiffMG: 3D equivariant diffusion-driven molecular generation to accelerate drug discovery J. Pharm. Anal. 2025 15 101257 10.1016/j.jpha.2025.101257 40678485 PMC12268068 Satorras , V. G. ; Hoogeboom , E. ; Welling , M. E. (n) equivariant graph neural networks . International Conference on Machine Learning , 2021 ; pp 9323 &#8211; 9332 . Xu , C. ; Wang , H. ; Wang , W. ; Zheng , P. ; Chen , H. Geometric-facilitated denoising diffusion model for 3D molecule generation . Proceedings of the AAAI Conference on Artificial Intelligence , 2024 ; Vol. 38 , pp 338 &#8211; 346 . Hoogeboom , E. ; Satorras , V. G. ; Vignac , C. ; Welling , M. Equivariant diffusion for molecule generation in 3d . International Conference on Machine Learning , 2022 ; pp 8867 &#8211; 8887 . Bao F. Zhao M. Hao Z. Li P. Li C. Zhu J. Equivariant energy-guided sde for inverse molecular design arXiv 2022 arXiv:2209.15408 10.48550/arXiv.2209.15408 Jo , J. ; Lee , S. ; Hwang , S. J. Score-based generative modeling of graphs via the system of stochastic differential equations . International Conference on Machine Learning , 2022 ; pp 10362 &#8211; 10383 . Peng X. Guan J. Liu Q. Ma J. Moldiff: Addressing the atom-bond inconsistency problem in 3d molecule diffusion generation arXiv 2023 arXiv:2305.07508 10.48550/arXiv.2305.07508 Qiang , B. ; Song , Y. ; Xu , M. ; Gong , J. ; Gao , B. ; Zhou , H. ; Ma , W.-Y. ; Lan , Y. Coarse-to-fine: a hierarchical diffusion model for molecule generation in 3d . International Conference on Machine Learning , 2023 ; pp 28277 &#8211; 28299 . Xu , M. ; Powers , A. S. ; Dror , R. O. ; Ermon , S. ; Leskovec , J. Geometric latent diffusion models for 3d molecule generation . International Conference on Machine Learning , 2023 ; pp 38592 &#8211; 38610 . Ramakrishnan R. Dral P. O. Rupp M. Von Lilienfeld O. A. Quantum chemistry structures and properties of 134 kilo molecules Sci. Data 2014 1 140022 10.1038/sdata.2014.22 25977779 PMC4322582 Axelrod S. Gomez-Bombarelli R. G. E. O. M. GEOM, energy-annotated molecular conformations for property prediction and molecular generation Sci. Data 2022 9 185 10.1038/s41597-022-01288-4 35449137 PMC9023519 Unke O. T. Meuwly M. PhysNet: A neural network for predicting energies, forces, dipole moments, and partial charges J. Chem. Theory Comput. 2019 15 3678 3693 10.1021/acs.jctc.9b00181 31042390 Gasteiger J. Gro&#223; J. G&#252;nnemann S. Directional message passing for molecular graphs arXiv 2020 arXiv:2003.03123 10.48550/arXiv.2003.03123 Fuchs F. B. Worrall D. Fischer V. Welling M. Se (3)-transformers: 3d roto-translation equivariant attention networks Adv. Neural Inf. Process. Syst. 2020 33 1970 1981 Ho , J. ; Jain , A. ; Abbeel , P. Denoising diffusion probabilistic models . Proceedings of the 34th International Conference on Neural Information Processing Systems : Red Hook, NY, USA , 2020 . Nichol , A. Q. ; Dhariwal , P. Improved denoising diffusion probabilistic models . International Conference on Machine Learning , 2021 ; pp 8162 &#8211; 8171 . Sohl-Dickstein , J. ; Weiss , E. ; Maheswaranathan , N. ; Ganguli , S. Deep unsupervised learning using nonequilibrium thermodynamics . International Conference on Machine Learning , 2015 ; pp 2256 &#8211; 2265 . Liu , Q. ; Lee , J. ; Jordan , M. A kernelized Stein discrepancy for goodness-of-fit tests . International Conference on Machine Learning , 2016 ; pp 276 &#8211; 284 . K&#246;hler , J. ; Klein , L. ; No&#233; , F. Equivariant flows: exact likelihood generative learning for symmetric densities . International Conference on Machine Learning , 2020 ; pp 5361 &#8211; 5370 . Xu M. Yu L. Song Y. Shi C. Ermon S. Tang J. G. A geometric diffusion model for molecular conformation generation arXiv 2022 arXiv:2203.02923 10.48550/arXiv.2203.02923 Shi , C. ; Luo , S. ; Xu , M. ; Tang , J. Learning gradient fields for molecular conformation generation . International Conference on Machine Learning , 2021 ; pp 9558 &#8211; 9568 . Vaswani A. Attention is all you need arXiv 2017 arXiv:1706.03762 10.48550/arXiv.1706.03762 Jensen J. L. W. V. Sur les fonctions convexes et les in&#233;galit&#233;s entre les valeurs moyennes Acta Math. 1906 30 175 193 10.1007/BF02418571 Vincent P. A connection between score matching and denoising autoencoders Neural Comput. 2011 23 1661 1674 10.1162/NECO_a_00142 21492012 Huang L. Xu T. Yu Y. Zhao P. Chen X. Han J. Xie Z. Li H. Zhong W. Wong K.-C. A dual diffusion model enables 3D molecule generation and lead optimization based on target pockets Nat. Commun. 2024 15 2657 10.1038/s41467-024-46569-1 38531837 PMC10965937 Huang H. Sun L. Du B. Lv W. Learning Joint 2-D and 3-D Graph Diffusion Models for Complete Molecule Generation IEEE Transact. Neural Networks Learn. Syst. 2024 35 11857 11871 10.1109/TNNLS.2024.3416328 38976472 Irwin R. Tibo A. Janet J. P. Olsson S. SemlaFlow&#8211;Efficient 3D Molecular Generation with Latent Attention and Equivariant Flow Matching arXiv 2024 arXiv:2406.07266 10.48550/arXiv.2406.07266 Lipinski C. A. Lombardo F. Dominy B. W. Feeney P. J. Experimental and computational approaches to estimate solubility and permeability in drug discovery and development settings Adv. Drug Delivery Rev. 1997 23 3 25 10.1016/S0169-409X(96)00423-1 11259830"
}